<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>دفتر حسابداری فروشگاه</title>
  <meta name="description" content="ثبت و مدیریت تراکنش‌های مالی فروشنده" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/accountant.min.css" />
  <script src="/nav-active.js" defer></script>
  <script src="js/accountant.js" defer></script>
</head>
<body>
  <div class="page">
    <header class="page-header">
      <div class="header-intro">
        <span class="header-badge">حسابداری فروشگاه</span>
        <h1>
          سلام <span id="sellerName">فروشنده عزیز</span>
          <span aria-hidden="true">👋</span>
        </h1>
        <p>تراکنش‌های مالی خود را در این بخش ثبت، ذخیره و پیگیری کنید.</p>
      </div>
      <div class="header-actions">
        <button class="theme-toggle" id="themeToggle" type="button" aria-pressed="false">
          <i class="ri-moon-clear-line" aria-hidden="true"></i>
          <span class="theme-toggle__label">حالت تیره</span>
        </button>
        <button class="back-btn" id="backToDashboard" type="button">
          <i class="ri-arrow-right-line" aria-hidden="true"></i>
          بازگشت به پنل فروشنده
        </button>
      </div>
    </header>

    <main class="page-content">
      <section class="card" id="newEntrySection">
        <div class="card-title">
          <i class="ri-add-circle-line" aria-hidden="true"></i>
          <h2>ثبت تراکنش جدید</h2>
        </div>
        <p class="card-subtitle">تمام اطلاعات شما در پایگاه داده امن ذخیره شده و در گزارش‌ها قابل مشاهده است.</p>
        <form id="entryForm" novalidate>
          <div class="form-grid">
            <label class="form-field">
              <span>عنوان تراکنش <span class="required">*</span></span>
              <input type="text" name="title" placeholder="مثال: فروش نقدی امروز" required />
            </label>
            <label class="form-field">
              <span>نوع تراکنش</span>
              <div class="type-options" role="radiogroup">
                <label>
                  <input type="radio" name="type" value="income" checked />
                  <span>درآمد</span>
                </label>
                <label>
                  <input type="radio" name="type" value="expense" />
                  <span>هزینه</span>
                </label>
              </div>
            </label>
            <label class="form-field">
              <span>مبلغ (تومان) <span class="required">*</span></span>
              <input type="number" name="amount" min="0" step="1000" placeholder="مثال: 2500000" required />
            </label>
            <label class="form-field">
              <span>تاریخ ثبت</span>
              <input type="date" name="recordedAt" />
            </label>
          </div>

          <div class="form-grid form-grid--balanced">
            <label class="form-field">
              <span>دسته‌بندی تراکنش</span>
              <select name="category">
                <option value="عمومی">عمومی</option>
                <option value="فروش محصول">فروش محصول</option>
                <option value="هزینه ثابت">هزینه ثابت</option>
                <option value="هزینه متغیر">هزینه متغیر</option>
                <option value="حقوق و دستمزد">حقوق و دستمزد</option>
                <option value="تبلیغات و بازاریابی">تبلیغات و بازاریابی</option>
                <option value="هزینه انبار">هزینه انبار</option>
                <option value="سایر">سایر</option>
              </select>
            </label>
            <label class="form-field">
              <span>روش پرداخت</span>
              <select name="paymentMethod">
                <option value="cash">نقدی</option>
                <option value="card">دستگاه کارتخوان</option>
                <option value="transfer">کارت به کارت / حواله</option>
                <option value="online">پرداخت آنلاین</option>
                <option value="cheque">چک</option>
                <option value="other">سایر</option>
              </select>
            </label>
            <label class="form-field">
              <span>وضعیت پرداخت</span>
              <select name="status">
                <option value="paid">تسویه شده</option>
                <option value="pending">در انتظار پرداخت</option>
                <option value="overdue">سررسید گذشته</option>
                <option value="refunded">مرجوعی / بازگشتی</option>
              </select>
            </label>
            <label class="form-field">
              <span>تاریخ سررسید</span>
              <input type="date" name="dueDate" />
            </label>
          </div>

          <div class="form-grid form-grid--balanced">
            <label class="form-field">
              <span>نوع طرف حساب</span>
              <select name="counterpartyType">
                <option value="customer">مشتری</option>
                <option value="supplier">تأمین‌کننده</option>
                <option value="other">سایر</option>
              </select>
            </label>
            <label class="form-field">
              <span>نام طرف حساب</span>
              <input type="text" name="counterpartyName" placeholder="مثال: علی رضایی" />
            </label>
            <label class="form-field">
              <span>شماره مرجع / فاکتور</span>
              <input type="text" name="referenceNumber" placeholder="مثال: INV-4582" />
            </label>
            <label class="form-field">
              <span>برچسب‌ها</span>
              <input type="text" name="tags" placeholder="مثال: قسط، فروش ویژه" />
              <small class="field-hint">برچسب‌ها را با ویرگول یا کاما جدا کنید (حداکثر ۸ مورد).</small>
            </label>
          </div>

          <label class="form-field">
            <span>توضیحات تکمیلی</span>
            <textarea name="description" rows="3" placeholder="جزئیات بیشتر (اختیاری)"></textarea>
          </label>

          <div class="form-helper" role="note">
            <i class="ri-lightbulb-flash-line" aria-hidden="true"></i>
            <p>برای مدیریت بهتر گزارش‌ها، حتماً دسته‌بندی و وضعیت پرداخت را دقیق انتخاب کنید تا در خلاصه‌ها و سررسیدها نمایش داده شود.</p>
          </div>

          <div class="form-actions">
            <button type="submit" class="primary-btn">
              <i class="ri-save-3-line" aria-hidden="true"></i>
              ذخیره تراکنش
            </button>
          </div>
          <p class="form-message" id="formMessage" role="alert" aria-live="polite"></p>
        </form>
      </section>

      <section class="card" id="filtersSection">
        <div class="card-title">
          <i class="ri-equalizer-line" aria-hidden="true"></i>
          <h2>فیلتر و جستجوی تراکنش‌ها</h2>
        </div>
        <p class="card-subtitle">با استفاده از فیلترهای زیر گزارش‌ها را دقیق‌تر بررسی کنید.</p>
        <form id="filtersForm">
          <div class="filters-grid">
            <label class="form-field">
              <span>جستجوی سریع</span>
              <input type="search" name="search" id="searchQuery" placeholder="جستجو بر اساس عنوان، طرف حساب یا برچسب" />
            </label>
            <label class="form-field">
              <span>نوع تراکنش</span>
              <select name="type">
                <option value="">همه</option>
                <option value="income">درآمد</option>
                <option value="expense">هزینه</option>
              </select>
            </label>
            <label class="form-field">
              <span>دسته‌بندی</span>
              <select name="category">
                <option value="">همه دسته‌ها</option>
                <option value="عمومی">عمومی</option>
                <option value="فروش محصول">فروش محصول</option>
                <option value="هزینه ثابت">هزینه ثابت</option>
                <option value="هزینه متغیر">هزینه متغیر</option>
                <option value="حقوق و دستمزد">حقوق و دستمزد</option>
                <option value="تبلیغات و بازاریابی">تبلیغات و بازاریابی</option>
                <option value="هزینه انبار">هزینه انبار</option>
                <option value="سایر">سایر</option>
              </select>
            </label>
            <label class="form-field">
              <span>روش پرداخت</span>
              <select name="paymentMethod">
                <option value="">همه روش‌ها</option>
                <option value="cash">نقدی</option>
                <option value="card">دستگاه کارتخوان</option>
                <option value="transfer">کارت به کارت / حواله</option>
                <option value="online">پرداخت آنلاین</option>
                <option value="cheque">چک</option>
                <option value="other">سایر</option>
              </select>
            </label>
            <label class="form-field">
              <span>وضعیت پرداخت</span>
              <select name="status">
                <option value="">همه وضعیت‌ها</option>
                <option value="paid">تسویه شده</option>
                <option value="pending">در انتظار پرداخت</option>
                <option value="overdue">سررسید گذشته</option>
                <option value="refunded">مرجوعی / بازگشتی</option>
              </select>
            </label>
            <label class="form-field">
              <span>از تاریخ</span>
              <input type="date" name="from" />
            </label>
            <label class="form-field">
              <span>تا تاریخ</span>
              <input type="date" name="to" />
            </label>
          </div>
          <div class="filter-actions">
            <button type="submit" class="primary-btn">
              <i class="ri-filter-3-line" aria-hidden="true"></i>
              اعمال فیلترها
            </button>
            <button type="reset" class="ghost-btn" id="resetFilters">
              <i class="ri-refresh-line" aria-hidden="true"></i>
              پاک‌سازی فیلترها
            </button>
          </div>
        </form>
      </section>

      <section class="card card--feature" id="quickActionsSection">
        <div class="card-title">
          <i class="ri-flashlight-line" aria-hidden="true"></i>
          <h2>میانبرهای هوشمند فروشگاهی</h2>
        </div>
        <p class="card-subtitle">
          برای مدیریت سریع امور روزانه فروشگاه، از ابزارهای حرفه‌ای زیر استفاده کنید.
        </p>
        <div class="feature-grid">
          <article class="feature-tile">
            <i class="ri-calculator-line" aria-hidden="true"></i>
            <div>
              <h3>محاسبه‌گر سود و زیان روزانه</h3>
              <p>به سرعت سود ناخالص هر روز را بر اساس تراکنش‌های درآمد و هزینه بسنجید.</p>
            </div>
            <button type="button" class="feature-action" data-action="open-profit">
              شروع تحلیل
            </button>
          </article>
          <article class="feature-tile">
            <i class="ri-store-2-line" aria-hidden="true"></i>
            <div>
              <h3>سینک موجودی با انبار</h3>
              <p>گزارش فروش و خرید را با انبار همگام کنید تا کمبود کالا را پیش‌بینی کنید.</p>
            </div>
            <button type="button" class="feature-action" data-action="sync-inventory">
              همگام‌سازی
            </button>
          </article>
          <article class="feature-tile">
            <i class="ri-coin-line" aria-hidden="true"></i>
            <div>
              <h3>یادآور سررسید بدهی و چک</h3>
              <p>برای چک‌ها و بدهی‌ها اعلان تنظیم کنید و قبل از سررسید پیام یادآوری دریافت کنید.</p>
            </div>
            <button type="button" class="feature-action" data-action="create-reminder">
              ساخت یادآور
            </button>
          </article>
          <article class="feature-tile">
            <i class="ri-user-star-line" aria-hidden="true"></i>
            <div>
              <h3>تحلیل عملکرد مشتریان وفادار</h3>
              <p>بهترین مشتریان را بر اساس خرید دوره‌ای بشناسید و کمپین ویژه طراحی کنید.</p>
            </div>
            <button type="button" class="feature-action" data-action="segment-customers">
              مشاهده گزارش
            </button>
          </article>
        </div>
      </section>

      <section class="card card--feature" id="advisorSection">
        <div class="card-title">
          <i class="ri-magic-line" aria-hidden="true"></i>
          <h2>دستیار مالی هوشمند</h2>
        </div>
        <p class="card-subtitle">
          پیشنهادهای تخصصی برای رشد فروشگاه شما بر اساس الگوهای فروش و هزینه‌ها.
        </p>
        <div class="advisor-grid">
          <article class="advisor-tip">
            <h3>بودجه‌بندی فصل آینده</h3>
            <p>
              بر اساس روند سه ماه گذشته، سقف هزینه هر دسته را تعیین کنید تا جریان نقدینگی منفی نشود.
            </p>
            <ul>
              <li>تعیین سقف هزینه تبلیغات و بازاریابی</li>
              <li>پیشنهاد خرید عمده برای کالاهای پرفروش</li>
              <li>برآورد دقیق نقدینگی در پایان ماه</li>
            </ul>
          </article>
          <article class="advisor-tip">
            <h3>تحلیل جریان نقد</h3>
            <p>
              با تطبیق سررسید دریافت‌ها و پرداخت‌ها، کمبود نقدینگی را ۱۰ روز قبل شناسایی کنید.
            </p>
            <ul>
              <li>یادآوری خودکار برای دریافت از مشتریان عمده</li>
              <li>پیشنهاد تقسیط برای بدهی‌های سنگین</li>
              <li>گزارش روزانه از وضعیت نقدینگی</li>
            </ul>
          </article>
          <article class="advisor-tip">
            <h3>پشتیبانی مالیاتی</h3>
            <p>
              اسناد فروش و خرید را دسته‌بندی کنید تا در پایان فصل گزارش مالیاتی آماده داشته باشید.
            </p>
            <ul>
              <li>تولید فایل خروجی اکسل برای حسابرس</li>
              <li>ثبت سریع فاکتورهای خرید و هزینه</li>
              <li>گزارش تجمیعی ارزش افزوده</li>
            </ul>
          </article>
        </div>
      </section>

      <section class="card" id="reportsSection">
        <div class="card-title">
          <i class="ri-file-list-3-line" aria-hidden="true"></i>
          <h2>گزارش تراکنش‌های ثبت شده</h2>
        </div>
        <p class="card-subtitle">گزارش زیر بر اساس داده‌های ذخیره شده در بک‌اند تولید شده است.</p>
        <div class="totals-grid">
          <div class="total-box total-income">
            <span class="total-label">کل درآمد</span>
            <strong id="totalIncome">۰ تومان</strong>
          </div>
          <div class="total-box total-expense">
            <span class="total-label">کل هزینه</span>
            <strong id="totalExpense">۰ تومان</strong>
          </div>
          <div class="total-box total-balance">
            <span class="total-label">مانده شما</span>
            <strong id="totalBalance">۰ تومان</strong>
          </div>
        </div>

        <div class="status-summary">
          <div class="status-box status-pending">
            <span class="status-label">در انتظار تسویه</span>
            <strong id="pendingAmount">۰ تومان</strong>
            <small><span id="pendingCount">۰</span> تراکنش</small>
          </div>
          <div class="status-box status-overdue">
            <span class="status-label">سررسید گذشته</span>
            <strong id="overdueAmount">۰ تومان</strong>
            <small><span id="overdueCount">۰</span> تراکنش</small>
          </div>
          <div class="status-box status-paid">
            <span class="status-label">تسویه شده</span>
            <strong id="paidAmount">۰ تومان</strong>
            <small><span id="paidCount">۰</span> تراکنش</small>
          </div>
        </div>

        <div class="active-filters" id="activeFilters" aria-live="polite"></div>
        <p class="entries-count">در حال نمایش <strong id="totalEntriesCount">۰</strong> تراکنش ثبت شده.</p>

        <div class="insights-grid">
          <div class="insight-card">
            <div class="insight-card__header">
              <i class="ri-pie-chart-2-line" aria-hidden="true"></i>
              <h3>دسته‌بندی‌های پرتکرار</h3>
            </div>
            <ul id="categoryBreakdown" class="insight-list"></ul>
          </div>
          <div class="insight-card">
            <div class="insight-card__header">
              <i class="ri-bank-card-line" aria-hidden="true"></i>
              <h3>سهم روش‌های پرداخت</h3>
            </div>
            <ul id="paymentBreakdown" class="insight-list"></ul>
          </div>
          <div class="insight-card">
            <div class="insight-card__header">
              <i class="ri-timer-line" aria-hidden="true"></i>
              <h3>سررسیدهای پیشِ‌رو</h3>
            </div>
            <ul id="upcomingDueList" class="insight-list insight-list--timeline"></ul>
          </div>
        </div>

        <div class="table-wrapper">
          <table class="entries-table">
            <thead>
              <tr>
                <th>عنوان</th>
                <th>نوع</th>
                <th>دسته‌بندی</th>
                <th>مبلغ</th>
                <th>روش پرداخت</th>
                <th>وضعیت</th>
                <th>طرف حساب</th>
                <th>شماره مرجع</th>
                <th>تاریخ ثبت</th>
                <th>تاریخ سررسید</th>
                <th>برچسب‌ها</th>
                <th>توضیحات</th>
              </tr>
            </thead>
            <tbody id="entriesBody"></tbody>
          </table>
          <div class="empty-state" id="emptyState">
            <i class="ri-database-2-line" aria-hidden="true"></i>
            <p>تراکنشی با شرایط فعلی پیدا نشد. فیلترها را تغییر دهید یا تراکنش جدید ثبت کنید.</p>
          </div>
        </div>
      </section>
    </main>

    <nav class="bottom-toolbar" aria-label="ناوبری سریع حسابداری">
      <button class="bottom-toolbar__button is-active" type="button" data-action="add">
        <i class="ri-add-circle-line" aria-hidden="true"></i>
        <span>ثبت تراکنش</span>
      </button>
      <button class="bottom-toolbar__button" type="button" data-action="shortcuts">
        <i class="ri-flashlight-line" aria-hidden="true"></i>
        <span>میانبرها</span>
      </button>
      <button class="bottom-toolbar__button" type="button" data-action="advisor">
        <i class="ri-magic-line" aria-hidden="true"></i>
        <span>دستیار</span>
      </button>
      <button class="bottom-toolbar__button" type="button" data-action="filters">
        <i class="ri-equalizer-line" aria-hidden="true"></i>
        <span>فیلترها</span>
      </button>
      <button class="bottom-toolbar__button" type="button" data-action="report">
        <i class="ri-bar-chart-2-line" aria-hidden="true"></i>
        <span>گزارش‌ها</span>
      </button>
    </nav>
  </div>
</body>
</html>
