<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ ÙØ±ÙˆØ´Ù†Ø¯Ù‡ | ÙˆÛŒØªØ±ÛŒÙ†Øª</title>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;700&display=swap" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    font-family: 'Vazirmatn', sans-serif;
    background: linear-gradient(115deg, #e0fdfa 0%, #f8fafc 65%, #d4fbe8 100%);
    min-height: 100vh;
    transition: background 0.3s ease;
    margin: 0;
  }
  .dark body {
    background: linear-gradient(120deg, #212e2b 0%, #23272f 90%);
  }

  /* Sidebar Styles */
  .sidebar {
    background: rgba(255, 255, 255, 0.98);
    box-shadow: 0 8px 32px rgba(16, 185, 129, 0.1);
    border-radius: 2rem 0 2rem 2rem;
    width: 80px;
    position: fixed;
    top: 2rem;
    right: 2rem;
    height: calc(100vh - 4rem);
    max-height: 520px;
    z-index: 110;
    transition: width 0.3s ease-in-out, right 0.3s ease-in-out;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 16px 0;
    gap: 18px;
    overflow-y: auto;
    overflow-x: visible;
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;     /* Firefox */
  }
  .sidebar::-webkit-scrollbar {
    display: none;
  }

  .sidebar.expanded {
    width: 240px;
    align-items: flex-start;
    padding-right: 20px;
  }

  .sidebar .sidebar-toggle {
    cursor: pointer;
    margin-bottom: 14px;
    margin-right: 4px;
    transition: transform 0.3s ease-in-out;
  }

  .sidebar.expanded .sidebar-toggle {
    transform: rotate(180deg);
  }

  .sidebar .sidebar-avatar {
    width: 54px;
    height: 54px;
    border-radius: 50%;
    border: 3px solid transparent;
    background: linear-gradient(45deg, #0ea5e9, #10b981) border-box;
    margin-bottom: 8px;
    object-fit: cover;
    box-shadow: 0 4px 20px rgba(14, 165, 233, 0.3), 0 0 10px rgba(16, 185, 129, 0.2);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    animation: avatarLoad 0.5s ease-in-out;
  }

  .sidebar .sidebar-avatar:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 24px rgba(14, 165, 233, 0.4), 0 0 15px rgba(16, 185, 129, 0.3);
  }

  @keyframes avatarLoad {
    0% { transform: scale(0.8); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
  }

  .sidebar.expanded .sidebar-avatar {
    margin-bottom: 0;
  }

  @media (max-width: 768px) {
    .sidebar .sidebar-avatar,
    .sidebar.expanded .sidebar-avatar {
      width: 40px;
      height: 40px;
    }
  }

  .sidebar .sidebar-user {
    opacity: 0;
    max-width: 0;
    font-weight: bold;
    margin-bottom: 7px;
    transition: all 0.3s ease-in-out;
    white-space: nowrap;
    font-size: 15px;
    color: #10b981;
    padding-right: 2px;
  }

  .sidebar.expanded .sidebar-user {
    opacity: 1;
    max-width: 220px;
    margin-bottom: 14px;
  }

  .sidebar .sidebar-link {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 1.2rem;
    color: #10b981;
    font-size: 24px;
    background: #f8fafc;
    margin-bottom: 8px;
    position: relative;
    transition: all 0.2s ease-in-out;
    border: none;
    outline: none;
    cursor: pointer;
  }

  .sidebar.expanded .sidebar-link {
    width: 200px;
    justify-content: flex-start;
    font-size: 18px;
    gap: 12px;
    padding-right: 14px;
  }

  .sidebar-link.active,
  .sidebar-link:hover {
    background: #e0fdfa;
    color: #0ea5e9;
    font-weight: bold;
    box-shadow: 0 2px 8px rgba(14, 165, 233, 0.1);
  }

  .sidebar .sidebar-link span {
    opacity: 0;
    transition: opacity 0.2s ease-in-out;
    margin-right: 10px;
    font-weight: bold;
  }

  .sidebar.expanded .sidebar-link span {
    opacity: 1;
  }

  .sidebar .noti-dot {
    position: absolute;
    top: 6px;
    right: 110px;    /* â† Ø§ÛŒÙ†â€ŒØ¬Ø§ */
    left: auto;    /* â† Ùˆ Ø§ÛŒÙ†â€ŒØ¬Ø§ */
    min-width: 18px;
    height: 18px;
    padding: 0 4px;
    background: #f87171;
    color: #fff;
    font-size: 12px;
    line-height: 18px;
    text-align: center;
    border-radius: 9px;
    border: 1px solid #fff;
    box-sizing: border-box;
  }



  .sidebar-hamburger {
    display: none;
    position: fixed;
    top: 16px;
    right: 16px;
    background: #fff;
    border-radius: 50%;
    z-index: 120;
    border: none;
    box-shadow: 0 2px 12px rgba(14, 165, 233, 0.15);
    padding: 12px;
    cursor: pointer;
    transition: background 0.2s ease;
  }

  .sidebar-hamburger:hover {
    background: #e0fdfa;
  }

  .sidebar-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 100;
    transition: opacity 0.3s ease-in-out;
    opacity: 0;
    pointer-events: none;
  }

  .sidebar-overlay.active {
    display: block;
    opacity: 1;
    pointer-events: auto;
  }

  /* Mobile Sidebar */
  @media (max-width: 768px) {
    .sidebar {
      top: 0;
      right: -100%;
      width: 85vw;
      max-width: 340px;
      height: 100vh;
      border-radius: 0;
      padding: 20px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.2);
      transition: right 0.3s ease-in-out;
    }

    .sidebar.expanded {
      right: 0;
      width: 85vw;
      max-width: 340px;
    }

    .sidebar .sidebar-toggle {
      margin-bottom: 0;
      margin-right: 0;
      display: block;
    }

    .sidebar.expanded .sidebar-user {
      font-size: 14px;
      opacity: 1;
      max-width: 100%;
    }

    .sidebar .sidebar-user {
      display: block;
      opacity: 0;
      max-width: 0;
    }

    .sidebar-link span {
      font-size: 15px;
    }

    .sidebar-hamburger {
      display: block;
      z-index: 300;
    }

    .sidebar-overlay {
      display: block;
    }
  }

  @media (min-width: 769px) {
    .sidebar-hamburger {
      display: none !important;
    }
    .sidebar {
      right: 2rem !important;
    }
  }

  /* Stat Cards, Chart, Panels */
  .stat-card {
    background: #fff;
    border-radius: 1.3rem;
    box-shadow: 0 4px 16px rgba(16, 185, 129, 0.08);
    padding: 34px 20px 24px;
    min-width: 120px;
    flex: 1 1 0px;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0 6px;
    position: relative;
    transition: all 0.2s ease;
  }

  .stat-card:hover {
    box-shadow: 0 8px 34px rgba(14, 165, 233, 0.1);
    transform: translateY(-2px) scale(1.018);
  }

  .stat-card .icon {
    position: absolute;
    top: -30px;
    background: #e0fdfa;
    border-radius: 50%;
    padding: 12px;
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.08);
    font-size: 30px;
    color: #10b981;
  }

  .stat-card .stat-label {
    margin-top: 30px;
    font-size: 13px;
    color: #666;
    font-weight: bold;
  }

  .stat-card .stat-value {
    font-size: 2rem;
    font-weight: bold;
    margin-top: 2px;
    color: #1b2e26;
    direction: ltr;
    letter-spacing: 1px;
  }

  .stat-card .stat-growth {
    font-size: 13px;
    margin-top: 5px;
    font-weight: bold;
    color: #10b981;
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .stat-card .stat-growth.negative {
    color: #ef4444;
  }

  .chart-card {
    background: #fff;
    border-radius: 1.3rem;
    box-shadow: 0 4px 18px rgba(16, 185, 129, 0.1);
    margin-top: 35px;
    width: 100%;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    transition: box-shadow 0.2s;
  }

  .chart-tabs {
    display: flex;
    gap: 12px;
    margin-bottom: 10px;
    justify-content: center;
  }

  .chart-tab {
    background: #f1faf7;
    color: #10b981;
    border-radius: 12px;
    padding: 5px 19px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.15s;
    border: 0;
    outline: none;
  }

  .chart-tab.active,
  .chart-tab:hover {
    background: #10b981;
    color: #fff;
  }

  .chart-info {
    font-size: 13px;
    color: #888;
    text-align: center;
    margin-bottom: 2px;
    margin-top: 7px;
  }

  .panel-group {
    display: flex;
    flex-wrap: wrap;
    gap: 22px;
    width: 100%;
    max-width: 1050px;
    margin: 28px auto 0 auto;
    justify-content: center;
  }

  .panel-card {
    flex: 1 1 220px;
    min-width: 220px;
    max-width: 320px;
    background: #fff;
    border-radius: 1.2rem;
    box-shadow: 0 2px 18px rgba(14, 165, 233, 0.1);
    padding: 23px 17px 18px;
    display: flex;
    flex-direction: column;
    gap: 7px;
    position: relative;
    margin-bottom: 14px;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .panel-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(14, 165, 233, 0.2);
  }

  .panel-title {
    font-weight: bold;
    font-size: 15px;
    color: #10b981;
    margin-bottom: 7px;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .notif-item {
    display: flex;
    align-items: center;
    gap: 7px;
    font-size: 13px;
    margin-bottom: 4px;
    color: #ea580c;
  }

  .msg-item {
    font-size: 13px;
    color: #0ea5e9;
    background: #e0fdfa;
    padding: 6px 12px;
    border-radius: 8px;
    margin-bottom: 6px;
    white-space: pre-line;
  }

  .shopinfo-list {
    font-size: 14px;
    color: #333;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .shopinfo-list li {
    margin-bottom: 7px;
  }

  .theme-toggle {
    position: fixed;
    left: 18px;
    top: 16px;
    background: #e0fdfa;
    border: none;
    border-radius: 50%;
    padding: 7px;
    cursor: pointer;
    box-shadow: 0 2px 7px rgba(14, 165, 233, 0.3);
    transition: background 0.14s;
    z-index: 150;
  }

  .theme-toggle:hover {
    background: #0ea5e9;
    color: #fff;
  }

  /* Dark Mode Styles */
  .dark .stat-card,
  .dark .chart-card,
  .dark .panel-card {
    background: #242a31;
    color: #fff;
  }

  .dark .sidebar {
    background: #202a26;
  }

  .dark .sidebar-link,
  .dark .sidebar-link span {
    color: #a7ffeb;
  }

  .dark .sidebar-link.active,
  .dark .sidebar-link:hover {
    background: rgba(22, 185, 138, 0.3);
    color: #fff;
  }

  .dark .chart-tab {
    background: #2a3e37;
    color: #2be1c2;
  }

  .dark .chart-tab.active,
  .dark .chart-tab:hover {
    background: #10b981;
    color: #fff;
  }

  .dark .chart-info {
    color: #bbb;
  }

  .dark .stat-card .stat-label,
  .dark .stat-card .stat-value,
  .dark .panel-title {
    color: #6ee7b7;
  }

  .dark .notif-item {
    color: #facc15;
  }

  .dark .msg-item {
    background: #083344;
    color: #fff;
  }

  .dark .shopinfo-list {
    color: #d1fae5;
  }

  /* Product Table */
  .product-table {
    width: 100%;
    max-width: 600px;
    margin: 20px auto;
    background: #fff;
    border-radius: 1.3rem;
    box-shadow: 0 8px 32px rgba(16, 185, 129, 0.1);
    overflow: hidden;
  }

  .product-table table {
    width: 100%;
    border-collapse: collapse;
  }

  .product-table th,
  .product-table td {
    padding: 12px;
    text-align: center;
    font-size: 15px;
  }

  .product-table th {
    background: #d1fae5;
    color: #047857;
    font-weight: bold;
  }

  .product-table td {
    color: #333;
    border-bottom: 1px solid rgba(16, 185, 129, 0.1);
  }

  .product-table tr:hover {
    background: #e0fdfa;
  }

  @media (max-width: 600px) {
    .product-table th,
    .product-table td {
      font-size: 13px;
      padding: 8px;
    }
  }

  /* Plan Card Styles */
  .plan-card {
    background: #fff;
    border-radius: 1.3rem;
    box-shadow: 0 4px 16px rgba(16, 185, 129, 0.1);
    padding: 24px;
    flex: 1 1 280px;
    max-width: 320px;
    text-align: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .plan-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 8px 24px rgba(14, 165, 233, 0.2);
  }

  .plan-card .plan-title {
    font-size: 1.5rem;
    font-weight: bold;
    color: #10b981;
    margin-bottom: 12px;
  }

  .plan-card .plan-price {
    font-size: 2rem;
    font-weight: bold;
    color: #0ea5e9;
    margin-bottom: 12px;
  }

  .plan-card .plan-features {
    list-style: none;
    padding: 0;
    margin: 0 0 20px;
    font-size: 14px;
    color: #333;
  }

  .plan-card .plan-features li {
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }

  .plan-card .plan-button {
    background: #10b981;
    color: #fff;
    padding: 10px 20px;
    border-radius: 12px;
    font-weight: bold;
    border: none;
    cursor: pointer;
    transition: background 0.2s ease;
  }

  .plan-card .plan-button:hover {
    background: #0ea5e9;
  }

  .dark .plan-card {
    background: #242a31;
  }

  .dark .plan-card .plan-features {
    color: #d1fae5;
  }




/* Ø§ØµÙ„Ø§Ø­ Ú©Ø§Ù…Ù„ Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ Ùˆ Ù†Ù…Ø§ÛŒØ´ ØµØ­ÛŒØ­ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± */
:root {
  --sidebar-bg: rgba(255,255,255,0.98);
  --shadow: 0 8px 32px rgba(16,185,129,0.10);
  --primary: #10b981;
}

/* Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ù¾Ø§ÛŒÙ‡ - ÙÙ‚Ø· Ø¯Ø³Ú©ØªØ§Ù¾ */
.sidebar {
  background: var(--sidebar-bg);
  box-shadow: var(--shadow);
  border-radius: 2rem 0 2rem 2rem;
  width: 80px;
  position: fixed;
  top: 2rem;
  right: 2rem;
  height: calc(100vh - 4rem);
  z-index: 120;
  transition: width 0.3s, transform 0.3s;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 1rem 0;
  gap: 1rem;
  overflow-y: auto;
  overflow-x: hidden;
  will-change: width, transform;
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;     /* Firefox */
  scrollbar-color: #d1fae5 #f1f1f1;
  max-height: 90vh;
}

/* Ø­Ø§Ù„Øª Ø¨Ø§Ø² Ø¯Ø³Ú©ØªØ§Ù¾ */
.sidebar.expanded {
  width: 240px;
  align-items: flex-start;
  padding-right: 1.25rem;
  padding-left: 0.5rem;
  max-height: 100vh;
}

/* Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± */
.sidebar-link {
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 1.2rem;
  color: var(--primary);
  font-size: 21px;
  background: #f8fafc;
  margin-bottom: 6px;
  transition: all 0.2s;
  border: none;
  outline: none;
  cursor: pointer;
  overflow: hidden;
  gap: 0;
  padding-right: 0;
  font-weight: 500;
}

.sidebar.expanded .sidebar-link {
  width: 185px;
  justify-content: flex-start;
  font-size: 16px;
  gap: 11px;
  padding-right: 10px;
}

.sidebar-link span {
  opacity: 0;
  transition: opacity 0.22s;
  margin-right: 10px;
  font-weight: bold;
  white-space: nowrap;
  font-size: 15px;
}
.sidebar.expanded .sidebar-link span {
  opacity: 1;
}

/* Ù‡Ù…Ø¨Ø±Ú¯Ø± */
.hamburger-menu {
  display: none;
  position: fixed;
  top: 17px;
  right: 15px;
  width: 46px;
  height: 46px;
  z-index: 2000;
  background: #fff;
  border-radius: 50%;
  border: none;
  box-shadow: 0 2px 8px rgba(16,185,129,0.13);
  flex-direction: column;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background 0.2s;
  padding: 0;
}
.hamburger-menu span {
  display: block;
  width: 26px;
  height: 3px;
  background: var(--primary);
  border-radius: 2px;
  margin: 4px 0;
  transition: all 0.3s;
}

/* Overlay */
.sidebar-overlay {
  display: none;
}

/* Ù…ÙˆØ¨Ø§ÛŒÙ„ Ùˆ ØªØ¨Ù„Øª: Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ùˆ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ Ù…Ø®ÙÛŒØŒ ÙÙ‚Ø· Ù‡Ù…Ø¨Ø±Ú¯Ø± */
@media (max-width: 1024px) {
  .sidebar {
    top: 0;
    right: 0;
    transform: translateX(105%);
    width: 85vw;
    max-width: 340px;
    height: 100vh;
    border-radius: 0 0 0 2rem;
    padding: 1.5rem 0 1rem 0;
    box-shadow: 0 2px 16px rgba(0,0,0,0.12);
    gap: 1rem;
    transition: transform 0.3s, width 0.3s;
    z-index: 1200;
    visibility: hidden;
    overflow-y: auto;
    max-height: 100vh;
    /* Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ØªÙ…Ø§Ù… Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Ø­Ø§Ù„Øª Ø¨Ø³ØªÙ‡ */
    pointer-events: none;
    opacity: 0;
  }
  .sidebar.expanded {
    transform: translateX(0);
    width: 85vw;
    max-width: 340px;
    align-items: flex-start;
    padding-right: 1rem;
    padding-left: 1rem;
    border-radius: 0 0 0 2rem;
    max-height: 100vh;
    visibility: visible;
    pointer-events: all;
    opacity: 1;
  }
  .sidebar:not(.expanded) .sidebar-link {
    display: none !important;
  }
  .hamburger-menu {
    display: flex;
  }
  .sidebar-overlay {
    display: block;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.4);
    z-index: 1199;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.22s;
  }
  .sidebar.expanded ~ .sidebar-overlay {
    opacity: 1;
    pointer-events: all;
  }
}

/* Ù…ÙˆØ¨Ø§ÛŒÙ„ Ú©ÙˆÚ†Ú© */
@media (max-width: 768px) {
  .sidebar,
  .sidebar.expanded {
    width: 97vw !important;
    min-width: 0 !important;
    max-width: 100vw !important;
    right: 0 !important;
    border-radius: 0 0 0 1.5rem !important;
    padding-right: 3vw !important;
    padding-left: 1vw !important;
    gap: 4px !important;
  }
}

@media (max-width: 520px) {
  .sidebar,
  .sidebar.expanded {
    width: 100vw !important;
    min-width: 0 !important;
    max-width: 100vw !important;
    right: 0 !important;
    padding-right: 1vw !important;
    padding-left: 1vw !important;
    gap: 3px !important;
    border-radius: 0 !important;
  }
  .sidebar-link,
  .sidebar.expanded .sidebar-link {
    width: 100% !important;
    font-size: 15px !important;
    gap: 7px !important;
    padding-right: 4px !important;
  }
}












@media (max-width: 1024px) {
  /* Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ Ú©Ù…ÛŒ Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ: */
  .noti-dot {
    top: 8px;
    right: 8px;
  }
}



  /* Fade In Animation Ø¨Ø±Ø§ÛŒ Ù…Ø¯Ø§Ù„ */
  @keyframes fadeIn {
    from { opacity: 0; transform: scale(.95);}
    to   { opacity: 1; transform: scale(1);}
  }
  .animate-fadeIn {
    animation: fadeIn .35s cubic-bezier(.36,1.32,.3,1) both;
  }

  /* Ø§Ø³Ú©Ø±ÙˆÙ„ Ù…Ù„Ø§ÛŒÙ… Ø¨Ø±Ø§ÛŒ Ø¬Ø¯ÙˆÙ„ Ù…ÙˆØ¨Ø§ÛŒÙ„ */
  #productListMobile {
    scroll-behavior: smooth;
  }

  /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¬Ø¯ÙˆÙ„ Ø¯Ø³Ú©ØªØ§Ù¾ */
  #section-products table {
    border-collapse: separate;
    border-spacing: 0;
    width: 100%;
  }
  #section-products th, #section-products td {
    padding: 14px 8px;
    text-align: center;
    vertical-align: middle;
  }
  #section-products th {
    font-weight: 800;
    font-size: 15px;
    background: #e0fdfa;
    color: #10b981;
    border-bottom: 1.5px solid #d1fae5;
  }
  .dark #section-products th {
    background: #232b26;
    color: #30e8b8;
  }
  #section-products td {
    background: #fff;
    color: #333;
    font-size: 15px;
  }
  .dark #section-products td {
    background: #23272f;
    color: #e1fffa;
  }
  #section-products tr.even td {
    background: #f9fdfa;
  }
  .dark #section-products tr.even td {
    background: #242a31;
  }

  #section-products img {
    box-shadow: 0 2px 10px rgba(16,185,129,0.10);
  }

  /* Ø§Ø³ØªØ§ÛŒÙ„ Ú©Ø§Ø±Øª Ù…ÙˆØ¨Ø§ÛŒÙ„ Ù…Ø­ØµÙˆÙ„Ø§Øª */






/* Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ø§ÛŒÙ†Ú©Ù‡ Ø¯Ú©Ù…Ù‡ overflow: hidden Ù†Ø¯Ø§Ø±Ù‡ */
/* ===== Ù‚Ø§Ù„Ø¨ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Badge Ø¹Ø¯Ø¯ÛŒ ===== */
.sidebar-link {
  position: relative; /* Ù…Ø·Ù…Ø¦Ù† Ø´Ùˆ overflow:visible Ùˆ position:relative Ø¨Ø§Ø´Ø¯ */
  overflow: visible;
}

.noti-dot {
  position: absolute;
  top: 4px;
  right: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 20px;
  height: 20px;
  padding: 0 6px;
  background: #ef4444;
  color: #fff;
  font-size: 12px;
  font-weight: bold;
  line-height: 1;
  border-radius: 10px;
  border: 2px solid #fff;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  z-index: 20;
  transition: transform 0.2s ease;
}

.noti-dot.show {
  transform: scale(1.2);
}


/* ==== Ø§Ø³ØªØ§ÛŒÙ„ Ù¾Ø§Ù¾â€ŒØ§Ù¾ Ù¾ÛŒØ§Ù… Ø¬Ø¯ÛŒØ¯ ==== */
#messagePopup {
  position: fixed;
  /* Ù†Ù…Ø§ÛŒØ´ Ø¨Ø§Ù„Ø§ Ø¨Ù‡ Ø¬Ø§ÛŒ Ù¾Ø§ÛŒÛŒÙ† */
  top: 30px;
  left: 50%;
  bottom: auto; /* Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ù„ØºÙˆ bottom */
  transform: translateX(-50%) translateY(-120%);
  background: #10b981;
  color: #fff;
  padding: 20px 40px;      /* Ø¨Ø²Ø±Ú¯â€ŒØªØ± Ø§Ø² Ù‚Ø¨Ù„ */
  border-radius: 14px;
  box-shadow: 0 6px 28px rgba(0,0,0,0.20);
  font-weight: bold;
  font-size: 18px;         /* ÙÙˆÙ†Øª Ø¨Ø²Ø±Ú¯â€ŒØªØ± */
  opacity: 0;
  transition: transform 0.4s ease, opacity 0.4s ease;
  z-index: 2000;
}

#messagePopup.show {
  transform: translateX(-50%) translateY(0);
  opacity: 1;
}

/* Ù…ÙˆØ¨Ø§ÛŒÙ„ */
@media (max-width: 600px) {
  #messagePopup {
    width: 95vw;
    min-width: unset;
    max-width: 97vw;
    padding: 13px 5vw;
    font-size: 16px;
  }
}



@media (max-width: 1024px) {
  /* Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ Ú©Ù…ÛŒ Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ: */
  .noti-dot {
    top: 8px;
    right: 8px;
  }
}



</style>
</head>
<body>

  <div id="messagePopup">Ù¾ÛŒØ§Ù… Ø¬Ø¯ÛŒØ¯ Ø¯Ø§Ø±ÛŒØ¯: <span id="newMsgCount">0</span> Ù¾ÛŒØ§Ù…</div>

  <!-- Hamburger Button for Mobile -->
  <button class="sidebar-hamburger" onclick="toggleSidebar()" aria-label="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù…Ù†Ùˆ" aria-expanded="false">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
      <path d="M3 6h18M3 12h18M3 18h18" stroke="#10b981" stroke-width="2" stroke-linecap="round"/>
    </svg>
  </button>

  <!-- Sidebar Overlay -->
  <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

  <!-- Sidebar -->
  <!-- Sidebar -->
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <!-- Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ø²/Ø¨Ø³ØªÙ† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± -->
    <button class="sidebar-toggle" onclick="toggleSidebar()" title="Ø¨Ø§Ø²/Ø¨Ø³ØªÙ† Ù…Ù†Ùˆ" aria-label="Ø¨Ø§Ø²/Ø¨Ø³ØªÙ† Ù…Ù†Ùˆ" aria-expanded="false">
      <svg width="28" height="28" viewBox="0 0 24 24">
        <path d="M9 6l6 6-6 6" stroke="#10b981" stroke-width="2" fill="none" stroke-linecap="round"/>
      </svg>
    </button>
    <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± -->
    <button class="sidebar-link active" id="menu-visit" onclick="showSection('visit')" aria-label="Ø¢Ù…Ø§Ø± Ø¨Ø§Ø²Ø¯ÛŒØ¯">
      <svg width="22" height="22" fill="none" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="9" stroke="#10b981" stroke-width="2"/>
        <path d="M9 12l2 2 4-4" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <span>Ø¢Ù…Ø§Ø± Ø¨Ø§Ø²Ø¯ÛŒØ¯</span>
    </button>
    <button class="sidebar-link" id="menu-register-visit" onclick="showSection('register-visit')" aria-label="Ø«Ø¨Øª Ø¢Ù…Ø§Ø± Ø¨Ø§Ø²Ø¯ÛŒØ¯">
      <svg width="22" height="22" fill="none" viewBox="0 0 24 24">
        <rect x="3" y="4" width="18" height="18" rx="2" stroke="#10b981" stroke-width="2"/>
        <path d="M16 2v4M8 2v4M3 10h18" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <span>Ø«Ø¨Øª Ø¢Ù…Ø§Ø± Ø¨Ø§Ø²Ø¯ÛŒØ¯</span>
    </button>
    <button class="sidebar-link" id="menu-performance" aria-label="ÙˆØ¶Ø¹ÛŒØª Ø¹Ù…Ù„Ú©Ø±Ø¯">
      <i class="ri-bar-chart-fill"></i>
      <span>ÙˆØ¶Ø¹ÛŒØª Ø¹Ù…Ù„Ú©Ø±Ø¯</span>
    </button>
    <button class="sidebar-link" id="menu-add" onclick="showSection('add')" aria-label="Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„">
      <svg width="22" height="22" fill="none" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10" stroke="#10b981" stroke-width="2"/>
        <path d="M12 8v8M8 12h8" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <span>Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„</span>
    </button>
    <button class="sidebar-link" id="menu-products" onclick="showSection('products')" aria-label="Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø­ØµÙˆÙ„Ø§Øª">
      <svg width="22" height="22" fill="none" viewBox="0 0 24 24">
        <rect x="3" y="6" width="18" height="13" rx="3" stroke="#10b981" stroke-width="2"/>
        <path d="M8 13h8" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <span>Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø­ØµÙˆÙ„Ø§Øª</span>
    </button>
    <button class="sidebar-link" id="menu-content" onclick="showSection('content')" aria-label="Ù…Ø¯ÛŒØ±ÛŒØª Ø¸Ø§Ù‡Ø± ÙØ±ÙˆØ´Ú¯Ø§Ù‡">
      <svg width="22" height="22" fill="none" viewBox="0 0 24 24">
        <rect x="4" y="4" width="16" height="16" rx="3" stroke="#10b981" stroke-width="2"/>
        <path d="M8 8h8M8 12h8M8 16h8" stroke="#0ea5e9" stroke-width="2"/>
      </svg>
      <span>Ù…Ø¯ÛŒØ±ÛŒØª Ø¸Ø§Ù‡Ø± ÙØ±ÙˆØ´Ú¯Ø§Ù‡</span>
    </button>

    <button class="sidebar-link" id="btn-shop-preview" type="button" aria-label="Ù¾ÛŒØ´Ù†Ù…Ø§ÛŒØ´ Ø³Ø§ÛŒØª">
      <svg width="22" height="22" fill="none" viewBox="0 0 24 24">
        <rect x="3" y="6" width="18" height="13" rx="3" stroke="#0ea5e9" stroke-width="2"/>
        <path d="M8 9h8M8 13h5" stroke="#10b981" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <span>Ù¾ÛŒØ´Ù†Ù…Ø§ÛŒØ´ Ø³Ø§ÛŒØª</span>
    </button>

    <button class="sidebar-link" id="menu-notif" onclick="showSection('notif')" aria-label="ØªØ§Ø¨Ù„Ùˆ ÙØ±ÙˆØ´Ú¯Ø§Ù‡">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
        <path d="M19 17H5l1-8a7 7 0 1114 0l-1 8z" stroke="#fb923c" stroke-width="2"/>
        <circle cx="19" cy="7" r="2.5" fill="#f87171"/>
      </svg>
      <span>ØªØ§Ø¨Ù„Ùˆ ÙØ±ÙˆØ´Ú¯Ø§Ù‡</span>
    </button>

    <!-- Ù¾ÛŒØ§Ù… Ù‡Ø§ - Ø¯Ù‚ÛŒÙ‚Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨ÛŒÙ† notif Ùˆ upgrade Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯ -->
    <button class="sidebar-link relative" id="menu-msg" onclick="showSection('msg')" aria-label="Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§">
      <svg width="22" height="22" fill="none" viewBox="0 0 24 24">
        <rect x="3" y="5" width="18" height="14" rx="3" stroke="#0ea5e9" stroke-width="2"/>
        <path d="M3 7l9 6 9-6" stroke="#10b981" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <span>Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§</span>
      <!-- Badge for unread messages -->
      <span id="msgBadge" class="noti-dot" style="display:none; z-index: 10;"></span>
    </button>


    <!-- Ø¯Ú©Ù…Ù‡ Ø§Ø±ØªÙ‚Ø§ Ø¯Ø± Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± (Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡) -->
    <button class="sidebar-link" id="menu-upgrade" aria-label="Ø§Ø±ØªÙ‚Ø§" >
        <svg width="22" height="22" fill="none" viewBox="0 0 24 24">
            <path d="M12 2l3.5 7 7.5 1-5.5 5.5 1.5 7.5-7-4-7 4 1.5-7.5-5.5-5.5 7.5-1L12 2z" stroke="#f59e0b" stroke-width="2"/>
        </svg>
        <span>Ø§Ø±ØªÙ‚Ø§</span>
    </button>

    <button class="sidebar-link" id="menu-guide" onclick="showSection('guide')" aria-label="Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡">
      <svg width="22" height="22" fill="none" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10" stroke="#0ea5e9" stroke-width="2"/>
        <path d="M12 7v5" stroke="#10b981" stroke-width="2" stroke-linecap="round"/>
        <circle cx="12" cy="16" r="1.2" fill="#10b981"/>
      </svg>
      <span>Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡</span>
    </button>
  </aside>



  <!-- Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ØªÙˆØ§ÛŒ Ù„ÙˆØ¯Ø´ÙˆÙ†Ø¯Ù‡ Ø§Ø³Øª -->
  <div id="main-content"></div>
  <!-- Ù…Ø­ØªÙˆØ§ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¹Ù…Ù„Ú©Ø±Ø¯ -->
  <div id="performance-container" style="display:none;"></div>




  <!-- Theme Toggle -->
  <button class="theme-toggle" onclick="toggleTheme()" title="ØªØºÛŒÛŒØ± ØªÙ…" aria-label="ØªØºÛŒÛŒØ± ØªÙ…">
    <svg id="theme-icon" width="19" height="19" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="5" stroke="#10b981" stroke-width="2" fill="none"/>
      <path d="M12 3v2m0 14v2m9-9h-2M5 12H3m15.5 6.5l-1.5-1.5M6.5 6.5l-1.5-1.5m12 0l-1.5 1.5M6.5 17.5l-1.5 1.5" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/>
    </svg>
  </button>

  <!-- Main Content -->
  <div class="main-container flex flex-col items-center justify-center min-h-screen p-4 sm:p-6 md:p-10">
    <!-- Ø¢Ù…Ø§Ø± Ø¨Ø§Ø²Ø¯ÛŒØ¯ -->
    <section id="section-visit">
<h1 class="text-2xl md:text-3xl font-extrabold text-[#10b981] text-center mb-2">
  Ø³Ù„Ø§Ù… <span id="seller-welcome" style="color:#0ea5e9;">ÙØ±ÙˆØ´Ù†Ø¯Ù‡ Ø¹Ø²ÛŒØ²</span> ğŸ‘‹
</h1>
      <div class="text-gray-500 text-[15px] mb-8 text-center">Ø¢Ù…Ø§Ø± Ùˆ ÙˆØ¶Ø¹ÛŒØª ÙØ±ÙˆØ´Ú¯Ø§Ù‡Øª Ø±Ùˆ ÛŒÚ©Ø¬Ø§ Ø¨Ø¨ÛŒÙ† Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†!</div>
      <div class="w-full max-w-2xl flex flex-wrap justify-center gap-4 mb-7">
        <div class="stat-card w-full sm:w-auto">
          <div class="icon">
            <svg width="24" height="24" fill="none" viewBox="0 0 24 24"><path d="M3 12l2-2 4 4 8-8 4 4" stroke="#10b981" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
          <div class="stat-label">Ú©Ù„ Ø¨Ø§Ø²Ø¯ÛŒØ¯Ù‡Ø§</div>
          <div class="stat-value" id="totalViews">18,974</div>
          <div class="stat-growth">
            <svg width="14" height="14" viewBox="0 0 16 16"><path d="M3 9l4-4 3.5 3.5 2.5-2.5" stroke="#10b981" stroke-width="2" fill="none" stroke-linecap="round"/></svg>
            +7.1%
          </div>
        </div>
        <div class="stat-card w-full sm:w-auto">
          <div class="icon" style="background:#ffe7d2;">
            <svg width="24" height="24" fill="none" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="#fb923c" stroke-width="2"/><path d="M12 8v4l3 2" stroke="#fb923c" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
          <div class="stat-label">Ø§ÛŒÙ† Ù…Ø§Ù‡</div>
          <div class="stat-value text-[#fb923c]" id="monthViews">983</div>
          <div class="stat-growth">
            <svg width="14" height="14" viewBox="0 0 16 16"><path d="M3 9l4-4 3.5 3.5 2.5-2.5" stroke="#fb923c" stroke-width="2" fill="none" stroke-linecap="round"/></svg>
            +5.2%
          </div>
        </div>
        <div class="stat-card w-full sm:w-auto">
          <div class="icon" style="background:#e3f4fd;">
            <svg width="24" height="24" fill="none" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="#0ea5e9" stroke-width="2"/><path d="M12 6v6l4 2" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
          <div class="stat-label">Ø¯ÛŒØ±ÙˆØ²</div>
          <div class="stat-value text-[#0ea5e9]" id="yesterdayViews">160</div>
          <div class="stat-growth negative">
            <svg width="14" height="14" viewBox="0 0 16 16"><path d="M13 7l-4 4-3.5-3.5-2.5 2.5" stroke="#ef4444" stroke-width="2" fill="none" stroke-linecap="round"/></svg>
            -2.5%
          </div>
        </div>
        <div class="stat-card w-full sm:w-auto">
          <div class="icon" style="background:#e7fae8;">
            <svg width="24" height="24" fill="none" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="#10b981" stroke-width="2"/><path d="M12 8v6" stroke="#10b981" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
          <div class="stat-label">Ø§Ù…Ø±ÙˆØ²</div>
          <div class="stat-value text-[#10b981]" id="todayViews">148</div>
          <div class="stat-growth">
            <svg width="14" height="14" viewBox="0 0 16 16"><path d="M3 9l4-4 3.5 3.5 2.5-2.5" stroke="#10b981" stroke-width="2" fill="none" stroke-linecap="round"/></svg>
            +4.3%
          </div>
        </div>
      </div>
      <div class="chart-card p-4 sm:p-6">
        <div class="chart-tabs">
          <button class="chart-tab active" id="tab-week" onclick="switchChart('week')">Ù‡ÙØªÚ¯ÛŒ</button>
          <button class="chart-tab" id="tab-month" onclick="switchChart('month')">Ù…Ø§Ù‡Ø§Ù†Ù‡</button>
        </div>
        <div class="text-md font-bold text-[#10b981] mb-2 text-center" id="chartTitle">Ù†Ù…ÙˆØ¯Ø§Ø± Ø¨Ø§Ø²Ø¯ÛŒØ¯ Ù‡ÙØªÚ¯ÛŒ</div>
        <canvas id="visitChart" height="150"></canvas>
        <div class="chart-info">Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: Ø§Ù…Ø±ÙˆØ² | Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯</div>
      </div>

      <!-- Product Table -->
      <div class="product-table overflow-x-auto">
        <table class="min-w-full">
          <thead>
            <tr>
              <th>Ù…Ø­ØµÙˆÙ„</th>
              <th>Ø¨Ø§Ø²Ø¯ÛŒØ¯ Ø§ÛŒÙ† Ù…Ø§Ù‡</th>
              <th>Ø¨Ø§Ø²Ø¯ÛŒØ¯ Ú©Ù„</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Ù¾Ø³ØªÙ‡ Ù…Ù…ØªØ§Ø²</td>
              <td>Û³ÛµÛµ</td>
              <td>Û·Û²Û°Û°</td>
            </tr>
            <tr>
              <td>Ø²Ø¹ÙØ±Ø§Ù† ØµØ§Ø¯Ø±Ø§ØªÛŒ</td>
              <td>Û²Û·Û¸</td>
              <td>Û¶Û¹ÛµÛ°</td>
            </tr>
            <tr>
              <td>Ø®Ø±Ù…Ø§ÛŒ Ú©Ø¨Ú©Ø§Ø¨</td>
              <td>Û±Û¹Û°</td>
              <td>Û´Û´Û°Û°</td>
            </tr>
            <tr>
              <td>Ø¹Ø³Ù„ Ø·Ø¨ÛŒØ¹ÛŒ</td>
              <td>Û±Û¶Û°</td>
              <td>Û³Û·Û°Û°</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>





















    <!-- Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ -->


    <!-- Ù¾Ø±ÙˆÙØ§ÛŒÙ„ -->
    <section id="section-profile" style="display:none">
      <h2 class="text-2xl md:text-3xl font-extrabold text-[#10b981] text-center mb-3">Ù¾Ø±ÙˆÙØ§ÛŒÙ„ ÙØ±ÙˆØ´Ù†Ø¯Ù‡</h2>
      <div class="panel-card mx-auto w-full sm:w-auto">
  <ul class="shopinfo-list">
  <li>Ù†Ø§Ù…: <strong id="seller-profile-name">-</strong></li>
  <li>Ø§ÛŒÙ…ÛŒÙ„: <strong id="seller-profile-email">-</strong></li>
  <li>Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³: <strong id="seller-profile-phone">-</strong></li>
</ul>

      </div>
    </section>

    <!-- ØªÙ†Ø¸ÛŒÙ…Ø§Øª -->
    <section id="section-settings" style="display:none">
      <h2 class="text-2xl md:text-3xl font-extrabold text-[#fb923c] text-center mb-3">ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙØ±ÙˆØ´Ù†Ø¯Ù‡</h2>
      <div class="panel-card mx-auto w-full sm:w-auto">
        <ul class="shopinfo-list">
          <li>ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</li>
          <li>Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§</li>
          <li>Ø­Ø°Ù Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ</li>
        </ul>
      </div>
    </section>

    <!-- Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ -->
<section id="section-add" style="display:none;">
  <h2 class="text-2xl md:text-3xl font-extrabold text-[#10b981] text-center mb-3 flex items-center justify-center gap-2">
    <svg width="28" height="28" fill="none" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="#10b981" stroke-width="2"/><path d="M12 8v8M8 12h8" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/></svg>
    Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯
  </h2>
  <div class="panel-card mx-auto w-full max-w-2xl bg-[#f9fdfb] shadow-2xl border border-[#10b98122] rounded-3xl p-6 sm:p-10 transition-all duration-300">
    <form id="addProductForm" autocomplete="off">
      <!-- Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„ -->
      <div class="mb-4">
        <label class="block font-bold mb-1 text-[#10b981]">Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„ <span class="text-red-500">*</span></label>
        <input name="title" type="text" class="w-full p-3 border rounded-xl focus:outline-none focus:ring-2 focus:ring-[#10b981] text-lg" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ú©ÙØ´ Ù…Ø±Ø¯Ø§Ù†Ù‡ Ú†Ø±Ù…" required>
      </div>
      <!-- Ù‚ÛŒÙ…Øª -->
      <div class="mb-4">
        <label class="block font-bold mb-1 text-[#10b981]">Ù‚ÛŒÙ…Øª (ØªÙˆÙ…Ø§Ù†) <span class="text-red-500">*</span></label>
        <input name="price" type="number" min="1" class="w-full p-3 border rounded-xl focus:outline-none focus:ring-2 focus:ring-[#10b981] text-lg" placeholder="Ù…Ø«Ù„Ø§Ù‹: 570000" required>
      </div>
      <!-- Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ -->
      <div class="mb-4">
        <label class="block font-bold mb-1 text-[#10b981]">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ <span class="text-red-500">*</span></label>
        <input name="category" type="text" class="w-full p-3 border rounded-xl focus:outline-none focus:ring-2 focus:ring-[#10b981] text-lg" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ù…Ø±Ø¯Ø§Ù†Ù‡ / Ø²Ù†Ø§Ù†Ù‡ / Ø¨Ú†Ú¯Ø§Ù†Ù‡ ..." required>
      </div>
      <!-- ØªÚ¯â€ŒÙ‡Ø§ ÙÙ‚Ø· ÛŒÚ©ÛŒ Ù‚Ø§Ø¨Ù„ Ø§Ù†ØªØ®Ø§Ø¨ -->
      <div class="mb-4">
        <label class="block font-bold mb-1 text-[#10b981]">Ø¨Ø±Ú†Ø³Ø¨ Ù…Ø­ØµÙˆÙ„</label>
        <div class="flex gap-5 flex-wrap">
          <label class="flex items-center gap-2 text-gray-600 cursor-pointer text-base">
            <input type="radio" name="tag" value="Ù¾Ø±ÙØ±ÙˆØ´" class="accent-[#10b981]" required>
            <span>Ù¾Ø±ÙØ±ÙˆØ´</span>
          </label>
          <label class="flex items-center gap-2 text-gray-600 cursor-pointer text-base">
            <input type="radio" name="tag" value="Ø¬Ø¯ÛŒØ¯" class="accent-[#10b981]" required>
            <span>Ø¬Ø¯ÛŒØ¯</span>
          </label>
        </div>
      </div>
      <!-- ØªÙˆØ¶ÛŒØ­Ø§Øª -->
      <div class="mb-4">
        <label class="block font-bold mb-1 text-[#10b981]">ØªÙˆØ¶ÛŒØ­Ø§Øª <span class="text-red-500">*</span></label>
        <textarea name="desc" class="w-full p-3 border rounded-xl focus:outline-none focus:ring-2 focus:ring-[#10b981] text-lg" rows="3" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø­ØµÙˆÙ„ ..." required></textarea>
      </div>
      <!-- Ø¢Ù¾Ù„ÙˆØ¯ Ø¹Ú©Ø³ Ø¨Ø§ Ø¯Ú©Ù…Ù‡ Ø³ÙØ§Ø±Ø´ÛŒ Ùˆ Ù…Ø¯Ø±Ù† -->
      <div class="mb-5">
        <label class="block font-bold mb-2 text-[#10b981]">Ø¹Ú©Ø³ Ù…Ø­ØµÙˆÙ„ <span class="text-red-500">*</span>
          <span class="text-xs text-gray-500">(Ø­Ø¯Ø§Ù‚Ù„ Û³ Ø¹Ú©Ø³)</span>
        </label>
        <div class="w-full">
          <label for="productImagesInput" tabindex="0" class="flex flex-col items-center justify-center border-2 border-dashed border-[#10b981] rounded-2xl py-8 bg-white cursor-pointer transition hover:bg-[#f0fcf7] active:scale-95 w-full select-none">
            <svg width="42" height="42" fill="none" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="#10b981" stroke-width="2"/><path d="M12 8v8M8 12h8" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/></svg>
            <span class="mt-2 text-[#10b981] font-bold text-lg">Ø§Ù†ØªØ®Ø§Ø¨ Ø¹Ú©Ø³</span>
            <span class="text-gray-500 text-sm mt-1">Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ú†Ù†Ø¯ Ø¹Ú©Ø³ Ø±Ø§ Ù‡Ù…Ø²Ù…Ø§Ù† Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</span>
          </label>
          <input name="images" id="productImagesInput" type="file" accept="image/*" multiple class="hidden" required>
        </div>
        <div id="imagePreview" class="flex flex-wrap gap-2 mt-3"></div>
        <div id="imgErrorMsg" class="text-red-500 text-sm mt-2 hidden">Ø­Ø¯Ø§Ù‚Ù„ Û³ Ø¹Ú©Ø³ Ø§Ù„Ø²Ø§Ù…ÛŒ Ø§Ø³Øª.</div>
      </div>
      <button type="submit" class="bg-[#10b981] hover:bg-[#0ea5e9] text-white rounded-2xl py-3 px-7 font-extrabold text-[18px] transition w-full mt-3 shadow-lg">
        Ø«Ø¨Øª Ù…Ø­ØµÙˆÙ„
      </button>
    </form>
    <div id="addSuccess" class="hidden mt-7 bg-[#e0fdfa] text-[#10b981] p-4 rounded-2xl text-center font-bold text-lg">
      Ù…Ø­ØµÙˆÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§ÙØ²ÙˆØ¯Ù‡ Ø´Ø¯!
    </div>
  </div>
</section>




<!-- Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø­ØµÙˆÙ„Ø§Øª -->

<!-- Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø­ØµÙˆÙ„Ø§Øª -->
<section id="section-products" style="display:none;">
  <h2 class="text-2xl md:text-3xl font-extrabold text-[#10b981] text-center mb-3 flex items-center justify-center gap-2">
    <svg width="28" height="28" fill="none" viewBox="0 0 24 24">
      <rect x="3" y="6" width="18" height="13" rx="3" stroke="#10b981" stroke-width="2"/>
      <path d="M8 13h8" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/>
    </svg>
    Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø­ØµÙˆÙ„Ø§Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡
  </h2>
  <div class="panel-card mx-auto w-full max-w-2xl bg-[#f9fdfb] shadow-xl border border-[#10b98122] rounded-2xl animate-fadeIn">

    <!-- Ø¬Ø¯ÙˆÙ„ Ù…Ø­ØµÙˆÙ„Ø§Øª ÙÙ‚Ø· Ø¯Ø³Ú©ØªØ§Ù¾ Ùˆ ØªØ¨Ù„Øª -->
    <div class="overflow-x-auto mt-1 hidden md:block">
      <table class="min-w-full text-[15px] bg-white rounded-xl border border-gray-200 overflow-hidden" id="productsTable">
        <thead class="bg-[#f1f7f5]">
          <tr>
            <th class="px-2 py-3 text-right font-bold min-w-[60px]">Ø¹Ú©Ø³</th>
            <th class="px-2 py-3 text-right font-bold min-w-[120px]">Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„</th>
            <th class="px-2 py-3 text-right font-bold min-w-[80px]">Ù‚ÛŒÙ…Øª</th>
            <th class="px-2 py-3 text-right font-bold min-w-[100px]">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</th>
            <th class="px-2 py-3 text-right font-bold min-w-[90px]">Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§</th>
            <th class="px-2 py-3 text-right font-bold min-w-[70px]">ÙˆÛŒØ±Ø§ÛŒØ´</th>
            <th class="px-2 py-3 text-right font-bold min-w-[60px]">Ø­Ø°Ù</th>
          </tr>
        </thead>
        <tbody id="productsTableBody" class="divide-y divide-gray-100">
          <!-- Ù…Ø­ØµÙˆÙ„Ø§Øª Ø§ÛŒÙ†Ø¬Ø§ Ø±Ù†Ø¯Ø± Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
        </tbody>
      </table>
    </div>

    <!-- Ú©Ø§Ø±Øª Ù…Ø­ØµÙˆÙ„Ø§Øª ÙÙ‚Ø· Ù…ÙˆØ¨Ø§ÛŒÙ„ (Ø²ÛŒØ± Ø³Ø§ÛŒØ² md) -->
    <div id="productsMobileList" class="md:hidden flex flex-col gap-3 mt-3">
      <!-- Ú©Ø§Ø±Øª Ù‡Ø± Ù…Ø­ØµÙˆÙ„ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ø§ JS Ø±Ù†Ø¯Ø± Ù…ÛŒâ€ŒØ´Ù‡ (Ù…Ø«Ø§Ù„ Ú©Ø§Ø±Øª Ø®Ø§Ù… Ø¯Ø± Ù¾Ø§ÛŒÛŒÙ†) -->
      <!-- 
      <div class="flex items-center gap-3 bg-white rounded-xl shadow p-3 border border-gray-100">
        <img src="Ø¢Ø¯Ø±Ø³_Ø¹Ú©Ø³" alt="" class="w-14 h-14 object-cover rounded-lg border" />
        <div class="flex-1 flex flex-col gap-1">
          <div class="font-bold text-[#10b981] text-[15px]">Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„</div>
          <div class="text-gray-600 text-xs">Ø¯Ø³ØªÙ‡: <span class="font-bold">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</span></div>
          <div class="text-[#0ea5e9] text-sm font-bold">Ù‚ÛŒÙ…Øª: Û²Û³Û°,Û°Û°Û°</div>
          <div class="text-xs text-gray-400 mt-1">Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§: <span class="font-bold">Ù¾Ø±ÙØ±ÙˆØ´ØŒ Ø¬Ø¯ÛŒØ¯</span></div>
        </div>
        <div class="flex flex-col gap-2">
          <button class="bg-[#10b981] hover:bg-[#0ea5e9] text-white rounded-lg px-2 py-1 text-xs font-bold transition" onclick="...">ÙˆÛŒØ±Ø§ÛŒØ´</button>
          <button class="bg-red-500 hover:bg-red-600 text-white rounded-lg px-2 py-1 text-xs font-bold transition" onclick="...">Ø­Ø°Ù</button>
        </div>
      </div>
      -->
    </div>

    <!-- Ù¾ÛŒØ§Ù… Ø®Ø§Ù„ÛŒ -->
    <div id="noProductMsg" class="text-center text-gray-400 text-[16px] py-6 hidden">Ù‡ÛŒÚ† Ù…Ø­ØµÙˆÙ„ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª!</div>
  </div>

  <!-- Ù…Ø¯Ø§Ù„ ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„ -->
<!-- Ù…Ø¯Ø§Ù„ ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„ - Ú©Ø§Ù…Ù„Ø§Ù‹ Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ Ùˆ Ù…ÙˆØ¨Ø§ÛŒÙ„â€ŒÙØ±Ù†Ø¯Ù„ÛŒ -->
<div id="editProductModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40" style="display:none;">
  <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md mx-2 p-3 sm:p-5 relative animate-fadeIn"
      style="max-height:95vh;display:flex;flex-direction:column;">
    <!-- Ø¯Ú©Ù…Ù‡ Ø¨Ø³ØªÙ† -->
    <button class="absolute left-3 top-3 text-gray-400 hover:text-red-500" onclick="closeEditModal()" aria-label="Ø¨Ø³ØªÙ†">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M6 18L18 6M6 6l12 12" stroke="#ef4444" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </button>
    <h3 class="text-xl font-bold text-[#0ea5e9] mb-3 text-center mt-1">ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„</h3>
    <!-- Ø¨Ø¯Ù†Ù‡ ÙØ±Ù… Ø§Ø³Ú©Ø±ÙˆÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ú©ÙˆÚ†Ú© -->
    <form id="editProductForm"
          class="space-y-3 flex-1 overflow-y-auto px-1"
          style="min-width:0;max-height:calc(85vh - 70px);" autocomplete="off">
      <input type="hidden" name="productId" />
      <div>
        <label class="block font-bold mb-1 text-[#10b981]">Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„</label>
        <input name="title" type="text"
              class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#10b981] text-base"
              required>
      </div>
      <div>
        <label class="block font-bold mb-1 text-[#10b981]">Ù‚ÛŒÙ…Øª (ØªÙˆÙ…Ø§Ù†)</label>
        <input name="price" type="number" min="1"
              class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#10b981] text-base"
              required>
      </div>
      <div>
        <label class="block font-bold mb-1 text-[#10b981]">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</label>
        <input name="category" type="text"
              class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#10b981] text-base"
              required>
      </div>
      <div>
        <label class="block font-bold mb-1 text-[#10b981]">Ø¨Ø±Ú†Ø³Ø¨ Ù…Ø­ØµÙˆÙ„</label>
        <div class="flex gap-5 flex-wrap" id="editTagRadioGroup">
          <label class="flex items-center gap-2 text-gray-600 cursor-pointer text-base">
            <input type="radio" name="tag" value="Ù¾Ø±ÙØ±ÙˆØ´" class="accent-[#10b981]">
            <span>Ù¾Ø±ÙØ±ÙˆØ´</span>
          </label>
          <label class="flex items-center gap-2 text-gray-600 cursor-pointer text-base">
            <input type="radio" name="tag" value="Ø¬Ø¯ÛŒØ¯" class="accent-[#10b981]">
            <span>Ø¬Ø¯ÛŒØ¯</span>
          </label>
        </div>
      </div>
      <div>
        <label class="block font-bold mb-1 text-[#10b981]">ØªÙˆØ¶ÛŒØ­Ø§Øª</label>
        <textarea name="desc"
                  class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#10b981] text-base"
                  rows="2"></textarea>
      </div>
<div>
  <label class="block font-bold mb-1 text-[#10b981]">Ø¹Ú©Ø³ Ù…Ø­ØµÙˆÙ„</label>
  <div id="editImagePreview" class="flex flex-wrap gap-2 mb-2"></div>
  <input
    name="images"
    id="editProductImagesInput"
    type="file"
    accept="image/*"
    multiple
    class="w-full p-2 border rounded-lg bg-white text-base"
    onchange="previewEditImages(event)"
    style="direction: ltr"
  >
  <div id="editImgHelp" class="text-xs text-gray-500 mt-1">
    Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ ØªØ§ <b>Û³ Ø¹Ú©Ø³</b> Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯. Ø¨Ø±Ø§ÛŒ Ø­Ø°Ù Ù‡Ø± Ø¹Ú©Ø³ Ø±ÙˆÛŒ <b>Ø¶Ø±Ø¨Ø¯Ø±</b> Ø¨Ø²Ù†ÛŒØ¯.
  </div>
  <div id="editImgErrorMsg" class="text-xs text-red-500 mt-1 hidden"></div>
</div>


      <!-- ÙØ§ØµÙ„Ù‡ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ú©Ù‡ Ø¯Ú©Ù…Ù‡ Ø²ÛŒØ± ÙØ±Ù… Ù‚Ø±Ø§Ø± Ø¨Ú¯ÛŒØ±Ù‡ -->
      <div style="height:4px"></div>
      <button type="submit"
              class="bg-[#10b981] hover:bg-[#0ea5e9] text-white rounded-xl py-2 px-6 font-bold text-base transition w-full mt-2 shadow">
        Ø«Ø¨Øª ØªØºÛŒÛŒØ±Ø§Øª
      </button>
    </form>
  </div>
</div>









<script>



// Û±) ÙØ§Ù†Ú©Ø´Ù† Ø¨Ø±Ø§ÛŒ Ú¯Ø±ÙØªÙ† Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ±ÙˆØ´Ù†Ø¯Ù‡
// Û±) ÙØ§Ù†Ú©Ø´Ù† Ø¨Ø±Ø§ÛŒ Ú¯Ø±ÙØªÙ† Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ±ÙˆØ´Ù†Ø¯Ù‡â€ŒÛŒ Ø¬Ø§Ø±ÛŒ
// === dashboard.html (ÛŒØ§ Ù‡Ø± Ø¬Ø§ Ú©Ù‡ Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ Ù‡Ø³Øª) ===
// ØªØ§Ø¨Ø¹ Ø¯Ø±ÛŒØ§ÙØª ØªØ¹Ø¯Ø§Ø¯ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù‡ Ù†Ø´Ø¯Ù‡
 // Ú¯Ø±ÙØªÙ† ÙØ±ÙˆØ´Ù†Ø¯Ù‡ Ø¬Ø§Ø±ÛŒ
async function fetchCurrentSeller() {
  try {
    const res = await fetch('/api/auth/getCurrentSeller', {
      method: 'GET',
      credentials: 'include'
    });
    if (!res.ok) {
      window.location.href = 'login.html';
      throw new Error('Not authenticated');
    }
    const { seller } = await res.json();
    return seller;
  } catch (err) {
    console.error('Error fetching seller:', err);
    window.location.href = 'login.html';
    return null;
  }
}

// â€”â€”â€”â€”â€”â€”â€”â€”â€” ØªØ§Ø¨Ø¹ Ø¯Ø±ÛŒØ§ÙØª ØªØ¹Ø¯Ø§Ø¯ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù‡â€ŒÙ†Ø´Ø¯Ù‡ â€”â€”â€”â€”â€”â€”â€”â€”â€”
async function fetchUnreadCount() {
  try {
    if (!window.seller?.id) return 0;
    const res = await fetch(`/api/chats?sellerId=${window.seller.id}`, {
      credentials: 'include'
    });
    if (!res.ok) return 0;
    const chats = await res.json();
    // Ù…Ø¬Ù…ÙˆØ¹ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø§Ø¯Ù…ÛŒÙ† Ú©Ù‡ Ù‡Ù†ÙˆØ² readBySeller=false Ù‡Ø³ØªÙ†Ø¯
    return chats.reduce((sum, chat) => {
      const unread = (chat.messages||[])
        .filter(m => m.from === 'admin' && !m.readBySeller)
        .length;
      return sum + unread;
    }, 0);
  } catch (err) {
    console.error('Error fetching unread count:', err);
    return 0;
  }
}

// â€”â€”â€”â€”â€”â€”â€”â€”â€” ØªØ§Ø¨Ø¹ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒ Ø¨Ø¬ â€”â€”â€”â€”â€”â€”â€”â€”â€”
function updateBadge(count) {
  const badge = document.getElementById('msgBadge');
  if (!badge) return;
  if (count > 0) {
    badge.innerText = count > 99 ? '99+' : count;
    badge.style.display = 'flex';
    badge.animate([
      { transform: 'scale(1)', opacity: 1 },
      { transform: 'scale(1.18)', opacity: .85 },
      { transform: 'scale(1)', opacity: 1 }
    ], { duration: 280 });
  } else {
    badge.style.display = 'none';
  }
}

// â€”â€”â€”â€”â€”â€”â€”â€”â€” Ø´Ø±ÙˆØ¹ Ù¾ÙˆÙ„ÛŒÙ†Ú¯ Ø¨Ø¬ â€”â€”â€”â€”â€”â€”â€”â€”â€”
function startBadgePolling() {
  if (window.badgeInterval) clearInterval(window.badgeInterval);
  // Ø¨Ø§Ø± Ø§ÙˆÙ„ ÙÙˆØ±ÛŒ
  fetchUnreadCount().then(updateBadge);
  // Ø³Ù¾Ø³ Ù‡Ø± Û±Ûµ Ø«Ø§Ù†ÛŒÙ‡
  window.badgeInterval = setInterval(() => {
    fetchUnreadCount().then(updateBadge);
  }, 15000);
}

// â€”â€”â€”â€”â€”â€”â€”â€”â€” Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù‡Ù…Ù‡ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ Ø¨Ù‡â€ŒØ¹Ù†ÙˆØ§Ù† Ø®ÙˆØ§Ù†Ø¯Ù‡â€ŒØ´Ø¯Ù‡ â€”â€”â€”â€”â€”â€”â€”â€”â€”
 // â€”â€”â€”â€”â€”â€”â€”â€”â€” Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù‡Ù…Ù‡â€ŒÛŒ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù‡â€ŒÙ†Ø´Ø¯Ù‡ Ø¨Ù‡â€ŒØ¹Ù†ÙˆØ§Ù† Ø®ÙˆØ§Ù†Ø¯Ù‡â€ŒØ´Ø¯Ù‡ â€”â€”â€”â€”â€”â€”â€”â€”â€”
// Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† ØªØ§Ø¨Ø¹ Ù‚Ø¨Ù„ÛŒ markAllRead
async function markAllRead() {
  try {
    if (!window.seller?.id) return;

    const res = await fetch('/api/chats/markAllRead', {
      method: 'POST',
      credentials: 'include',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ sellerId: window.seller.id })
    });

    if (!res.ok) {
      const err = await res.json();
      throw new Error(err.error || 'Failed to mark all read');
    }

    // Ù¾Ø³ Ø§Ø² Ù…ÙˆÙÙ‚ÛŒØªØŒ Ù†Ø´Ø§Ù†Ú¯Ø± (badge) ØµÙØ± Ù…ÛŒâ€ŒØ´ÙˆØ¯
    updateBadge(0);

  } catch (err) {
    console.error('Error marking all as read:', err);
  }
}


// â€”â€”â€”â€”â€”â€”â€”â€”â€” Ù‡Ù†Ø¯Ù„ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù…Ù†ÙˆÛŒ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ â€”â€”â€”â€”â€”â€”â€”â€”â€”
(function setupMessagesHandler() {
  const btn = document.getElementById('menu-msg');
  if (!btn || btn.dataset.listener === '1') return;
  btn.dataset.listener = '1';

  btn.addEventListener('click', async () => {
    // Ù‡Ø§ÛŒÙ„Ø§ÛŒØª Ù…Ù†Ùˆ
    document.querySelectorAll('.sidebar-link').forEach(el => el.classList.remove('active'));
    btn.classList.add('active');

    // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¨Ø®Ø´ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ (ØªØ§Ø¨Ø¹ Ø´Ù…Ø§)
    if (typeof loadDashboardMessages === 'function') {
      await loadDashboardMessages();
    }

    // Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù‡Ù…Ù‡ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ Ø®ÙˆØ§Ù†Ø¯Ù‡ Ø´Ø¯Ù‡
    await markAllRead();

    // Ø¨Ø³ØªÙ† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„
    if (window.innerWidth <= 768) {
      toggleSidebar();
    }
  });
})();



function getUnreadTotal(chats){
return chats.reduce((sum , chat)=>
  sum + (chat.messages||[])
          .filter(m => m.from !== 'seller' && !m.readBySeller)
          .length
,0);
}

// Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ ØªØ¹Ø¯Ø§Ø¯ Ø¢Ø®Ø±ÛŒÙ† Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§
let lastMsgCount = 0;

// ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ ØªØ¹Ø¯Ø§Ø¯ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù‡â€ŒÙ†Ø´Ø¯Ù‡ Ø¬Ø¯ÛŒØ¯ (Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù‡Ù…Ø§Ù† fetchUnreadCount Ø±Ø§ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯)
async function fetchNewMsgCount(){
  try{
    if(!window.seller?.id) return 0;
    const res = await fetch(`/api/chats?sellerId=${window.seller.id}`,
                            { credentials:'include' });
    if(!res.ok) return 0;
    const chats = await res.json();
    return getUnreadTotal(chats);    // â† Ù‡Ù…Ø§Ù† Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒÛŒ Ø¹Ù…ÙˆÙ…ÛŒ
  }catch{
    return 0;
  }
}

// Ù†Ù…Ø§ÛŒØ´ Ù¾Ø§Ù¾â€ŒØ§Ù¾ Ù¾ÛŒØ§Ù… Ø¬Ø¯ÛŒØ¯
function showMessagePopup(count) {
  const popup = document.getElementById('messagePopup');
  const span = document.getElementById('newMsgCount');
  span.innerText = count > 99 ? '99+' : count;
  popup.classList.add('show');
  setTimeout(() => popup.classList.remove('show'), 4000);
}

// Ø´Ø±ÙˆØ¹ Ù¾ÙˆÙ„ÛŒÙ†Ú¯ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§Ù Ù¾ÛŒØ§Ù… Ø¬Ø¯ÛŒØ¯
function startMessagePolling() {
  // Ø¨Ø§Ø± Ø§ÙˆÙ„ Ù…Ù‚Ø¯Ø§Ø± Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ú¯ÛŒØ±ÛŒÙ…
  fetchNewMsgCount().then(c => lastMsgCount = c);
  // Ù‡Ø± Û²Û° Ø«Ø§Ù†ÛŒÙ‡ Ú†Ú© Ú©Ù†
  setInterval(async () => {
    const c = await fetchNewMsgCount();
    if (c > lastMsgCount) {
      showMessagePopup(c - lastMsgCount);
    }
    lastMsgCount = c;
    updateBadge(c);          // Ù‡Ù… Ø¨Ø¬ Ø±Ø§ Ø¢Ù¾Ø¯ÛŒØª Ú©Ù†
  }, 20000);
}


// â€”â€”â€”â€”â€”â€”â€”â€”â€” Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ â€”â€”â€”â€”â€”â€”â€”â€”â€”
document.addEventListener('DOMContentLoaded', async () => {
  // Û±) Ø¯Ø±ÛŒØ§ÙØª ÙØ±ÙˆØ´Ù†Ø¯Ù‡
  window.seller = await fetchCurrentSeller();
  console.log('ğŸš€ seller object:', window.seller);

  if (window.seller?.id) {
    // Û²) Ø´Ø±ÙˆØ¹ Ù¾ÙˆÙ„ÛŒÙ†Ú¯â€ŒÙ‡Ø§
    startBadgePolling();
    startMessagePolling();

    // Û³) Ù†Ù…Ø§ÛŒØ´ Ù†Ø§Ù… Ùˆ Ù†Ø§Ù…â€ŒØ®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ ÙØ±ÙˆØ´Ù†Ø¯Ù‡
    const welcomeEl = document.getElementById('seller-welcome');
    if (welcomeEl) {
      const first = window.seller.firstname || '';
      const last  = window.seller.lastname  || '';
      // Ø§Ú¯Ø± Ù‡Ø± Ø¯Ùˆ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ø´Ø¯ "firstname lastname"
      const fullName = `${first}${last ? ' ' + last : ''}`;
      welcomeEl.textContent = `${fullName} Ø¹Ø²ÛŒØ²`;
    }
  }
});
// â€”â€”â€”â€”â€”â€”â€”â€”â€” ØªÙˆÙ‚Ù Ù¾ÙˆÙ„ÛŒÙ†Ú¯ Ù‡Ù†Ú¯Ø§Ù… Ø®Ø±ÙˆØ¬ â€”â€”â€”â€”â€”â€”â€”â€”â€”
window.addEventListener('beforeunload', () => {
  if (window.badgeInterval) {
    clearInterval(window.badgeInterval);
  }
});




// Û³) Ø¨Ø§Ù‚ÛŒ Ú©Ø¯Ù‡Ø§ (Ù…Ø«Ù„ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ØŒ Ø§Ø±Ø³Ø§Ù„ Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯) Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± Ø¨Ø§Ù‚ÛŒ Ù…ÛŒâ€ŒÙ…Ø§Ù†Ù†Ø¯


// Û³) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± Ø¯Ú©Ù…Ù‡â€ŒÛŒ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´:
document
  .getElementById('btn-shop-preview')
  .addEventListener('click', () => {
    if (!window.seller?.shopurl) {
      return alert('Ø¢Ø¯Ø±Ø³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø´Ù…Ø§ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡.');
    }
    const url = new URL('/shop.html', window.location.origin);
    url.searchParams.set('shopurl', window.seller.shopurl);
    window.open(url.href, '_blank');
  });

// Û´) Ø§Ø±Ø³Ø§Ù„ Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯:
document.getElementById('addProductForm').addEventListener('submit', async e => {
  e.preventDefault();
  if (!window.seller?.id) return alert('Ø§Ø¨ØªØ¯Ø§ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯.');
  // ... Ø³Ø§Ø®Øª body Ùˆ fetch Ù…Ø´Ø§Ø¨Ù‡ Ù‚Ø¨Ù„ØŒ Ø§Ù…Ø§ Ø¨Ù‡ Ø¬Ø§ÛŒ localStorageØŒ Ø§Ø² window.seller.id Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
});










function showProductSuccessPopup() {
  console.log("âœ… ØªØ§Ø¨Ø¹ showProductSuccessPopup ØµØ¯Ø§ Ø²Ø¯Ù‡ Ø´Ø¯");
  const popup = document.getElementById('productSuccessPopup');
  if (!popup) return console.error("âŒ popup not found");
  popup.style.display = "flex";
  popup.style.opacity = "1";
  console.log("Opacity set to 1:", popup.style.opacity);
  setTimeout(() => {
    popup.style.opacity = "0";
    setTimeout(() => popup.style.display = "none", 300);
  }, 2000);
}
  

// ----------- Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ùˆ ØªÙ… Ø³Ø§ÛŒØª ----------
function toggleSidebar() {
  const sidebar = document.getElementById('sidebar');
  const overlay = document.getElementById('sidebarOverlay');
  const hamburger = document.querySelector('.sidebar-hamburger');
  const toggleBtn = document.querySelector('.sidebar-toggle');
  const isExpanded = sidebar.classList.toggle('expanded');
  overlay.classList.toggle('active', isExpanded);
  hamburger.setAttribute('aria-expanded', isExpanded);
  toggleBtn.setAttribute('aria-expanded', isExpanded);
  if (isExpanded) toggleBtn.focus();
  else hamburger.focus();
}
function toggleTheme() {
  document.documentElement.classList.toggle('dark');
  const icon = document.getElementById('theme-icon');
  if (document.documentElement.classList.contains('dark')) {
    icon.innerHTML = '<path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" fill="#0ea5e9"/>';
  } else {
    icon.innerHTML = '<circle cx="12" cy="12" r="5" stroke="#10b981" stroke-width="2" fill="none"/><path d="M12 3v2m0 14v2m9-9h-2M5 12H3m15.5 6.5l-1.5-1.5M6.5 6.5l-1.5-1.5m12 0l-1.5 1.5M6.5 17.5l-1.5 1.5" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/>';
  }
}

// ----------- Ø¨Ø®Ø´ Ø³ÙˆÛŒÛŒÚ† Ø¨ÛŒÙ† Ø¨Ø®Ø´â€ŒÙ‡Ø§ Ùˆ Ú†Ø§Ø±Øª Ø¨Ø§Ø²Ø¯ÛŒØ¯ ----------
function showSection(section) {
  // Ø§Ú¯Ø± Ø¨Ø®Ø´ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ "content" (ÛŒØ¹Ù†ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø¸Ø§Ù‡Ø± ÙØ±ÙˆØ´Ú¯Ø§Ù‡) Ù†ÛŒØ³ØªØŒ
  // Ù…Ø­ØªÙˆØ§ÛŒ main-content Ø±Ùˆ Ù¾Ø§Ú© Ú©Ù† Ú©Ù‡ Ú†ÛŒØ²ÛŒ Ø²ÛŒØ± Ø¨Ø®Ø´ Ø¬Ø¯ÛŒØ¯ Ù†Ù…ÙˆÙ†Ù‡
  if (section !== "content" && document.getElementById('main-content')) {
    document.getElementById('main-content').innerHTML = '';
  }
  const perf = document.getElementById('performance-container');
  if (perf) perf.style.display = 'none';

  const allSections = [
    "visit", "notif", "msg", "profile", "settings", "add", "upgrade",
    "products", "content", "seo", "guide", "register-visit", "performance"
  ];
  allSections.forEach(s => {
    const btn = document.getElementById('menu-' + s);
    if (btn) btn.classList.remove('active');
    const sec = document.getElementById('section-' + s);
    if (sec) sec.style.display = 'none';
  });
  const btnActive = document.getElementById('menu-' + section);
  if (btnActive) btnActive.classList.add('active');
  const secActive = document.getElementById('section-' + section);
  if (secActive) secActive.style.display = 'block';

  if (section === 'visit' && document.getElementById('visitChart')) {
    setTimeout(() => renderChart(currentChart), 80);
  }
  if (section === 'register-visit') {
    loadDailyVisits();
  }
  if (section === 'performance') {
    loadPerformanceStatus();
  }
  if (window.innerWidth <= 768) toggleSidebar();
  if (section === "products") setupProductSection();
}

function switchChart(type) {
  if (currentChart === type) return;
  currentChart = type;
  renderChart(type);
  document.getElementById('tab-week').classList.toggle('active', type === 'week');
  document.getElementById('tab-month').classList.toggle('active', type === 'month');
  document.getElementById('chartTitle').innerText = type === 'week' ? 'Ù†Ù…ÙˆØ¯Ø§Ø± Ø¨Ø§Ø²Ø¯ÛŒØ¯ Ù‡ÙØªÚ¯ÛŒ' : 'Ù†Ù…ÙˆØ¯Ø§Ø± Ø¨Ø§Ø²Ø¯ÛŒØ¯ Ù…Ø§Ù‡Ø§Ù†Ù‡';
}


// ----------- Ú†Ø§Ø±Øª Ø¨Ø§Ø²Ø¯ÛŒØ¯ (Ù†Ù…ÙˆÙ†Ù‡) ----------
let chartData = {
  week: { labels: ['Ø´Ù†Ø¨Ù‡','ÛŒÚ©Ø´Ù†Ø¨Ù‡','Ø¯ÙˆØ´Ù†Ø¨Ù‡','Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡','Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡','Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡','Ø¬Ù…Ø¹Ù‡'], data: [112,131,123,148,156,166,140] },
  month: { labels: ['ÙØ±ÙˆØ±Ø¯ÛŒÙ†','Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª','Ø®Ø±Ø¯Ø§Ø¯','ØªÛŒØ±','Ù…Ø±Ø¯Ø§Ø¯','Ø´Ù‡Ø±ÛŒÙˆØ±','Ù…Ù‡Ø±','Ø¢Ø¨Ø§Ù†','Ø¢Ø°Ø±','Ø¯ÛŒ','Ø¨Ù‡Ù…Ù†','Ø§Ø³ÙÙ†Ø¯'], data: [880,970,1050,1254,1411,1393,1522,1610,1733,1652,1567,1295] }
};
let currentChart = 'week', visitChart;
function renderChart(type = 'week') {
  const ctx = document.getElementById('visitChart').getContext('2d');
  if (visitChart) visitChart.destroy();
  visitChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: chartData[type].labels,
      datasets: [{
        label: 'Ø¨Ø§Ø²Ø¯ÛŒØ¯Ù‡Ø§', data: chartData[type].data, fill: true, tension: 0.38,
        borderColor: '#10b981', backgroundColor: 'rgba(16,185,129,0.09)', pointBackgroundColor: '#10b981', pointRadius: 5, pointHoverRadius: 7,
      }]
    },
    options: { responsive: true, plugins: { legend: { display: false } },
      scales: {
        y: { beginAtZero: true, grid: { color: '#e5e7eb44', borderDash: [4,4] }, ticks: { color: '#888', font: { size: 13, weight: 'bold' } } },
        x: { grid: { display: false }, ticks: { color: '#666', font: { size: 13, weight: 'bold' } } }
      }
    }
  });
}

// ----------- Ù¾Ø§Ù¾â€ŒØ¢Ù¾ Ù…ÙˆÙÙ‚ÛŒØª ----------
  

// ----------- Ø¢Ù¾Ù„ÙˆØ¯ Ùˆ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¹Ú©Ø³ Ù…Ø­ØµÙˆÙ„ (Ú†Ù†Ø¯Ú¯Ø§Ù†Ù‡) ----------
window._productFiles = [];
const imgInput = document.getElementById("productImagesInput");
const previewBox = document.getElementById("imagePreview");
const imgErrorMsg = document.getElementById("imgErrorMsg");

imgInput.addEventListener("change", function (event) {
  const files = Array.from(event.target.files);
  window._productFiles = files;
  previewBox.innerHTML = "";
  imgErrorMsg.classList.add("hidden");
  if (files.length === 0) return;
  files.forEach((file, idx) => {
    const reader = new FileReader();
    reader.onload = e => {
      const div = document.createElement("div");
      div.className = "relative";
      div.innerHTML = `
        <img src="${e.target.result}" class="w-20 h-20 object-cover rounded-xl border shadow" alt="Ø¹Ú©Ø³ Ù…Ø­ØµÙˆÙ„"/>
        <button type="button" class="absolute top-1 right-1 bg-white rounded-full shadow p-1 text-gray-500 hover:bg-red-100 hover:text-red-500" title="Ø­Ø°Ù Ø¹Ú©Ø³" onclick="removeImage(${idx})">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M6 18L18 6M6 6l12 12" stroke="#ef4444" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
      `;
      previewBox.appendChild(div);
    };
    reader.readAsDataURL(file);
  });
});
function removeImage(index) {
  let files = Array.from(window._productFiles || []);
  files.splice(index, 1);
  window._productFiles = files;
  // Ø¢Ù¾Ø¯ÛŒØª ÙˆØ±ÙˆØ¯ÛŒ ÙØ§ÛŒÙ„ Ø¨Ø§ DataTransfer
  const input = document.getElementById("productImagesInput");
  const dataTransfer = new DataTransfer();
  files.forEach(f => dataTransfer.items.add(f));
  input.files = dataTransfer.files;
  // Ø¨Ø§Ø²Ù†Ù…Ø§ÛŒÛŒ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´
  previewBox.innerHTML = "";
  files.forEach((file, idx) => {
    const reader = new FileReader();
    reader.onload = e => {
      const div = document.createElement("div");
      div.className = "relative";
      div.innerHTML = `
        <img src="${e.target.result}" class="w-20 h-20 object-cover rounded-xl border shadow" alt="Ø¹Ú©Ø³ Ù…Ø­ØµÙˆÙ„"/>
        <button type="button" class="absolute top-1 right-1 bg-white rounded-full shadow p-1 text-gray-500 hover:bg-red-100 hover:text-red-500" title="Ø­Ø°Ù Ø¹Ú©Ø³" onclick="removeImage(${idx})">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M6 18L18 6M6 6l12 12" stroke="#ef4444" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
      `;
      previewBox.appendChild(div);
    };
    reader.readAsDataURL(file);
  });
  if (files.length < 3) imgErrorMsg.classList.remove("hidden");
  else imgErrorMsg.classList.add("hidden");
}

// ----------- Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯ (Ù…ØªØµÙ„ Ø¨Ù‡ Ø¯ÛŒØªØ§Ø¨ÛŒØ³) ----------
document.getElementById("addProductForm").addEventListener("submit", async function (e) {
  e.preventDefault();

  // Ú†Ú© Ú©Ø±Ø¯Ù† seller Ùˆ id Ø§Ø² window.seller Ø¨Ù‡ Ø¬Ø§ÛŒ localStorage
  if (!window.seller?.id) {
    alert("Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ±ÙˆØ´Ù†Ø¯Ù‡ Ù†Ø§Ù‚Øµ Ø§Ø³Øª. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯.");
    window.location.href = "login.html";
    return;
  }

  const form = e.target;
  const files = Array.from(imgInput.files);
  if (files.length < 3) {
    imgErrorMsg.classList.remove("hidden");
    imgErrorMsg.innerText = "Ø­Ø¯Ø§Ù‚Ù„ Û³ Ø¹Ú©Ø³ Ø§Ù„Ø²Ø§Ù…ÛŒ Ø§Ø³Øª.";
    imgInput.focus();
    return;
  }

  // Ø®ÙˆØ§Ù†Ø¯Ù† Ù‡Ù…Ù‡ Ø¹Ú©Ø³â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª base64
  let imagesBase64 = [];
  for (const file of files) {
    const base64 = await readFileAsBase64(file);
    imagesBase64.push(base64);
  }

  // Ø¯Ø±Ø³Øª Ú©Ø±Ø¯Ù† Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§ (tags)
  let tags = [];
  if (form.tags) {
    tags = form.tags.value.split(',').map(t => t.trim()).filter(Boolean);
  } else if (form.tag) {
    tags = [form.tag.value.trim()];
  }

  const productData = {
    sellerId: window.seller.id,  // Ø§ÛŒÙ†Ø¬Ø§ Ù‡Ù… Ø§Ø² window.seller Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
    title: form.title.value.trim(),
    price: Number(form.price.value),
    category: form.category.value.trim(),
    tags: tags,
    desc: form.desc.value.trim(),
    images: imagesBase64
  };

  try {
    const res = await fetch("/api/products", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(productData),
      credentials: "include"  // Ø§Ú¯Ø± Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø§Ø±Ø³Ø§Ù„ Ú©ÙˆÚ©ÛŒ/ØªÙˆÚ©Ù† Ø¯Ø§Ø±ÛŒØ¯
    });
    const result = await res.json();
    if (res.ok) {
      form.reset();
      window._productFiles = [];
      previewBox.innerHTML = "";
      imgErrorMsg.classList.add("hidden");
      showProductSuccessPopup(); // Ù¾Ø§Ù¾â€ŒØ¢Ù¾ Ø´ÛŒÚ© Ùˆ Ø¬Ø¯ÛŒØ¯ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒØ´Ù‡
      if (typeof renderProducts === "function") renderProducts();
    } else {
      alert(result.message || "Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª Ù…Ø­ØµÙˆÙ„!");
    }
  } catch (err) {
    alert("Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±.");
    console.error(err);
  }
});





function readFileAsBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = e => resolve(e.target.result);
    reader.onerror = reject;
    reader.readAsDataURL(file);
  });
}

// ----------- Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„Ø§Øª (Ø¯Ø±ÛŒØ§ÙØª Ø§Ø² Ø³Ø±ÙˆØ±) ----------
async function renderProducts() {
  // seller Ø±Ùˆ Ø§ÛŒÙ†Ø¬Ø§ Ø§Ø² localStorage Ø¨Ø®ÙˆÙ† ØªØ§ Ù‡Ù…ÛŒØ´Ù‡ Ù…Ù‚Ø¯Ø§Ø± Ø¯Ø±Ø³Øª Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒ
// Ø§Ú¯Ø± seller Ø¯Ø± Ø­Ø§ÙØ¸Ù‡ Ù„ÙˆØ¯ Ù†Ø´Ø¯Ù‡ ÛŒØ§ id Ù†Ø¯Ø§Ø±Ø¯ØŒ Ø±ÛŒØ¯Ø§ÛŒØ±Ú©Øª Ø¨Ù‡ Ù„Ø§Ú¯ÛŒÙ†
if (!window.seller?.id) {
  alert("Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ±ÙˆØ´Ù†Ø¯Ù‡ Ù†Ø§Ù‚Øµ Ø§Ø³Øª. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯.");
  window.location.href = "login.html";
  return;
}


  // Ø§Ù„Ù…Ù†Øªâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÙˆÙ„ Ùˆ Ú©Ø§Ø±Øª Ù…ÙˆØ¨Ø§ÛŒÙ„
  const tbody = document.getElementById('productsTableBody');
  const mobileList = document.getElementById('productsMobileList');
  const noProductMsg = document.getElementById('noProductMsg');
  if (tbody) tbody.innerHTML = "";
  if (mobileList) mobileList.innerHTML = "";

  try {
    // Ø¯Ø±ÛŒØ§ÙØª Ù…Ø­ØµÙˆÙ„Ø§Øª ÙØ±ÙˆØ´Ù†Ø¯Ù‡
  const res = await fetch(`/api/products?sellerId=${window.seller.id}`, { credentials: 'include' });
    if (!res.ok) throw new Error("Ù…Ø´Ú©Ù„ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù…Ø­ØµÙˆÙ„Ø§Øª");
    const products = await res.json();

    // Ø§Ú¯Ø± Ù‡ÛŒÚ† Ù…Ø­ØµÙˆÙ„ÛŒ Ù†ÛŒØ³Øª
    if (!products.length) {
      noProductMsg.classList.remove('hidden');
      return;
    }
    noProductMsg.classList.add('hidden');
    window._allProducts = products;

    // ---- Ø±Ù†Ø¯Ø± Ø¬Ø¯ÙˆÙ„ (Ø¯Ø³Ú©ØªØ§Ù¾) ----
    products.forEach((prod) => {
      // ØªØ¹ÛŒÛŒÙ† Ø¹Ú©Ø³ Ø´Ø§Ø®Øµ Ø¨Ø± Ø§Ø³Ø§Ø³ mainImageIndex ÛŒØ§ Ø§ÙˆÙ„ÛŒÙ† Ø¹Ú©Ø³
      let cover = "";
      if (prod.images && prod.images.length) {
        if (typeof prod.mainImageIndex === "number" && prod.images[prod.mainImageIndex]) {
          cover = prod.images[prod.mainImageIndex];
        } else {
          cover = prod.images[0];
        }
      }
      if (tbody) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><img src="${cover}" alt="" class="w-12 h-12 object-cover rounded-lg border shadow mx-auto"/></td>
          <td>${prod.title}</td>
          <td>${prod.price ? prod.price.toLocaleString('fa-IR') : "-"}</td>
          <td>${prod.category || '-'}</td>
          <td>${prod.tags && prod.tags.length ? prod.tags.join('ØŒ ') : '-'}</td>
          <td>
            <button class="bg-[#10b981] hover:bg-[#0ea5e9] text-white rounded-lg px-3 py-1 text-[14px] transition" onclick="showEditModal('${prod._id}')">ÙˆÛŒØ±Ø§ÛŒØ´</button>
          </td>
          <td>
            <button class="bg-red-500 hover:bg-red-600 text-white rounded-lg px-3 py-1 text-[14px] transition" onclick="deleteProduct('${prod._id}')">Ø­Ø°Ù</button>
          </td>
        `;
        tbody.appendChild(tr);
      }

      // ---- Ø±Ù†Ø¯Ø± Ú©Ø§Ø±Øª Ù…ÙˆØ¨Ø§ÛŒÙ„ (ÙÙ‚Ø· Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± md Ùˆ Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ±) ----
      if (mobileList) {
        const card = document.createElement('div');
        card.className = "flex items-center gap-3 bg-white rounded-xl shadow p-3 border border-gray-100";
        card.innerHTML = `
          <img src="${cover}" alt="" class="w-14 h-14 object-cover rounded-lg border" />
          <div class="flex-1 flex flex-col gap-1">
            <div class="font-bold text-[#10b981] text-[15px]">${prod.title}</div>
            <div class="text-gray-600 text-xs">Ø¯Ø³ØªÙ‡: <span class="font-bold">${prod.category || '-'}</span></div>
            <div class="text-[#0ea5e9] text-sm font-bold">Ù‚ÛŒÙ…Øª: ${prod.price ? prod.price.toLocaleString('fa-IR') : '-'}</div>
            <div class="text-xs text-gray-400 mt-1">Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§: <span class="font-bold">${prod.tags && prod.tags.length ? prod.tags.join('ØŒ ') : '-'}</span></div>
          </div>
          <div class="flex flex-col gap-2">
            <button class="bg-[#10b981] hover:bg-[#0ea5e9] text-white rounded-lg px-2 py-1 text-xs font-bold transition" onclick="showEditModal('${prod._id}')">ÙˆÛŒØ±Ø§ÛŒØ´</button>
            <button class="bg-red-500 hover:bg-red-600 text-white rounded-lg px-2 py-1 text-xs font-bold transition" onclick="deleteProduct('${prod._id}')">Ø­Ø°Ù</button>
          </div>
        `;
        mobileList.appendChild(card);
      }
    });
  } catch (err) {
    if (tbody) tbody.innerHTML = `<tr><td colspan="7" class="text-center text-red-500 py-6">Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù…Ø­ØµÙˆÙ„Ø§Øª!</td></tr>`;
    if (mobileList) mobileList.innerHTML = `<div class="text-center text-red-500 py-6">Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù…Ø­ØµÙˆÙ„Ø§Øª!</div>`;
    noProductMsg.classList.add('hidden');
  }
}


// ----------- Ø­Ø°Ù Ù…Ø­ØµÙˆÙ„ (Ø¯ÛŒØªØ§Ø¨ÛŒØ³) ----------
async function deleteProduct(productId) {
  if (!confirm("Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ù…Ø­ØµÙˆÙ„ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ")) return;
  try {
    const res = await fetch(`http://localhost:5000/api/products/${productId}`, { method: "DELETE" });
    const result = await res.json();
    if (res.ok) {
      renderProducts();
    } else {
      alert(result.message || "Ø®Ø·Ø§ Ø¯Ø± Ø­Ø°Ù Ù…Ø­ØµÙˆÙ„!");
    }
  } catch (err) {
    alert("Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±!");
  }
}

// ----------- Ù…Ø¯Ø§Ù„ Ùˆ ÙØ±Ù… ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„ (Ø¯ÛŒØªØ§Ø¨ÛŒØ³) ----------
  // ----------- Ù…Ø¯Ø§Ù„ Ùˆ ÙØ±Ù… ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„ (Ø¯ÛŒØªØ§Ø¨ÛŒØ³) Ø¨Ø§ Ù…Ø¯ÛŒØ±ÛŒØª ØªØ§ Û³ Ø¹Ú©Ø³ ----------

  function showEditModal(productId) {
    const products = window._allProducts || [];
    const prod = products.find(p => p._id === productId);
    if (!prod) return alert("Ù…Ø­ØµÙˆÙ„ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯!");

    const modal = document.getElementById("editProductModal");
    modal.style.display = "flex";
    const form = document.getElementById("editProductForm");

    // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ input Ù…Ø®ÙÛŒ productId
    form.productId.value = prod._id || "";
    form.title.value = prod.title || "";
    form.price.value = prod.price || "";
    form.category.value = prod.category || "";
    form.desc.value = prod.desc || "";

    // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ ØªÚ¯ (ÙÙ‚Ø· ÛŒÚ©ÛŒ)
    const tagValue = (prod.tags && prod.tags.length) ? prod.tags[0] : "";
    const radios = form.querySelectorAll('input[name="tag"]');
    radios.forEach(radio => {
      radio.checked = (radio.value === tagValue);
    });

    // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø¹Ú©Ø³â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ
    window._editOldImages = Array.isArray(prod.images) ? [...prod.images] : [];
    // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÛŒÙ†Ø¯Ú©Ø³ Ø¹Ú©Ø³ Ø´Ø§Ø®Øµ (Ø§Ú¯Ø± Ø¯Ø± Ù…Ø­ØµÙˆÙ„ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªØŒ Ù…Ù‚Ø¯Ø§Ø±Ø´ Ø±Ùˆ Ø³Øª Ú©Ù†ØŒ ÙˆÚ¯Ø±Ù†Ù‡ Û°)
    window._editMainIndex =
      typeof prod.mainImageIndex === "number" &&
      prod.mainImageIndex < (prod.images || []).length
        ? prod.mainImageIndex
        : 0;
    // Ø¹Ú©Ø³â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ÛŒ Ú©Ù‡ Ù…ÙˆÙ‚Ø¹ ÙˆÛŒØ±Ø§ÛŒØ´ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
    window._editNewImages = [];
    renderEditImagePreview();

    // Ø±ÛŒØ³Øª input ÙØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ Ø§Ø¶Ø§ÙÙ‡â€ŒÚ©Ø±Ø¯Ù† Ø¹Ú©Ø³ Ø¬Ø¯ÛŒØ¯
    const input = document.getElementById("editProductImagesInput");
    if (input) input.value = "";
  }


  // Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¹Ú©Ø³â€ŒÙ‡Ø§ÛŒ ÙˆÛŒØ±Ø§ÛŒØ´ (Ù‚Ø¨Ù„ÛŒ + Ø¬Ø¯ÛŒØ¯)
  // ÙØ±Ø¶ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… Ù…ØªØºÛŒØ± window._editMainIndex Ø´Ù…Ø§Ø±Ù‡ Ø¹Ú©Ø³ Ø´Ø§Ø®ØµÙ‡ (Ø§ÛŒÙ†Ø¯Ú©Ø³ Ø¯Ø± Ù…Ø¬Ù…ÙˆØ¹ Ø¹Ú©Ø³â€ŒÙ‡Ø§ÛŒ ÙØ¹Ù„ÛŒ)
  function renderEditImagePreview() {
    const preview = document.getElementById("editImagePreview");
    preview.innerHTML = "";
    const images = [...window._editOldImages, ...window._editNewImages];
    // Ø§Ú¯Ù‡ Ø´Ø§Ø®Øµ Ø§Ø² Ù…Ø­Ø¯ÙˆØ¯Ù‡ Ø®Ø§Ø±Ø¬ Ø´Ø¯Ù‡ Ø¨ÙˆØ¯ØŒ ØµÙØ± Ú©Ù†
    if (typeof window._editMainIndex !== "number" || window._editMainIndex >= images.length) {
      window._editMainIndex = 0;
    }
    images.forEach((img, idx) => {
      const isMain = idx === window._editMainIndex;
      const div = document.createElement("div");
      div.className = "relative group inline-block m-1";
      div.innerHTML = `
        <img src="${img}" class="w-16 h-16 object-cover rounded-xl border shadow ring-2 ${isMain ? 'ring-[#10b981]' : 'ring-transparent'} cursor-pointer"
          title="${isMain ? 'Ø¹Ú©Ø³ Ø´Ø§Ø®Øµ' : 'Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø¹Ú©Ø³ Ø´Ø§Ø®Øµ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯'}"
          onclick="setMainImageIndex(${idx})"
          style="transition:ring 0.15s;"
        />
        <button type="button" class="absolute top-1 right-1 bg-white rounded-full shadow p-1 text-gray-500 hover:bg-red-100 hover:text-red-500"
          title="Ø­Ø°Ù Ø¹Ú©Ø³" onclick="removeEditImage('${idx < window._editOldImages.length ? 'old' : 'new'}', ${idx < window._editOldImages.length ? idx : idx - window._editOldImages.length})">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M6 18L18 6M6 6l12 12" stroke="#ef4444" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
        ${isMain ? `<span class="absolute bottom-1 left-1 bg-[#10b981] text-white text-xs px-2 py-1 rounded-lg shadow">Ø´Ø§Ø®Øµ</span>` : ''}
      `;
      preview.appendChild(div);
    });
  }



  // Ø­Ø°Ù Ø¹Ú©Ø³ (Ù‚Ø¯ÛŒÙ…ÛŒ ÛŒØ§ Ø¬Ø¯ÛŒØ¯)
  function removeEditImage(type, idx) {
    if (type === "old") window._editOldImages.splice(idx, 1);
    if (type === "new") window._editNewImages.splice(idx, 1);
    renderEditImagePreview();
  }

  // ÙˆÙ‚ØªÛŒ Ø¹Ú©Ø³ Ø¬Ø¯ÛŒØ¯ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯ (input ÙØ§ÛŒÙ„ Ø¨Ø§ÛŒØ¯ onchange="previewEditImages(event)" Ø¨Ø§Ø´Ø¯)
  function previewEditImages(event) {
    const files = Array.from(event.target.files);
    if (!files.length) return;
    // Ø¨ÛŒØ´ØªØ± Ø§Ø² Û³ ØªØ§ Ù†Ø´Ù‡
    let remain = 3 - (window._editOldImages.length + window._editNewImages.length);
    if (remain <= 0) return; // Ø¸Ø±ÙÛŒØª Ù¾Ø±
    for (let i = 0; i < Math.min(remain, files.length); i++) {
      const file = files[i];
      const reader = new FileReader();
      reader.onload = e => {
        window._editNewImages.push(e.target.result);
        renderEditImagePreview();
      };
      reader.readAsDataURL(file);
    }
    // Ø±ÛŒØ³Øª input Ø¨Ø±Ø§ÛŒ Ø¢Ù¾Ù„ÙˆØ¯ Ø¯ÙˆØ¨Ø§Ø±Ù‡
    event.target.value = "";
  }

  // Ø¨Ø³ØªÙ† Ù…Ø¯Ø§Ù„ ÙˆÛŒØ±Ø§ÛŒØ´
  function closeEditModal() {
    document.getElementById("editProductModal").style.display = "none";
  }

  // Ø§Ø±Ø³Ø§Ù„ ÙØ±Ù… ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„
  document.getElementById("editProductForm").addEventListener("submit", async function(e) {
    e.preventDefault();
    const productId = this.productId.value;

    // Ù…Ù‚Ø¯Ø§Ø± Ø¨Ø±Ú†Ø³Ø¨ (ØªÚ¯) ÙÙ‚Ø· Ø§Ø² Ø±Ø§Ø¯ÛŒÙˆ
    let tagValue = "";
    const tagRadio = this.querySelector('input[name="tag"]:checked');
    if (tagRadio) tagValue = tagRadio.value.trim();

    // ØªØ±Ú©ÛŒØ¨ Ø¹Ú©Ø³â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ùˆ Ø¬Ø¯ÛŒØ¯ØŒ Ø­Ø¯Ø§Ú©Ø«Ø± Û³ ØªØ§
    const allImages = [...(window._editOldImages || []), ...(window._editNewImages || [])].slice(0, 3);

    // Ø§ÙØ²ÙˆØ¯Ù† mainImageIndex Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø¹Ú©Ø³ Ø´Ø§Ø®Øµ
    let updatedFields = {
      title: this.title.value.trim(),
      price: +this.price.value,
      category: this.category.value.trim(),
      tags: tagValue ? [tagValue] : [],
      desc: this.desc.value.trim(),
      images: allImages,
      mainImageIndex: typeof window._editMainIndex === "number" ? window._editMainIndex : 0,
    };

    try {
      const res = await fetch(`http://localhost:5000/api/products/${productId}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(updatedFields)
      });
      const result = await res.json();
      if (res.ok) {
        closeEditModal();
        renderProducts();
      } else {
        alert(result.message || "Ø®Ø·Ø§ Ø¯Ø± ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„!");
      }
    } catch (err) {
      alert("Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±!");
    }
  });



  // ----------- Ù‡Ø± Ø¨Ø§Ø± ÙˆØ§Ø±Ø¯ Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø­ØµÙˆÙ„Ø§Øª Ø´Ø¯ ----------
  function setupProductSection() {
    renderProducts();
  }







function setMainImageIndex(idx) {
  window._editMainIndex = idx;
  renderEditImagePreview();
}



  // --- Ù„ÙˆØ¯ Ú©Ø±Ø¯Ù† Ù…Ø­ØªÙˆØ§ÛŒ dashboard-content.html Ùˆ Ø§Ø¬Ø±Ø§ÛŒ Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ Ø¢Ù† ---
  // Ù„ÙˆØ¯ Ú©Ø±Ø¯Ù† Ù…Ø­ØªÙˆØ§ÛŒ dashboard-content.html Ùˆ Ø§Ø¬Ø±Ø§ÛŒ Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§
  async function loadDashboardContent() {
    const mainContent = document.getElementById("main-content");
    mainContent.innerHTML = '<div class="text-gray-400 text-center py-8">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ...</div>';
    try {
      const res = await fetch("dashboard-content.html");
      if (!res.ok) throw new Error("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù…Ø­ØªÙˆØ§");
      const html = await res.text();

      // 1. Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ Ø±Ùˆ Ø¬Ø¯Ø§ Ú©Ù†
      const tempDiv = document.createElement("div");
      tempDiv.innerHTML = html;
      const scripts = tempDiv.querySelectorAll("script");
      scripts.forEach(script => script.remove());

      // 2. ÙÙ‚Ø· HTML Ø¨Ø¯ÙˆÙ† Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø±Ùˆ Ø¨Ø±ÛŒØ²
      mainContent.innerHTML = tempDiv.innerHTML;

      // 3. Ù‡Ø± Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù† (ØªØ§ Ø§Ø¬Ø±Ø§ Ø¨Ø´Ù‡)
      scripts.forEach(script => {
        const newScript = document.createElement("script");
        if (script.src) {
          newScript.src = script.src;
        } else {
          newScript.textContent = script.textContent;
        }
        document.body.appendChild(newScript);
      });

      // 4. Ø¯Ø± ØµÙˆØ±Øª ÙˆØ¬ÙˆØ¯ ØªØ§Ø¨Ø¹ initContentDashboardØŒ Ø§Ø¬Ø±Ø§Ø´ Ú©Ù†
      setTimeout(() => {
        if (typeof initContentDashboard === "function") {
          initContentDashboard();
        }
      }, 0);

    } catch (err) {
      mainContent.innerHTML = `<div class="text-red-500 text-center py-8">Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø­ØªÙˆØ§ Ø¨Ø§ Ù…Ø´Ú©Ù„ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯!</div>`;
    }
  }

  // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ú©Ù„ÛŒÚ© Ù…Ù†ÙˆÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø¸Ø§Ù‡Ø± ÙØ±ÙˆØ´Ú¯Ø§Ù‡
  document.getElementById("menu-content").addEventListener("click", function() {
    loadDashboardContent();
  });





  /// --- Ù„ÙˆØ¯ Ú©Ø±Ø¯Ù† Ù…Ø­ØªÙˆØ§ÛŒ dashboard-logo.html Ùˆ Ø§Ø¬Ø±Ø§ÛŒ Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ Ù„Ø§Ø²Ù… ---
  async function loadDashboardLogo() {
    const mainContent = document.getElementById("main-content");
    mainContent.innerHTML = '<div class="text-gray-400 text-center py-8">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ...</div>';
    try {
      const res = await fetch("dashboard-logo.html");
      if (!res.ok) throw new Error("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù…Ø­ØªÙˆØ§");
      const html = await res.text();

      // ÙÙ‚Ø· HTML Ø±Ùˆ Ø¨Ø±ÛŒØ² (Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ Ø±Ùˆ Ø¬Ø¯Ø§ Ø¬Ø¯Ø§ Ù„ÙˆØ¯ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…)
      mainContent.innerHTML = html;

      // Ø¨Ø¹Ø¯Ø´ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù„ÙˆÚ¯Ùˆ Ø±Ùˆ Ù„ÙˆØ¯ Ú©Ù† (Ø§Ú¯Ù‡ Ù‚Ø¨Ù„Ø§Ù‹ Ù„ÙˆØ¯ Ù†Ø´Ø¯Ù‡)
      loadDashboardLogoScript(function() {
        // Ø¨Ø¹Ø¯ Ø§Ø² Ù„ÙˆØ¯ Ø´Ø¯Ù† Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ùˆ ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù† ÙØ§Ù†Ú©Ø´Ù†ØŒ Ø§Ø¬Ø±Ø§Ø´ Ú©Ù†
        if (typeof initLogoDashboard === "function") {
          initLogoDashboard();
        }
      });
    } catch (err) {
      mainContent.innerHTML = `<div class="text-red-500 text-center py-8">Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø­ØªÙˆØ§ Ø¨Ø§ Ù…Ø´Ú©Ù„ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯!</div>`;
    }
  }

  // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ú©Ù„ÛŒÚ© Ù…Ù†ÙˆÛŒ ØªØ§Ø¨Ù„Ùˆ ÙØ±ÙˆØ´Ú¯Ø§Ù‡
  document.getElementById("menu-notif").addEventListener("click", function() {
    loadDashboardLogo();
  });

  // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ù„ÙˆØ¯ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª ÙÙ‚Ø· ÛŒÚ© Ø¨Ø§Ø±
  function loadDashboardLogoScript(callback) {
    if (window._logoScriptLoaded) {
      if (typeof callback === "function") callback();
      return;
    }
    var script = document.createElement("script");
    script.src = "dashboard-logo.js";
    script.onload = function() {
      window._logoScriptLoaded = true;
      if (typeof callback === "function") callback();
    };
    document.body.appendChild(script);
  }






  // --- loader Ø¨Ø®Ø´ Ø§Ø±ØªÙ‚Ø§ (Ú©Ø§Ù…Ù„Ø§Ù‹ ØªØ¶Ù…ÛŒÙ†ÛŒ Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ ØµØ­ÛŒØ­ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª) ---
  /* -------------------------------------------------
   â¶ Ù„ÙˆØ¯Ù ØµÙØ­Ù‡ Ùˆ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø§Ø±ØªÙ‚Ø§
   ------------------------------------------------- */
  async function loadDashboardUpgrade () {
    const main = document.getElementById('main-content');
    main.innerHTML =
      '<div class="text-gray-400 text-center py-8">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ â€¦</div>';

    try {
      /* 1) Ø¯Ø±ÛŒØ§ÙØª Ùˆ ØªØ²Ø±ÛŒÙ‚ HTML */
      const res = await fetch('dashboard-upgrade.html');
      if (!res.ok) throw new Error('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù…Ø­ØªÙˆØ§');
      main.innerHTML = await res.text();

      /* 2) Ø§Ú¯Ø± Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù‚Ø¨Ù„Ø§Ù‹ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯ (Ø±ÛŒÙØ±Ø´Ù Ú¯Ø±Ù…)ØŒ Ø­Ø°ÙØ´ Ú©Ù† ØªØ§ Ú©Ø´ Ù†Ø´ÙˆØ¯ */
      const old = document.getElementById('upgrade-js-script');
      if (old) old.remove();

      /* 3) Ø§ÙØ²ÙˆØ¯Ù† Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ùˆ Ø§Ø¬Ø±Ø§ÛŒ ØªØ§Ø¨Ø¹ init */
      const s = document.createElement('script');
      s.id  = 'upgrade-js-script';
      s.src = 'dashboard-upgrade.js';
      s.onload = () =>
        typeof initUpgradeDashboard === 'function' && initUpgradeDashboard();
      document.body.appendChild(s);
    } catch (err) {
      console.error(err);
      main.innerHTML =
        '<div class="text-red-500 text-center py-8">âš ï¸ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¨Ø®Ø´ Ø§Ø±ØªÙ‚Ø§ Ø´Ú©Ø³Øª Ø®ÙˆØ±Ø¯</div>';
    }
  }

  /* -------------------------------------------------
   â· Ù‡Ù†Ø¯Ù„Ù Ú©Ù„ÛŒÚ©Ù Ù…Ù†ÙˆÛŒ Â«Ø§Ø±ØªÙ‚Ø§Â»
   ------------------------------------------------- */
  (function () {
    const btn = document.getElementById('menu-upgrade');
    if (!btn || btn.dataset.listener) return;      // Ø¯ÙˆØ¨Ø§Ø± Ø«Ø¨Øª Ù†Ø´ÙˆØ¯

    btn.addEventListener('click', () => {
      /* Ù‡Ø§ÛŒÙ„Ø§ÛŒØª Ù…Ù†Ùˆ Ùˆ Ù…Ø®ÙÛŒâ€ŒÚ©Ø±Ø¯Ù† Ø³Ø§ÛŒØ± Ø³Ú©Ø´Ù†â€ŒÙ‡Ø§ */
      document.querySelectorAll('.sidebar-link').forEach(el => el.classList.remove('active'));
      btn.classList.add('active');

      document.querySelectorAll("section[id^='section-']").forEach(sec => sec.style.display = 'none');

      /* Ù„ÙˆØ¯Ù Ù…Ø­ØªÙˆØ§Ù‰ Ø§Ø±ØªÙ‚Ø§ */
      loadDashboardUpgrade();

      /* Ø¨Ø³ØªÙ† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
      if (innerWidth <= 768) toggleSidebar();
    });

    btn.dataset.listener = '1';
  })();







async function loadDailyVisits () {
  const main = document.getElementById('main-content');
  main.innerHTML =
    '<div class="text-gray-400 text-center py-8">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ù…Ø§Ø± â€¦</div>';

  try {
    /* 1) Ø¯Ø±ÛŒØ§ÙØª Ùˆ ØªØ²Ø±ÛŒÙ‚ HTML */
    const res = await fetch('daily-visits.html');
    if (!res.ok) throw new Error('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù…Ø­ØªÙˆØ§');
    main.innerHTML = await res.text();

    /* 2) Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ú©Ø´Ù Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø¯Ø± Ø±ÙØ±Ø´ Ú¯Ø±Ù… */
    const old = document.getElementById('daily-visits-js');
    if (old) old.remove();

    /* 3) Ø§ÙØ²ÙˆØ¯Ù† Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ùˆ Ø§Ø¬Ø±Ø§ÛŒ Ù…Ù†Ø·Ù‚ */
    const s   = document.createElement('script');
    s.id  = 'daily-visits-js';
    s.src = 'daily-visits.js';
    document.body.appendChild(s);
  } catch (err) {
    console.error(err);
    main.innerHTML =
      '<div class="text-red-500 text-center py-8">âš ï¸ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ù…Ø§Ø± Ø´Ú©Ø³Øª Ø®ÙˆØ±Ø¯</div>';
  }
}





// â”€â”€â”€ ØªØ§Ø¨Ø¹ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¨Ø®Ø´ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let messagesLoaded = false;
async function loadDashboardMessages() {
  const main = document.getElementById('main-content');

  main.innerHTML = '<div class="text-gray-400 text-center py-8">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ â€¦</div>';
  try {
    // Û±) Ø¯Ø±ÛŒØ§ÙØª HTML Ø¨Ø®Ø´ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§
    const res = await fetch('dashboard-messages.html');
    if (!res.ok) throw new Error('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§');
    main.innerHTML = await res.text();

    if (!messagesLoaded) {
      // Ø¯Ø± Ø§ÙˆÙ„ÛŒÙ† Ø¨Ø§Ø±ØŒ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø±Ø§ Ù„ÙˆØ¯ Ú©Ù†
      const old = document.getElementById('messages-js-script');
      if (old) old.remove();
      const s = document.createElement('script');
      s.id = 'messages-js-script';
      s.src = 'dashboard-messages.js';
      s.onload = () => {
        typeof window.initMessaging === 'function' && window.initMessaging();
        typeof window.fetchChats === 'function' && window.fetchChats();
      };
      document.body.appendChild(s);
      messagesLoaded = true;
    } else {
      // Ø§Ú¯Ø± Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù‚Ø¨Ù„Ø§Ù‹ Ù„ÙˆØ¯ Ø´Ø¯Ù‡ØŒ ÙÙ‚Ø· Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ú©Ù†
      typeof window.initMessaging === 'function' && window.initMessaging();
      typeof window.fetchChats === 'function' && window.fetchChats();
    }
  } catch (err) {
    console.error(err);
    main.innerHTML = '<div class="text-red-500 text-center py-8">âš ï¸ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ Ø´Ú©Ø³Øª Ø®ÙˆØ±Ø¯</div>';
  }
}


// â”€â”€â”€ Ù‡Ù†Ø¯Ù„ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù…Ù†ÙˆÛŒ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function () {
const btn = document.getElementById('menu-msg');
if (!btn || btn.dataset.listener) return;
btn.addEventListener('click', () => {
  // Ù‡Ø§ÛŒÙ„Ø§ÛŒØª Ù…Ù†Ùˆ
  document.querySelectorAll('.sidebar-link').forEach(el => el.classList.remove('active'));
  btn.classList.add('active');
  // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø³Ø§ÛŒØ± Ø³Ú©Ø´Ù†â€ŒÙ‡Ø§
  document.querySelectorAll("section[id^='section-']").forEach(sec => sec.style.display = 'none');
  // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¨Ø®Ø´ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§
  loadDashboardMessages();
  // Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù‡Ù…Ù‡â€ŒÛŒ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù‡â€ŒÙ†Ø´Ø¯Ù‡
updateBadge(0);
  // Ø¨Ø³ØªÙ† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„
  if (window.innerWidth <= 768) toggleSidebar();
});
btn.dataset.listener = '1';
})();

// Ú¯Ø±ÙØªÙ† Ù‡Ù…Ù‡ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ Ùˆ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± window.chats
async function fetchSellerMessages() {
  if (!window.seller?.id) return [];
  try {
    const res = await fetch(`/api/chats?sellerId=${window.seller.id}`, { credentials: "include" });
    if (!res.ok) return [];
    return await res.json();
  } catch (err) {
    return [];
  }
}

// â”€â”€â”€ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¹Ù…Ù„Ú©Ø±Ø¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadPerformanceStatus() {
  const container = document.getElementById('performance-container');
  if (!container) return;
  container.style.display = 'block';
  container.innerHTML = '<div class="text-gray-400 text-center py-8">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ â€¦</div>';
  try {
    const res = await fetch('performance-status.html');
    if (!res.ok) throw new Error('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù…Ø­ØªÙˆØ§');
    container.innerHTML = await res.text();
  } catch (err) {
    console.error(err);
    container.innerHTML = '<div class="text-red-500 text-center py-8">Ù…Ø´Ú©Ù„ÛŒ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù¾ÛŒØ´ Ø¢Ù…Ø¯Ù‡.</div>';
  }
}

// â”€â”€â”€ Ù‡Ù†Ø¯Ù„ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù…Ù†ÙˆÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¹Ù…Ù„Ú©Ø±Ø¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function () {
  const btn = document.getElementById('menu-performance');
  if (!btn || btn.dataset.listener) return;
  btn.addEventListener('click', () => {
    document.querySelectorAll('.sidebar-link').forEach(el => el.classList.remove('active'));
    btn.classList.add('active');
    document.querySelectorAll("section[id^='section-']").forEach(sec => sec.style.display = 'none');
    document.getElementById('main-content').innerHTML = '';
    loadPerformanceStatus();
    if (window.innerWidth <= 768) toggleSidebar();
  });
  btn.dataset.listener = '1';
})();













</script>







<!-- Success Popup -->
<!-- Success Popup (Ø§ØµÙ„Ø§Ø­ Ø¨Ø±Ø§ÛŒ RTL Ùˆ ØªØ¯Ø§Ø®Ù„ container) -->
<div id="productSuccessPopup" style="display:none !important; z-index:10000 !important; position:fixed !important; top:0 !important; right:0 !important; left:0 !important; bottom:0 !important; justify-content:center !important; align-items:center !important; background:rgba(0,0,0,0.8) !important; opacity:0; transition:opacity 0.3s;">
<div style="background:white; border-radius:16px; padding:20px; text-align:center; max-width:300px; direction:rtl;">
  <svg width="44" height="44" viewBox="0 0 48 48" fill="none">
    <circle cx="24" cy="24" r="22" fill="#e0fdfa" stroke="#10b981" stroke-width="2"/>
    <path d="M16 25l6 6 10-12" stroke="#10b981" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
  <div style="font-size:20px; color:#10b981;">Ù…Ø­ØµÙˆÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯!</div>
  <div style="color:gray;">Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù…Ø­ØµÙˆÙ„ Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø± Ù„ÛŒØ³Øª Ù…Ø­ØµÙˆÙ„Ø§Øª Ø¨Ø¨ÛŒÙ†ÛŒØ¯.</div>
</div>
</div>

 




<script src="dashboard-content.js"></script>


</body>
</html>