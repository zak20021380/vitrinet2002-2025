<!-- ═══════════════════════════════════════════════════════════════════════════
     Special Advertisement Modal - Premium Mobile-First Design
     Include this in your dashboard.html or dashboard-upgrade.html
     ═══════════════════════════════════════════════════════════════════════════ -->

<!-- Special Ad Modal Backdrop -->
<div id="specialAdBackdrop" class="special-ad-backdrop" role="dialog" aria-modal="true" aria-labelledby="special-ad-title">
  <div class="special-ad-modal">
    <!-- Drag Handle (Mobile) -->
    <div class="special-ad-modal__handle"></div>

    <!-- Header -->
    <header class="special-ad-header">
      <button type="button" class="special-ad-header__close" id="specialAdCloseBtn" aria-label="بستن">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </button>
      <h2 id="special-ad-title" class="special-ad-header__title">ثبت تبلیغ ویژه</h2>
      <p class="special-ad-header__subtitle">کسب‌وکارتان را در صدر نتایج نشان دهید</p>
    </header>

    <!-- Body - Scrollable Content -->
    <div class="special-ad-body">
      <form id="specialAdForm" class="special-ad-form" novalidate>
        
        <!-- Step 1: Ad Type Selection -->
        <section class="special-ad-step">
          <div class="special-ad-step__header">
            <span class="special-ad-step__number">۱</span>
            <h3 class="special-ad-step__title">نوع تبلیغ</h3>
          </div>
          
          <div class="special-ad-type-grid">
            <!-- Product Ad - Duotone Icon -->
            <label class="special-ad-type-card is-selected" data-type="product">
              <input type="radio" name="adType" value="product" checked>
              <div class="special-ad-type-card__icon">
                <svg viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <!-- Background Layer (Secondary Color) -->
                  <path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z" stroke="currentColor" stroke-width="1.5" opacity="0.3" fill="currentColor" fill-opacity="0.05"/>
                  <!-- Foreground Lines (Primary Color) -->
                  <path d="M3.27 6.96L12 12.01l8.73-5.05" stroke="currentColor" stroke-width="1.8"/>
                  <path d="M12 22.08V12" stroke="currentColor" stroke-width="1.8"/>
                  <circle cx="12" cy="12" r="2" fill="currentColor" opacity="0.2"/>
                </svg>
              </div>
              <p class="special-ad-type-card__label">تبلیغ محصول</p>
            </label>
            
            <!-- Shop Ad - Duotone Icon -->
            <label class="special-ad-type-card" data-type="shop">
              <input type="radio" name="adType" value="shop">
              <div class="special-ad-type-card__icon">
                <svg viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <!-- Background Layer (Secondary Color) -->
                  <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" stroke="currentColor" stroke-width="1.5" opacity="0.3" fill="currentColor" fill-opacity="0.05"/>
                  <!-- Foreground Lines (Primary Color) -->
                  <path d="M9 22V12h6v10" stroke="currentColor" stroke-width="1.8"/>
                  <path d="M12 2l6 4.5" stroke="currentColor" stroke-width="1.8" opacity="0.6"/>
                  <circle cx="12" cy="15" r="1.5" fill="currentColor" opacity="0.25"/>
                </svg>
              </div>
              <p class="special-ad-type-card__label">تبلیغ کل مغازه</p>
            </label>
          </div>

          <!-- Product Picker (shown when product type selected) -->
          <div id="specialAdProductPicker" class="special-ad-product-picker">
            <label class="special-ad-product-picker__label">انتخاب محصول</label>
            
            <!-- Custom Premium Dropdown -->
            <div class="sam-dropdown" id="specialAdDropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox" aria-labelledby="specialAdProductLabel">
              <!-- Trigger Button -->
              <button type="button" class="sam-dropdown__trigger" id="specialAdDropdownTrigger" aria-controls="specialAdDropdownList">
                <span class="sam-dropdown__value" id="specialAdDropdownValue">یک مورد را انتخاب کنید...</span>
                <svg class="sam-dropdown__chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M6 9l6 6 6-6"/>
                </svg>
              </button>
              
              <!-- Dropdown Panel -->
              <div class="sam-dropdown__panel" id="specialAdDropdownPanel" role="listbox" aria-labelledby="specialAdProductLabel">
                <!-- Search Input (optional for many items) -->
                <div class="sam-dropdown__search-wrap">
                  <svg class="sam-dropdown__search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="M21 21l-4.35-4.35"/>
                  </svg>
                  <input type="text" class="sam-dropdown__search" id="specialAdDropdownSearch" placeholder="جستجوی محصول..." autocomplete="off">
                </div>
                
                <!-- Options List -->
                <ul class="sam-dropdown__list" id="specialAdDropdownList">
                  <!-- Items will be populated by JS -->
                  <li class="sam-dropdown__empty">در حال بارگذاری...</li>
                </ul>
              </div>
            </div>
            
            <!-- Hidden native select for form submission (no required - custom validation handles it) -->
            <select id="specialAdProductSelect" name="productId" class="sam-dropdown__native-select" tabindex="-1" aria-hidden="true">
              <option value="">یک مورد را انتخاب کنید...</option>
            </select>
          </div>
        </section>

        <!-- Step 2: Content & Visuals -->
        <section class="special-ad-step">
          <div class="special-ad-step__header">
            <span class="special-ad-step__number">۲</span>
            <h3 class="special-ad-step__title">محتوا و تصویر</h3>
          </div>

          <!-- Ad Title -->
          <div class="special-ad-form-group">
            <label class="special-ad-label">
              <span>عنوان تبلیغ</span>
              <span class="special-ad-label__hint">۳ تا ۲۵ کاراکتر</span>
            </label>
            <input 
              type="text" 
              id="specialAdTitle" 
              name="title"
              class="special-ad-input" 
              placeholder="مثال: تخفیف ویژه عید"
              minlength="3"
              maxlength="25"
              autocomplete="off"
            >
            <div id="specialAdTitleCounter" class="special-ad-char-counter">۰ / ۲۵</div>
          </div>

          <!-- Ad Text -->
          <div class="special-ad-form-group">
            <label class="special-ad-label">
              <span>متن جذاب</span>
              <span class="special-ad-label__hint">۱۰ تا ۳۰ کاراکتر</span>
            </label>
            <textarea 
              id="specialAdText" 
              name="text"
              class="special-ad-textarea" 
              placeholder="مثال: ۳۰٪ تخفیف تا پایان هفته!"
              minlength="10"
              maxlength="30"
              autocomplete="off"
            ></textarea>
            <div id="specialAdTextCounter" class="special-ad-char-counter">۰ / ۳۰</div>
          </div>

          <!-- Image Section - Premium Mobile-First Design -->
          <div class="special-ad-image-section">
            <label class="special-ad-label">
              <span>تصویر تبلیغ</span>
            </label>
            
            <!-- Preview Frame -->
            <div id="specialAdImagePreview" class="special-ad-image-preview">
              <!-- Actual Image -->
              <img id="specialAdPreviewImg" class="special-ad-image-preview__img" src="" alt="پیش‌نمایش تصویر">
              
              <!-- Empty State Placeholder (clickable) -->
              <div id="specialAdImagePlaceholder" class="special-ad-image-preview__placeholder" role="button" tabindex="0">
                <div class="special-ad-image-preview__placeholder-icon-wrap">
                  <svg class="special-ad-image-preview__placeholder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <rect x="3" y="3" width="18" height="18" rx="3"/>
                    <circle cx="8.5" cy="8.5" r="1.5"/>
                    <path d="M21 15l-5-5L5 21"/>
                    <path d="M12 8v4m0 0v4m0-4h4m-4 0H8" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </div>
                <p class="special-ad-image-preview__placeholder-text">برای انتخاب تصویر ضربه بزنید</p>
                <span class="special-ad-image-preview__placeholder-hint">یا تصویر محصول انتخابی نمایش داده می‌شود</span>
              </div>
              
              <!-- Gallery Controls -->
              <button type="button" id="specialAdImagePrev" class="special-ad-image-nav special-ad-image-nav--prev" aria-label="تصویر قبلی">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M15 6l-6 6 6 6"/>
                </svg>
              </button>
              <button type="button" id="specialAdImageNext" class="special-ad-image-nav special-ad-image-nav--next" aria-label="تصویر بعدی">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M9 6l6 6-6 6"/>
                </svg>
              </button>
              <div id="specialAdImageIndicator" class="special-ad-image-indicator" aria-live="polite">۱/۳</div>
              <div id="specialAdImageRetryHint" class="special-ad-image-retry-hint" hidden>در حال تلاش برای تصویر بعدی...</div>
              
              <!-- Success Badge -->
              <span id="specialAdImageBadge" class="special-ad-image-preview__badge">تصویر انتخاب شد</span>
              
              <!-- Error State -->
              <div id="specialAdImageError" class="special-ad-image-error" hidden>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <path d="M12 8v4m0 4h.01"/>
                </svg>
                <span>خطا در بارگذاری تصویر</span>
                <button type="button" id="specialAdRetryBtn" class="special-ad-image-retry-btn">تلاش مجدد</button>
              </div>
            </div>
            
            <!-- Hidden File Input -->
            <input type="file" id="specialAdImageInput" class="special-ad-file-input" accept="image/*">
            
            <!-- Action Buttons (Full-width, thumb-friendly) -->
            <div class="special-ad-image-actions">
              <button type="button" id="specialAdChangeImageBtn" class="special-ad-image-action-btn special-ad-image-action-btn--primary">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14"/>
                  <rect x="3" y="3" width="18" height="18" rx="2"/>
                </svg>
                <span id="specialAdChangeImageText">انتخاب تصویر</span>
              </button>
              <button type="button" id="specialAdRemoveImageBtn" class="special-ad-image-action-btn special-ad-image-action-btn--secondary" hidden>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                </svg>
                <span>حذف تصویر</span>
              </button>
            </div>

            <p class="special-ad-image-hint">برای دیدن تصاویر بیشتر، بکشید</p>

            <p id="specialAdImageFinalHint" class="special-ad-image-final-hint" hidden>از بین تصاویر محصول، فقط همین تصویر به‌عنوان تصویر نهایی تبلیغ استفاده می‌شود.</p>
            
            <!-- Status Label -->
            <span id="specialAdImageStatus" class="special-ad-image-status">پیش‌فرض: تصویر محصول انتخابی</span>
          </div>
        </section>

        <!-- Step 3: Payment & Credit -->
        <section class="special-ad-step">
          <div class="special-ad-step__header">
            <span class="special-ad-step__number">۳</span>
            <h3 class="special-ad-step__title">پرداخت و اعتبار</h3>
          </div>

          <!-- Wallet Info -->
          <div class="special-ad-wallet-info">
            <span class="special-ad-wallet-info__label">اعتبار فعلی شما:</span>
            <span id="specialAdWalletBalance" class="special-ad-wallet-info__value">۰ تومان</span>
          </div>

          <!-- Credit Toggle - Premium Card -->
          <div id="specialAdCreditToggle" class="special-ad-credit-toggle">
            <div class="special-ad-credit-toggle__content">
              <p class="special-ad-credit-toggle__label">استفاده از اعتبار کیف پول</p>
              <p id="specialAdCreditHint" class="special-ad-credit-toggle__hint">اعتبار شما برای کسر از هزینه استفاده می‌شود</p>
            </div>
            <label class="special-ad-switch">
              <input type="checkbox" id="specialAdCreditSwitch">
              <span class="special-ad-switch__slider"></span>
            </label>
          </div>

          <!-- Price Breakdown -->
          <div class="special-ad-price-breakdown">
            <div class="special-ad-price-row">
              <span class="special-ad-price-row__label">هزینه کل:</span>
              <span id="specialAdTotalPrice" class="special-ad-price-row__value">۷۹,۰۰۰ تومان</span>
            </div>
            <div id="specialAdCreditRow" class="special-ad-price-row" style="display: none;">
              <span class="special-ad-price-row__label">کسر از اعتبار:</span>
              <span id="specialAdCreditAmount" class="special-ad-price-row__value is-discount">-۰ تومان</span>
            </div>
            <div class="special-ad-price-row special-ad-price-row--total">
              <span class="special-ad-price-row__label">مبلغ نهایی قابل پرداخت:</span>
              <span id="specialAdFinalPrice" class="special-ad-price-row__value">۷۹,۰۰۰ تومان</span>
            </div>
          </div>
        </section>

      </form>
    </div>

    <!-- Footer - Premium CTA -->
    <footer class="special-ad-footer">
      <button type="button" id="specialAdSubmitBtn" class="special-ad-submit-btn">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 12l2 2 4-4"/>
          <circle cx="12" cy="12" r="10"/>
        </svg>
        <span class="special-ad-submit-btn__text">ثبت و پرداخت نهایی</span>
        <span class="special-ad-submit-btn__loading"></span>
      </button>
    </footer>
  </div>
</div>
