<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>خرید کیف زنانه مینیمال شیک | ONYX MODERN</title>
  <meta name="description" content="خرید کیف زنانه مینیمال با طراحی مدرن، جادار، سبک و خاص. ارسال فوری، تضمین اصالت، انتخاب رنگ دلخواه فقط در فروشگاه ONYX MODERN.">
  <meta name="keywords" content="خرید کیف زنانه, کیف مینیمال, کیف مدرن, کیف روزمره, فروشگاه کیف زنانه">
  <meta property="og:title" content="کیف زنانه مینیمال شیک | فروشگاه ONYX MODERN">
  <meta property="og:description" content="جدیدترین مدل کیف زنانه مینیمال شیک، سبک و مقاوم، مناسب استفاده روزمره و استایل رسمی.">
  <meta property="og:image" content="https://images.unsplash.com/photo-1503342452485-86a096e79bba?auto=format&fit=crop&w=800&q=80&format=webp">
  <meta property="og:url" content="https://yourshop.ir/product/minimal-women-bag">
  <meta property="og:type" content="product">
  <link rel="canonical" href="https://yourshop.ir/product/minimal-women-bag">
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org/",
    "@type": "Product",
    "name": "کیف زنانه مینیمال",
    "image": [
      "https://images.unsplash.com/photo-1503342452485-86a096e79bba?auto=format&fit=crop&w=800&q=80&format=webp",
      "https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=600&q=80&format=webp",
      "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=800&q=80&format=webp"
    ],
    "description": "کیف زنانه مینیمال با طراحی ساده و شیک، چرم مصنوعی باکیفیت، سبک و جادار. مناسب استفاده روزمره و مهمانی.",
    "brand": {"@type": "Brand","name": "ONYX MODERN"},
    "offers": {
      "@type": "Offer",
      "priceCurrency": "IRR",
      "price": "1850000",
      "availability": "https://schema.org/InStock"
    }
  }
  </script>
  <style>
    body {
      font-family: 'Vazirmatn', sans-serif;
      background: linear-gradient(110deg, #f5f7fb 80%, #f0f4ff 100%);
      color: #232946;
      margin: 0; padding: 0;
    }
    header {
      background: #fff;
      border-bottom: 1.5px solid #f2f4fa;
      box-shadow: 0 1px 16px #7C83FD10;
      position: sticky; top: 0; z-index: 50;
      padding: 1.1rem 0;
    }
    .navbar {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1.2rem;
    }
    .navlinks {display: flex; gap: 2.1rem;}
    .navlinks a {color: #2f385c; font-weight: 500; text-decoration: none; transition:.13s;}
    .navlinks a:hover {color: #6a7afd;}
    .logoimg-vitrin {width: 2.6rem; height: 2.6rem; border-radius: 16px; object-fit: cover;}
    .brandtxt {font-size: 1.45rem; font-weight: 900; color: #6a7afd; letter-spacing: -.02em;}
    .main-container {
      max-width: 1080px;
      margin: 0 auto;
      padding: 2.4rem 1.1rem 0 1.1rem;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2.8rem;
      align-items: flex-start;
    }
    @media (max-width: 900px) {.main-container{grid-template-columns:1fr; gap:2rem; padding:1.2rem .4rem 0 .4rem;}}
    .gallerybox {
      background: #fff;
      border-radius: 1.1rem;
      box-shadow: 0 4px 26px #7C83FD13;
      padding: 1.6rem 1rem 1.2rem 1rem;
      max-width: 420px;
      width: 100%;
      margin: 0 auto;
    }
    .mainimg-wrap {
      aspect-ratio: 1/1;
      background: #f3f6fa;
      border-radius: 1.1rem;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 24px #7C83FD13;
      margin-bottom: 1.2rem;
      min-height: 240px;
    }
    .mainimg-wrap img {width: 100%; height: 100%; object-fit: cover;}
    .thumbbar {display: flex; gap: 9px; justify-content: center;}
    .thumbimg {
      width: 45px; height: 45px; border-radius: .7rem;
      border: 2px solid transparent;
      object-fit: cover; cursor: pointer;
      background: #f6f8fd; transition: border .18s;
    }
    .thumbimg.active, .thumbimg:hover {border-color:#6a7afd;}
    @media (max-width:600px){.gallerybox{padding:.7rem;}.mainimg-wrap{min-height:140px;}}
    .productcard {
      background: #fff;
      border-radius: 1.1rem;
      box-shadow: 0 3px 22px #7C83FD12;
      padding: 2.2rem 2rem 2rem 2rem;
      width: 100%;
      min-width: 240px;
      margin: 0 auto;
      max-width: 510px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 1.1rem;
    }
    .product-title {
      font-size: 2rem; font-weight: 900;
      color: #232946;
      margin-bottom: .4rem;
      line-height: 1.2;
      letter-spacing: -.01em;
    }
    .price-badge {
      background: #f0f2ff;
      color: #5b63df;
      border-radius: .85rem;
      padding: .5rem 1.3rem;
      font-size: 1.5rem;
      font-weight: 800;
      letter-spacing: -.04em;
      margin-bottom: .2rem;
      display: inline-block;
    }
    .stock-badge {
      background: #e5fbee;
      color: #30b88a;
      font-size: .99rem;
      font-weight: 700;
      padding: 4px 15px;
      border-radius: 8px;
      display: inline-block;
      margin-right: .8rem;
    }
    .product-desc {
      color: #465067;
      font-size: 1.1rem;
      line-height: 2.1;
      margin: .7rem 0 0 0;
    }
    .feat-list {
      list-style: none;
      margin: 1.1rem 0 1.7rem 0;
      padding: 0;
    }
    .feat-list li {
      position: relative;
      font-size: 1.04rem;
      color: #232946;
      margin-bottom: .8rem;
      padding-right: 1.4rem;
      font-weight: 500;
      line-height: 2.1;
    }
    .feat-list li:before {
      content: '';
      width: 8px; height: 8px;
      background: linear-gradient(45deg,#7C83FD,#5b63df);
      border-radius: 50%;
      position: absolute;
      right: 0; top: 13px;
    }
    .optbar {display: flex; flex-wrap: wrap; gap: 11px;}
    select {
      font-size: 1.03rem;
      border-radius: .65rem;
      border: 1.3px solid #dadffd;
      background: #f7f8fd;
      padding: .63rem 1.15rem;
      min-width: 120px;
      margin-left: 4px;
      outline: none;
      transition: border .13s;
    }
    select:focus {border-color:#7C83FD;}
    .btn-main {
      background: linear-gradient(91deg,#7C83FD 60%,#5b63df 120%);
      color: #fff;
      border-radius: .83rem;
      font-weight: 700;
      font-size: 1.12rem;
      padding: .8rem 2.1rem;
      border: none;
      box-shadow: 0 1px 9px #7C83FD17;
      cursor: pointer;
      transition: background .14s,box-shadow .14s;
    }
    .btn-main:hover {background: #232946;}
    .btn-link {
      background: #fff;
      color: #7C83FD;
      border: 1.3px solid #7C83FD;
      border-radius: .83rem;
      font-weight: 700;
      font-size: 1.12rem;
      padding: .8rem 2.1rem;
      cursor: pointer;
      transition: background .14s,color .14s;
    }
    .btn-link:hover {background:#f2f6ff;color:#232946;}
    footer {
      background: #f5f7fc;
      color: #7C83FD;
      border-radius: 1.1rem 1.1rem 0 0;
      text-align: center;
      margin-top: 3.6rem;
      padding: 2.2rem 1rem 1.2rem 1rem;
      box-shadow: 0 1px 22px #7C83FD09;
    }
    .footer-logo-vitrin {
      width: 54px; height: 54px; border-radius: 12px; object-fit: cover;
      margin: 0 auto 13px auto; box-shadow: 0 2px 8px #7C83FD11;
      background: #fff;
      display: block;
    }
    .footer-brand {font-weight: 900; font-size: 1.03rem; color: #232946; margin-bottom: 9px;}
  </style>
</head>
<body>
  <!-- Header -->
<!-- Header -->
<header class="modern-header" role="banner">
  <div class="header-row">
    <!-- سمت راست: لوگو و نام فروشگاه داینامیک -->
<div class="header-shop-brand" aria-label="لوگو و نام فروشگاه">
  <a class="dynamic-brand-link brand-link-clean"
     href="#"
     target="_blank"
     rel="noopener">
    <span class="dynamic-brand"></span>
  </a>
</div>







    <!-- وسط: منو و آمار -->
<div class="header-middle">
  <nav class="header-nav" aria-label="ناوبری اصلی">
    <a href="/">خانه</a>
    <a href="#" class="shop-link-dynamic">فروشگاه</a>
    <button class="address-btn" aria-label="نمایش آدرس" type="button">آدرس فروشگاه</button>
  </nav>
</div>


<!-- User Auth Box - Start -->
<div class="header-user-auth" id="headerUserAuth" style="margin-right: 1.3rem;">
  <!-- این قسمت به صورت داینامیک با جاوااسکریپت پر می‌شود -->
</div>
<!-- User Auth Box - End -->








    <!-- سمت چپ: لوگوی ویترینت فارسی و استایل خاص -->
    <a href="https://www.vitrinnet.com" target="_blank" rel="noopener" class="header-logo-vitrin" aria-label="ویترینت">
      <span class="vitrin-text-fa">ویترینت</span>
    </a>
  </div>

  <!-- پاپ‌آپ آدرس فروشگاه -->
  <div class="address-popup" role="dialog" aria-modal="true" aria-labelledby="address-title" tabindex="-1">
    <div class="popup-content">
      <svg width="40" height="40" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 3C7.03 3 3 7.03 3 12c0 4.97 9 13 9 13s9-8.03 9-13c0-4.97-4.03-9-9-9zm0 12.5a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7z" fill="#5b63df"/>
      </svg>
      <h4 id="address-title">آدرس فروشگاه</h4>
      <p>
        <span class="dynamic-address"></span>
      </p>
      <button class="popup-close popup-close-address" aria-label="بستن پاپ‌آپ آدرس">بستن</button>
    </div>
  </div>
  <!-- پاپ‌آپ امتیاز ثبت شد -->
  <div class="rating-popup" role="alert" aria-live="polite" tabindex="-1">
    <div class="popup-content">
      <svg width="40" height="40" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M20 6L9 17l-5-5" stroke="#10b981" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <h4>امتیاز شما ثبت شد!</h4>
      <button class="popup-close popup-close-rating" aria-label="بستن پاپ‌آپ امتیاز">بستن</button>
    </div>
  </div>
</header>











  <!-- Main -->
  <main class="main-container">
    <!-- Gallery -->
    <section class="gallerybox" aria-label="گالری تصاویر کیف زنانه">
      <div class="mainimg-wrap">
        <img id="mainImage" src="https://images.unsplash.com/photo-1503342452485-86a096e79bba?auto=format&fit=crop&w=800&q=80&format=webp" alt="نمای اصلی کیف زنانه مینیمال شیک">
      </div>
      <div class="thumbbar">
        <img class="thumbimg active" src="https://images.unsplash.com/photo-1503342452485-86a096e79bba?auto=format&fit=crop&w=800&q=80&format=webp" alt="کیف زنانه از روبرو">
        <img class="thumbimg" src="https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=800&q=80&format=webp" alt="کیف زنانه از کنار">
        <img class="thumbimg" src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=800&q=80&format=webp" alt="جزئیات کیف زنانه">
      </div>
    </section>
    <!-- Product Info -->
    <section class="productcard">
      <div class="product-title">کیف زنانه مینیمال شیک</div>
      <span class="price-badge">۱,۸۵۰,۰۰۰ <span class="text-lg font-bold align-middle mr-1">تومان</span></span>
      <span class="stock-badge">موجود</span>
      <div class="product-desc">
        کیف زنانه خاص با طراحی ساده، مدرن و مینیمال. ساخته شده از چرم مصنوعی با کیفیت و ضدآب، سبک و جادار، مناسب برای استایل روزمره و رسمی بانوان شیک‌پوش.
      </div>
      <ul class="feat-list">
        <li>جنس بدنه: چرم مصنوعی مقاوم و قابل شستشو</li>
        <li>ابعاد: ۲۵ × ۱۹ × ۹ سانتی‌متر</li>
        <li>وزن: ۴۴۰ گرم</li>
        <li>رنگ: بژ (قابل سفارش: مشکی، کرم، آبی)</li>
        <li>۲ جیب داخلی و ۱ جیب زیپی خارجی</li>
        <li>ضمانت بازگشت ۷ روزه</li>
      </ul>


<!-- btnbar-product داخل HTML (فقط یک بار!): -->
<div class="btnbar-product">
  <!-- دکمه افزودن به علاقه‌مندی -->
  <button class="btn-main btn-fav">افزودن به علاقه‌مندی</button>
  
  <!-- دکمه مشاهده در سایت فروشنده (با لینک دینامیک) -->
  <a href="#" target="_blank" rel="noopener" class="btn-main btn-outline btn-seller-site" style="display:none">
    مشاهده در سایت فروشنده
  </a>
  
  <!-- دکمه تماس با فروشنده -->
  <a href="#" class="btn-main btn-contact" id="contactSellerBtn" title="تماس با فروشنده" style="display:none">
    تماس با فروشنده
  </a>

  <!-- فرم ارسال پیام به فروشنده -->
  <div id="contactForm" style="display: none;">
    <input type="hidden" id="sellerId" value="">
    <input type="hidden" id="productId" value="">

    <textarea id="message" placeholder="لطفا پیام خود را در مورد این محصول به فروشنده ارسال کنید" rows="5" style="width: 100%; padding: 10px;"></textarea>
    <button id="sendMessageBtn" class="btn-main" style="margin-top: 10px;">ارسال پیام</button>
    <button id="closeFormBtn" class="btn-main" style="margin-top: 10px; background-color: #ff4d4d;">بستن</button>
  </div>
</div>








    </section>
  </main>

<footer class="footer-vitrinnet" role="contentinfo">
  <div class="footer-flex">
    <!-- لوگو و شبکه اجتماعی -->
    <div class="footer-brand-social">
      <a href="https://www.vitrinnet.com" target="_blank" rel="noopener nofollow" class="footer-logo-link" aria-label="ورود به سایت اصلی ویترینت">
        <span class="footer-logo" aria-label="لوگو ویترینت">
          <svg width="36" height="36" viewBox="0 0 64 64" fill="none" aria-hidden="true">
            <rect x="8" y="22" width="48" height="36" rx="8" fill="#fff" filter="url(#shadow)"/>
            <rect x="6" y="14" width="52" height="10" rx="4" fill="url(#roof)"/>
            <rect x="8" y="16" width="48" height="1" fill="#fff" opacity="0.8"/>
            <rect x="8" y="19" width="48" height="1" fill="#fff" opacity="0.8"/>
            <rect x="8" y="22" width="48" height="1" fill="#fff" opacity="0.8"/>
            <rect x="12" y="8" width="40" height="8" rx="3" fill="url(#sign)"/>
            <rect x="16" y="10" width="32" height="1" rx="0.5" fill="#fff" opacity="0.7"/>
            <rect x="16" y="12" width="28" height="1" rx="0.5" fill="#fff" opacity="0.5"/>
            <rect x="12" y="28" width="16" height="20" rx="3" fill="url(#glass)" opacity="0.85"/>
            <rect x="14" y="30" width="12" height="1" rx="0.5" fill="#fff" opacity="0.4"/>
            <rect x="14" y="33" width="12" height="1" rx="0.5" fill="#fff" opacity="0.4"/>
            <rect x="36" y="28" width="16" height="20" rx="3" fill="url(#glass)" opacity="0.85"/>
            <rect x="38" y="30" width="12" height="1" rx="0.5" fill="#fff" opacity="0.4"/>
            <rect x="38" y="33" width="12" height="1" rx="0.5" fill="#fff" opacity="0.4"/>
            <rect x="29" y="36" width="10" height="22" rx="3" fill="#10b981" filter="url(#door-shadow)"/>
            <circle cx="34" cy="46" r="1.5" fill="#fff"/>
            <defs>
              <linearGradient id="roof" x1="6" y1="14" x2="58" y2="24" gradientUnits="userSpaceOnUse">
                <stop stop-color="#0ea5e9"/>
                <stop offset="1" stop-color="#10b981"/>
              </linearGradient>
              <linearGradient id="sign" x1="12" y1="8" x2="52" y2="16" gradientUnits="userSpaceOnUse">
                <stop stop-color="#10b981"/>
                <stop offset="1" stop-color="#0ea5e9"/>
              </linearGradient>
              <linearGradient id="glass" x1="12" y1="28" x2="28" y2="48" gradientUnits="userSpaceOnUse">
                <stop stop-color="#c7f7ea" stop-opacity="0.9"/>
                <stop offset="1" stop-color="#e0f7fa" stop-opacity="0.7"/>
              </linearGradient>
              <filter id="shadow" x="0" y="0" width="64" height="64" filterUnits="userSpaceOnUse">
                <feDropShadow dx="0" dy="3" stdDeviation="4" flood-color="#10b981" flood-opacity="0.25"/>
              </filter>
              <filter id="door-shadow" x="25" y="32" width="18" height="30" filterUnits="userSpaceOnUse">
                <feDropShadow dx="0" dy="1" stdDeviation="1" flood-color="#000" flood-opacity="0.2"/>
              </filter>
            </defs>
          </svg>
          <span class="vitrin-text">Vitrinnet</span>
        </span>
      </a>
      <p class="footer-about">
        فروشگاه آنلاین پوشاک و اکسسوری با طراحی‌های مینیمال و مدرن. خرید امن، تحویل سریع.
      </p>
      <nav class="footer-socials" aria-label="شبکه‌های اجتماعی">
        <a href="https://instagram.com" aria-label="اینستاگرام ویترینت" rel="nofollow noopener" target="_blank">
          <svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.366.062 2.633.326 3.608 1.301.975.975 1.24 2.242 1.301 3.608.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.062 1.366-.326 2.633-1.301 3.608-.975.975-2.242 1.24-3.608 1.301-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-1.366-.062-2.633-.326-3.608-1.301-.975-.975-1.24-2.242-1.301-3.608-.058-1.266-.07-1.646-.07-4.85s.012-3.584.07-4.85c.062-1.366.326-2.633 1.301-3.608.975-.975 2.242-1.24 3.608-1.301 1.266-.058 1.646-.07 4.85-.07zm0-2.163c-3.259 0-3.667.014-4.947.072-1.468.067-2.832.364-3.892 1.424-1.06 1.06-1.357 2.424-1.424 3.892-.058 1.28-.072 1.688-.072 4.947s.014 3.667.072 4.947c.067 1.468.364 2.832 1.424 3.892 1.06 1.06 2.424 1.357 3.892 1.424 1.28.058 1.688.072 4.947.072s3.667-.014 4.947-.072c1.468-.067 2.832-.364 3.892-1.424 1.06-1.06 1.357-2.424 1.424-3.892.058-1.28.072-1.688.072-4.947s-.014-3.667-.072-4.947c-.067-1.468-.364-2.832-1.424-3.892-1.06-1.06-2.424-1.357-3.892-1.424-1.28-.058-1.688-.072-4.947-.072zm0 5.838c-3.313 0-6 2.687-6 6s2.687 6 6 6 6-2.687 6-6-2.687-6-6-6zm0 10c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm4.7-10.3c-.775 0-1.4-.625-1.4-1.4s.625-1.4 1.4-1.4 1.4.625 1.4 1.4-.625 1.4-1.4 1.4z"/></svg>
        </a>
        <a href="https://twitter.com" aria-label="توییتر ویترینت" rel="nofollow noopener" target="_blank">
          <svg viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.69a4.31 4.31 0 001.88-2.38 8.64 8.64 0 01-2.73 1.04 4.3 4.3 0 00-7.34 3.92 12.2 12.2 0 01-8.86-4.5 4.3 4.3 0 001.33 5.74 4.28 4.28 0 01-1.95-.54v.05c0 2.01 1.43 3.68 3.33 4.06a4.3 4.3 0 01-1.94.07 4.3 4.3 0 004.01 2.98 8.62 8.62 0 01-5.33 1.84c-.35 0-.69-.02-1.03-.06a12.15 12.15 0 006.59 1.93c7.91 0 12.24-6.55 12.24-12.24 0-.19 0-.37-.01-.56.84-.6 1.56-1.35 2.14-2.2z"/></svg>
        </a>
        <a href="https://telegram.org" aria-label="تلگرام ویترینت" rel="nofollow noopener" target="_blank">
          <svg viewBox="0 0 24 24"><path d="M11.944 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0h-.056zm4.772 7.597c-.527 0-.955.427-.955.955v2.864H8.239V8.552c0-.528-.428-.955-.955-.955s-.955.427-.955.955v8.591c0 .528.428.955.955.955h8.591c.528 0 .955-.427.955-.955v-8.591c0-.528-.428-.955-.955-.955zm-3.818 2.864h1.91v1.91h-1.91v-1.91zm-3.818 0h1.91v1.91h-1.91v-1.91zm7.636 3.818h-1.91v1.91h1.91v-1.91zm-3.818 0h-1.91v1.91h1.91v-1.91zm-3.818 0h-1.91v1.91h1.91v-1.91z"/></svg>
        </a>
      </nav>
    </div>

    <!-- دسترسی سریع -->
    <nav class="footer-links" aria-label="دسترسی سریع">
      <h3>دسترسی سریع</h3>
      <ul>
        <li><a href="/about" aria-label="درباره ما">درباره ما</a></li>
        <li><a href="/contact" aria-label="تماس با ما">تماس با ما</a></li>
        <li><a href="/privacy" aria-label="حریم خصوصی">حریم خصوصی</a></li>
        <li><a href="/faq" aria-label="سوالات متداول">سوالات متداول</a></li>
      </ul>
    </nav>

    <!-- رفتن به سایت اصلی -->
    <div class="footer-main-site">
      <h3>ویترینت</h3>
      <a href="http://localhost:5000/index.html" target="_blank" rel="noopener nofollow" class="footer-main-btn" aria-label="رفتن به سایت اصلی ویترینت">
        ورود به سایت اصلی
      </a>
    </div>
  </div>
  <div class="footer-bottom">
    <span>© ۱۴۰۴ ویترینت – تمام حقوق محفوظ است.</span>
  </div>
</footer>

<style>
.footer-vitrinnet {
  background: linear-gradient(180deg, #F7FAFE 0%, #E5ECFB 100%);
  padding: 2.2rem 1rem 1.2rem;
  margin-top: 3.2rem;
  box-shadow: 0 -2px 14px rgba(16, 185, 129, 0.09);
  border-radius: 1.3rem 1.3rem 0 0;
  font-family: 'Vazirmatn', sans-serif;
  direction: rtl;
}
.footer-flex {
  max-width: 1080px;
  margin: 0 auto;
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 2.5rem;
  flex-wrap: wrap;
}
.footer-brand-social {
  min-width: 210px;
  flex: 1 1 280px;
  display: flex;
  flex-direction: column;
  gap: .75rem;
}
.footer-logo-link {
  display: flex;
  align-items: center;
  text-decoration: none;
  gap: 0.7rem;
  margin-bottom: 0.5rem;
}
.footer-logo svg {
  width: 34px;
  height: 34px;
}
.vitrin-text {
  font-size: 1.34rem;
  font-weight: 900;
  letter-spacing: -.03em;
  background: linear-gradient(90deg,#10b981 0%,#0ea5e9 90%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}
.footer-about {
  color: #1e293b;
  font-size: .97rem;
  margin-bottom: .6rem;
  font-weight: 600;
}
.footer-socials {
  display: flex;
  gap: 0.6rem;
  margin-top: .3rem;
}
.footer-socials a {
  display: inline-flex;
  padding: 0.42rem;
  border-radius: 50%;
  background: #E5ECFB;
  transition: background 0.2s, transform 0.2s;
}
.footer-socials a:hover {
  background: #10b981;
  transform: scale(1.09);
}
.footer-socials svg {
  width: 20px;
  height: 20px;
  fill: #1e293b;
}
.footer-socials a:hover svg {
  fill: #fff;
}
.footer-links {
  flex: 1 1 180px;
}
.footer-links h3, .footer-main-site h3 {
  font-size: 1.08rem;
  font-weight: 700;
  color: #0ea5e9;
  margin-bottom: 0.7rem;
  letter-spacing: -.01em;
}
.footer-links ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
.footer-links li {
  margin-bottom: .46rem;
}
.footer-links a {
  font-size: 1rem;
  color: #334155;
  transition: color 0.17s, transform 0.17s;
  text-decoration: none;
}
.footer-links a:hover {
  color: #10b981;
  transform: translateX(-3px);
}
.footer-main-site {
  flex: 1 1 170px;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: .8rem;
  min-width: 160px;
}
.footer-main-btn {
  background: linear-gradient(90deg, #10b981 60%, #0ea5e9 140%);
  color: #fff;
  border-radius: .83rem;
  font-weight: 700;
  font-size: 1.07rem;
  padding: .77rem 1.85rem;
  border: none;
  box-shadow: 0 1px 7px #7C83FD10;
  cursor: pointer;
  transition: background .15s, box-shadow .13s;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  margin-top: .2rem;
}
.footer-main-btn:hover, .footer-main-btn:focus {
  background: #232946;
  color: #fff;
  outline: none;
}
.footer-bottom {
  text-align: center;
  margin-top: 2rem;
  padding-top: 1rem;
  border-top: 1px solid rgba(16,185,129,0.09);
  font-size: 0.93rem;
  color: #1e293b;
  letter-spacing: -.01em;
}

/* ریسپانسیو قوی */
@media (max-width: 900px) {
  .footer-flex {
    flex-direction: column;
    align-items: stretch;
    gap: 1.7rem;
  }
  .footer-brand-social, .footer-links, .footer-main-site {
    min-width: 0;
    flex: 1 1 100%;
    align-items: flex-start;
  }
  .footer-main-site {
    align-items: flex-start;
  }
}

@media (max-width: 600px) {
  .footer-vitrinnet {
    padding: 1.2rem .7rem .9rem;
    margin-top: 2rem;
    border-radius: .95rem .95rem 0 0;
  }
  .footer-logo svg { width: 28px; height: 28px; }
  .vitrin-text { font-size: 1.03rem; }
  .footer-bottom { font-size: .87rem; }
  .footer-main-btn { font-size: .97rem; padding: .65rem 1.3rem; }
}

@media (max-width: 430px) {
  .footer-logo svg { width: 22px; height: 22px; }
  .vitrin-text { font-size: .85rem; }
  .footer-main-btn { font-size: .89rem; padding: .5rem .8rem;}
}








/* Modern Header */.modern-header {
  background: #fff;
  border-bottom: 1.7px solid #f0f2fa;
  box-shadow: 0 2px 18px #7C83FD0c;
  position: sticky;
  top: 0;
  z-index: 60;
}

.header-row {
  max-width: 1200px;
  margin: 0 auto;
  padding: 1.1rem 1.3rem 1.05rem 1.3rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1.2rem;
}

.logo-mohammady {
  font-family: 'Vazirmatn', 'Montserrat', Arial, sans-serif;
  font-size: 1.65rem;
  font-weight: 900;
  background: linear-gradient(90deg,#5b63df 20%,#7c83fd 60%,#30b88a 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-fill-color: transparent;
  letter-spacing: .01em;
  user-select: none;
  transition: transform .17s;
  direction: ltr;
  white-space: nowrap;
}
.logo-mohammady:hover { transform: scale(1.04); }

.header-middle {
  display: flex;
  align-items: center;
  gap: 2.2rem;
  flex: 1 1 auto;
  justify-content: center;
  min-width: 0;
}

.header-nav {
  display: flex;
  align-items: center;
  gap: 1.2rem;
  font-size: 1.09rem;
  font-weight: 600;
  flex-shrink: 0;
}
.header-nav a, .address-btn {
  color: #232946;
  text-decoration: none;
  background: none;
  border: none;
  font-size: 1.09rem;
  font-weight: 600;
  transition: color .17s, background .18s;
  cursor: pointer;
  padding: .24rem .9rem;
  border-radius: .5rem;
}
.header-nav a:hover, .address-btn:hover, .header-nav a:focus, .address-btn:focus {
  color: #fff;
  background: linear-gradient(93deg,#5b63df 70%,#7C83FD 130%);
  outline: none;
}
.address-btn {
  background: linear-gradient(93deg,#e6fcf5 70%,#e0f7fa 130%);
  color: #0ea5e9;
  font-weight: 900;
}

.header-stats {
  display: flex;
  align-items: center;
  gap: 1.15rem;
  flex-shrink: 0;
}
.header-rating-form {
  display: flex;
  flex-direction: row-reverse;
  align-items: center;
  gap: 2px;
  user-select: none;
  background: #f0f2fd;
  border-radius: .8em;
  padding: 4px 12px;
  font-size: 1.01rem;
  margin-left: .5em;
}
.header-rating-form input[type="radio"] { display: none; }
.header-rating-form label {
  font-size: 1.22rem;
  color: #d1d5db;
  cursor: pointer;
  transition: color 0.17s, transform 0.13s;
  margin-right: 0.08em;
}
.header-rating-form input[type="radio"]:checked ~ label,
.header-rating-form label:hover,
.header-rating-form label:hover ~ label {
  color: #f59e0b;
  transform: scale(1.11);
}
.header-rating-form .current-rating {
  margin-right: .6em;
  color: #f59e0b;
  font-weight: 700;
  font-size: 1em;
}
.header-views {
  display: flex;
  align-items: center;
  gap: .45em;
  font-size: 1em;
  font-weight: 700;
  background: #f0f2fd;
  color: #5b63df;
  padding: 4px 13px;
  border-radius: .8em;
  box-shadow: 0 1px 7px #7C83FD0a;
}
.header-views svg {margin-left: 2px;}
.header-views b {color: #10b981;}
.header-views span {color: #232946;}

.header-logo-vitrin {
  display: flex;
  align-items: center;
  font-size: 1.7rem;
  font-family: 'Vazirmatn', 'Montserrat', Arial, sans-serif;
  font-weight: 900;
  letter-spacing: -.03em;
  background: linear-gradient(90deg,#10b981 0%,#0ea5e9 80%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-fill-color: transparent;
  transition: transform .17s;
  cursor: pointer;
  white-space: nowrap;
}
.header-logo-vitrin .vitrin-text {
  font-size: 1.19em;
  font-weight: inherit;
  font-family: inherit;
  background: none;
  letter-spacing: -.02em;
}
.header-logo-vitrin:hover {transform: scale(1.06);}

@media (max-width: 900px) {
  .header-row {flex-wrap: wrap; gap: 1rem;}
  .header-middle {gap: 1.1rem;}
}
@media (max-width: 700px) {
  .header-row {flex-direction: column; align-items: stretch; gap: .7rem; padding: .7rem .5rem;}
  .header-middle {flex-direction: column; gap: .55rem; width: 100%; align-items: flex-start;}
  .header-logo-vitrin, .logo-mohammady {font-size: 1.15rem;}
  .header-nav {gap: .6rem;}
  .header-stats {gap: .7rem;}
}
@media (max-width: 520px) {
  .header-nav {flex-wrap: wrap; gap: .4rem;}
  .header-middle {gap: .42rem;}
}






.modern-header {
  background: #fff;
  border-bottom: 1.5px solid #f2f4fa;
  box-shadow: 0 1px 13px #7C83FD10;
  position: sticky; top: 0; z-index: 60;
  font-family: 'Vazirmatn', sans-serif;
}
.header-row {
  max-width: 1200px;
  margin: 0 auto;
  padding: .55rem 1rem .45rem 1rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: .6rem;
}
.logo-mohammady {
  font-size: 1.28rem;
  font-weight: 900;
  background: linear-gradient(90deg,#5b63df 20%,#7c83fd 60%,#30b88a 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-fill-color: transparent;
  margin-left: .6rem;
  white-space: nowrap;
}
.header-middle {
  display: flex;
  align-items: center;
  gap: 1.05rem;
  flex: 1 1 auto;
  justify-content: center;
  min-width: 0;
}
.header-nav {
  display: flex;
  align-items: center;
  gap: .95rem;
  font-size: .99rem;
  font-weight: 600;
  flex-shrink: 0;
}
.header-nav a, .address-btn {
  color: #232946;
  text-decoration: none;
  background: none;
  border: none;
  font-size: .99rem;
  font-weight: 600;
  transition: color .17s, background .18s;
  cursor: pointer;
  padding: .13rem .55rem;
  border-radius: .5rem;
}
.header-nav a:hover, .address-btn:hover, .header-nav a:focus, .address-btn:focus {
  color: #fff;
  background: linear-gradient(93deg,#5b63df 70%,#7C83FD 130%);
  outline: none;
}
.address-btn {
  background: linear-gradient(93deg,#e6fcf5 70%,#e0f7fa 130%);
  color: #0ea5e9;
  font-weight: 900;
}
.header-stats {
  display: flex;
  align-items: center;
  gap: .8rem;
  flex-shrink: 0;
}
.header-rating-form {
  display: flex;
  flex-direction: row-reverse;
  align-items: center;
  gap: 2px;
  user-select: none;
  background: #f0f2fd;
  border-radius: .8em;
  padding: 2px 8px;
  font-size: .95rem;
  margin-left: .5em;
}
.header-rating-form input[type="radio"] { display: none; }
.header-rating-form label {
  font-size: 1.1rem;
  color: #d1d5db;
  cursor: pointer;
  transition: color 0.16s, transform 0.12s;
  margin-right: 0.08em;
}
.header-rating-form input[type="radio"]:checked ~ label,
.header-rating-form label:hover,
.header-rating-form label:hover ~ label {
  color: #f59e0b;
  transform: scale(1.11);
}
.header-rating-form .current-rating {
  margin-right: .4em;
  color: #f59e0b;
  font-weight: 700;
  font-size: .96em;
}
.header-views {
  display: flex;
  align-items: center;
  gap: .38em;
  font-size: .97em;
  font-weight: 700;
  background: #f0f2fd;
  color: #5b63df;
  padding: 2px 8px;
  border-radius: .8em;
  box-shadow: 0 1px 7px #7C83FD0a;
}
.header-views svg {margin-left: 2px;}
.header-views b {color: #10b981;}
.header-views span {color: #232946;}
.header-logo-vitrin {
  font-size: 1.23rem;
  font-family: 'Vazirmatn', 'Montserrat', Arial, sans-serif;
  font-weight: 900;
  letter-spacing: -.03em;
  background: linear-gradient(90deg,#10b981 0%,#0ea5e9 80%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-fill-color: transparent;
  transition: transform .16s;
  cursor: pointer;
  white-space: nowrap;
  margin-right: .6rem;
}
.header-logo-vitrin:hover {transform: scale(1.06);}
@media (max-width: 900px) {
  .header-row {flex-wrap: wrap; gap: .6rem;}
  .header-middle {gap: .6rem;}
}
@media (max-width: 700px) {
  .header-row {flex-direction: column; align-items: stretch; gap: .35rem; padding: .45rem .3rem;}
  .header-middle {flex-direction: column; gap: .35rem; width: 100%; align-items: flex-start;}
  .header-logo-vitrin, .logo-mohammady {font-size: .93rem;}
  .header-nav {gap: .41rem;}
  .header-stats {gap: .41rem;}
}
@media (max-width: 500px) {
  .header-nav {flex-wrap: wrap; gap: .18rem;}
  .header-middle {gap: .2rem;}
}
/* پاپ‌آپ */
.address-popup, .rating-popup {
  position: fixed;
  inset: 0;
  background: rgba(44,50,72,0.36);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1300;
  transition: opacity 0.23s;
}
.address-popup.active, .rating-popup.active {
  display: flex;
  animation: popupFadeIn 0.29s;
}
.popup-content {
  background: linear-gradient(135deg, #fff, #f0f4ff 99%);
  border-radius: 1rem;
  padding: 1.5rem 1.1rem 1.1rem 1.1rem;
  min-width: 210px;
  max-width: 93vw;
  text-align: center;
  box-shadow: 0 7px 28px #7C83FD19;
  animation: popupFadeIn .29s;
}
.popup-content svg {margin-bottom: .75rem;}
.popup-content h4 {
  font-size: 1.07rem;
  color: #5B63DF;
  font-weight: 900;
  margin-bottom: .42rem;
  letter-spacing: -.02em;
}
.popup-content p {
  font-size: .97rem;
  color: #232946;
  font-weight: 600;
  margin-bottom: 0.3rem;
  line-height: 2;
}
.popup-close {
  background: linear-gradient(93deg,#7C83FD 80%,#5b63df 150%);
  color: #fff;
  border: none;
  font-size: .92rem;
  font-weight: 700;
  padding: 0.55rem 1.45rem;
  border-radius: 0.6rem;
  margin-top: .6rem;
  cursor: pointer;
  box-shadow: 0 1px 8px #7C83FD13;
  transition: background .13s, box-shadow .13s;
}
.popup-close:hover {background: #232946;}
@keyframes popupFadeIn {
  from { opacity: 0; transform: scale(0.93);}
  to { opacity: 1; transform: scale(1);}
}





.btnbar-product {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: flex-start;
  width: 100%;
  margin-top: 1rem;
}

.btn-main {
  background: linear-gradient(93deg,#5b63df 70%,#7C83FD 130%);
  color: #fff;
  border-radius: .83rem;
  font-weight: 700;
  font-size: 1.09rem;
  padding: .85rem 1.7rem;
  border: none;
  cursor: pointer;
  box-shadow: 0 1px 9px #7C83FD10;
  transition: background .15s, box-shadow .14s, color .13s;
  display: inline-block;
  min-width: 145px;
  text-align: center;
  text-decoration: none;
}

.btn-main:hover, .btn-main:focus {
  background: #232946;
  color: #fff;
  outline: none;
}

.btn-outline {
  background: #fff;
  color: #5b63df;
  border: 1.5px solid #7C83FD;
  box-shadow: 0 1px 9px #7C83FD08;
}

.btn-outline:hover, .btn-outline:focus {
  background: #7C83FD;
  color: #fff;
}

.btn-contact {
  background: linear-gradient(93deg,#30b88a 70%,#5b63df 130%);
}

.btn-contact:hover, .btn-contact:focus {
  background: #30b88a;
  color: #fff;
}

@media (max-width: 700px) {
  .btnbar-product {
    flex-direction: column;
    align-items: stretch;
    gap: 9px;
  }
  .btn-main, .btn-outline, .btn-contact {
    width: 100%;
    min-width: unset;
  }
}











.header-logo-vitrin {
  font-size: 1.37rem;
  font-family: 'Vazirmatn', 'Montserrat', Arial, sans-serif;
  font-weight: 900;
  background: linear-gradient(91deg,#0ea5e9 18%,#10b981 80%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-fill-color: transparent;
  letter-spacing: -.03em;
  transition: transform .17s;
  cursor: pointer;
  padding: 0 .18em;
}
.vitrin-text-fa {
  font-family: 'Vazirmatn', sans-serif;
  font-weight: 900;
  letter-spacing: -.02em;
  font-size: 1.19em;
  background: none;
  color: inherit;
}
.header-logo-vitrin:hover {transform: scale(1.07);}












.header-shop-brand {
  display: flex;
  align-items: center;
  min-width: 0;
}

/* استایل خاص لینک نام فروشگاه */
.brand-link-clean {
  display: inline-block;
  padding: .38em 1.25em;
  border-radius: 1.15em;
  background: linear-gradient(92deg,#f0f7ff 70%,#e8fcf9 100%);
  font-size: 1.12rem;
  font-weight: 900;
  color: #0ea5e9;
  text-decoration: none;
  letter-spacing: -.01em;
  border: 1.5px solid #e0f2ff;
  transition: background .17s, color .15s, box-shadow .17s, transform .16s;
  max-width: 250px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  box-shadow: 0 1px 12px #0ea5e913;
}

.brand-link-clean:hover,
.brand-link-clean:focus {
  background: linear-gradient(91deg,#7c83fd 70%,#5b63df 120%);
  color: #fff;
  box-shadow: 0 4px 22px #7c83fd23;
  outline: none;
  text-decoration: none;
  transform: scale(1.03);
}

.brand-link-clean .dynamic-brand {
  font-size: 1em;
  font-weight: inherit;
  display: inline-block;
  vertical-align: middle;
  white-space: inherit;
  overflow: inherit;
  text-overflow: inherit;
  direction: rtl;
}

/* رسپانسیو قوی */
@media (max-width: 700px) {
  .brand-link-clean {
    font-size: 1.01rem;
    padding: .32em .85em;
    max-width: 160px;
  }
}
@media (max-width: 430px) {
  .brand-link-clean {
    font-size: .96rem;
    padding: .25em .55em;
    max-width: 96px;
  }
}

</style>

<script>
document.addEventListener('DOMContentLoaded', function () {
  // ------------------ پاپ‌آپ آدرس -------------------
  const addressBtn = document.querySelector('.address-btn');
  const addressPopup = document.querySelector('.address-popup');
  const addressClose = document.querySelector('.popup-close-address');
  if (addressBtn && addressPopup && addressClose) {
    addressBtn.addEventListener('click', () => {
      addressPopup.classList.add('active');
      setTimeout(() => {
        const pc = addressPopup.querySelector('.popup-content');
        if(pc) pc.focus();
      }, 80);
    });
    addressClose.addEventListener('click', () => {
      addressPopup.classList.remove('active');
    });
    addressPopup.addEventListener('click', (e) => {
      if (e.target === addressPopup) addressPopup.classList.remove('active');
    });
  }

  // ------------------ پاپ‌آپ امتیاز -------------------
  const ratingForm = document.querySelector('.header-rating-form');
  const ratingLabels = ratingForm ? ratingForm.querySelectorAll('label') : [];
  const ratingPopup = document.querySelector('.rating-popup');
  const ratingClose = document.querySelector('.popup-close-rating');
  let rated = false;
  if (ratingForm && ratingLabels.length && ratingPopup && ratingClose) {
    ratingForm.addEventListener('change', function () {
      if (rated) return;
      const val = Number(ratingForm.hrating.value);
      ratingLabels.forEach((label, i) => {
        label.style.color = 5 - i <= val ? '#f59e0b' : '#d1d5db';
      });
      ratingPopup.classList.add('active');
      rated = true;
      ratingForm.querySelectorAll('input').forEach(inp => inp.disabled = true);
      ratingForm.style.opacity = '0.6';
    });
    // افکت هاور ستاره‌ها
    ratingLabels.forEach(label => {
      label.addEventListener('mouseenter', function () {
        if (rated) return;
        const val = Number(this.previousElementSibling.value);
        ratingLabels.forEach((l, i) => {
          l.style.color = 5 - i <= val ? '#f59e0b' : '#d1d5db';
        });
      });
      label.addEventListener('mouseleave', function () {
        if (rated) return;
        ratingLabels.forEach(l => l.style.color = '#d1d5db');
      });
    });
    // بستن پاپ‌آپ امتیاز
    ratingClose.addEventListener('click', () => {
      ratingPopup.classList.remove('active');
    });
    ratingPopup.addEventListener('click', (e) => {
      if (e.target === ratingPopup) ratingPopup.classList.remove('active');
    });
  }

  // ------------------ بستن با ESC برای هر دو -------------------
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      if (addressPopup && addressPopup.classList.contains('active')) addressPopup.classList.remove('active');
      if (ratingPopup && ratingPopup.classList.contains('active')) ratingPopup.classList.remove('active');
    }
  });
});

document.addEventListener('DOMContentLoaded', function () {
  // اسکریپت عوض کردن تصویر اصلی با کلیک روی تامب‌نیل‌ها
  const mainImage = document.getElementById('mainImage');
  const thumbs = document.querySelectorAll('.thumbimg');
  thumbs.forEach(thumb => {
    thumb.addEventListener('click', function() {
      thumbs.forEach(t => t.classList.remove('active'));
      this.classList.add('active');
      mainImage.src = this.src;
      mainImage.alt = this.alt;
    });
  });
});
</script>


<script>
function getProductIdFromURL() {
  const params = new URLSearchParams(window.location.search);
  return params.get('id');
}

function toPersianPrice(num) {
  if (!num) return '';
  return Number(num).toLocaleString('fa-IR');
}

async function getShopAppearance(sellerId) {
  if (!sellerId) return null;
  try {
    const res = await fetch(`http://localhost:5000/api/shopAppearance/${sellerId}`);
    if (!res.ok) return null;
    return await res.json();
  } catch {
    return null;
  }
}

async function getSellerInfo(sellerId) {
  if (!sellerId) return null;
  try {
    const res = await fetch(`http://localhost:5000/api/sellers/${sellerId}`);
    if (!res.ok) return null;
    return await res.json();
  } catch {
    return null;
  }
}

async function getProduct(productId) {
  if (!productId) return null;
  try {
    const res = await fetch(`http://localhost:5000/api/products/${productId}`);
    if (!res.ok) return null;
    return await res.json();
  } catch {
    return null;
  }
}

async function loadProductAndSeller() {
  const productId = getProductIdFromURL();
  console.log('🧪 loadProductAndSeller اجرا شد ✅');
console.log('🔎 productId from URL:', productId);


  
  // المنت‌های مورد نیاز
  const titleEl     = document.querySelector('.product-title');
  const descEl      = document.querySelector('.product-desc');
  const mainImgWrap = document.querySelector('.mainimg-wrap');
  const thumbBar    = document.querySelector('.thumbbar');
  const featList    = document.querySelector('.feat-list');
  const btnBar      = document.querySelector('.btnbar-product');
  const priceBadge  = document.querySelector('.price-badge');
  const stockBadge  = document.querySelector('.stock-badge');
  const brandEl     = document.querySelector('.dynamic-brand');
  const brandLink   = document.querySelector('.dynamic-brand-link');
  const addressEls  = document.querySelectorAll('.dynamic-address');
  const phoneBtns   = document.querySelectorAll('.btn-contact');
  const shopLinkDynamic = document.querySelector('.shop-link-dynamic'); // لینک فروشگاه در nav

  let product = null;
  let seller = null;
  let shopAppearance = null;

  // اگر productId وجود داره، دیتاها رو از API بگیر
  if (productId) {
    product = await getProduct(productId);
    if (product && product.sellerId) {
      seller = await getSellerInfo(product.sellerId) || {};
      shopAppearance = await getShopAppearance(product.sellerId) || {};
    }
  }

  // اگر دیتا ناقص بود یا محصولی نبود، مقدار دمو
  if (!product) {
    product = {
      title: "کیف زنانه مینیمال شیک",
      desc: "کیف زنانه خاص با طراحی ساده، مدرن و مینیمال. ساخته شده از چرم مصنوعی با کیفیت و ضدآب، سبک و جادار، مناسب برای استایل روزمره و رسمی بانوان شیک‌پوش.",
      images: [
        "https://images.unsplash.com/photo-1503342452485-86a096e79bba?auto=format&fit=crop&w=800&q=80&format=webp",
        "https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=800&q=80&format=webp",
        "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=800&q=80&format=webp"
      ],
      price: 1850000,
      badge: "موجود",
      tags: [
        "جنس بدنه: چرم مصنوعی مقاوم و قابل شستشو",
        "ابعاد: ۲۵ × ۱۹ × ۹ سانتی‌متر",
        "وزن: ۴۴۰ گرم",
        "رنگ: بژ (قابل سفارش: مشکی، کرم، آبی)",
        "۲ جیب داخلی و ۱ جیب زیپی خارجی",
        "ضمانت بازگشت ۷ روزه"
      ],
      sellerId: "683e908dc5c8523f1e1ce8a1",
      site: "https://digikala.com/product/xyz" // آدرس محصول دمو
    };
    seller = {
      shopurl: "mobforoshi",
      site: "https://digikala.com/product/xyz",
      phone: "09123456789"
    };
    shopAppearance = {
      shopLogoText: "فروشگاه دمو",
      shopAddress: "آدرس تست: تهران",
      customUrl: "demoShop"
    };
  }

  // عکس‌ها و تامب‌نیل
  let mainImage = (product.images && product.images[0]) ? product.images[0] : 'assets/images/no-image.png';
  let thumbs = '';
  if (product.images && product.images.length > 0) {
    thumbs = product.images.map((img, i) =>
      `<img class="thumbimg${i == 0 ? ' active' : ''}" src="${img}" alt="${product.title || ''}">`
    ).join('');
  } else {
    thumbs = `<img class="thumbimg active" src="assets/images/no-image.png" alt="بدون تصویر">`;
  }
  mainImgWrap.innerHTML = `<img id="mainImage" src="${mainImage}" alt="${product.title || ''}">`;
  thumbBar.innerHTML = thumbs;

  // سوییچ عکس اصلی با کلیک روی تامب‌نیل
  const mainImgTag = document.getElementById('mainImage');
  document.querySelectorAll('.thumbimg').forEach(thumb => {
    thumb.addEventListener('click', function () {
      document.querySelectorAll('.thumbimg').forEach(t => t.classList.remove('active'));
      this.classList.add('active');
      mainImgTag.src = this.src;
      mainImgTag.alt = this.alt;
    });
  });

// عنوان، قیمت، وضعیت و توضیح
titleEl.innerText = product.title || '-';
const sellerIdInput = document.getElementById('sellerId');
if (sellerIdInput) {
  const sellerIdStr =
    // اگر sellerId یک آبجکت Populate شده باشد
    (typeof product.sellerId === 'object' && product.sellerId !== null)
      ? (product.sellerId._id || product.sellerId.toString())  // از _id یا به‌طور کلی رشته‌اش استفاده کن
      : product.sellerId;  // در غیر این صورت همان رشتهٔ ObjectId را بگذار
  sellerIdInput.value = sellerIdStr || '';  // مطمئن شو که مقدار درستی می‌گذاریم
}


 // === مقداردهی فیلد مخفی productId از خودِ شیء محصول ===
 const productIdInput = document.getElementById('productId');
 if (productIdInput && product && product._id) {
   productIdInput.value = product._id;
 }


  priceBadge.innerHTML = `${toPersianPrice(product.price)} <span class="text-lg font-bold align-middle mr-1">تومان</span>`;
  stockBadge.innerText = product.badge || "موجود";
  descEl.innerText = product.desc || '';

  // ویژگی‌ها
  let feat = '';
  if (product.tags && product.tags.length) {
    feat = product.tags.map(t => `<li>${t}</li>`).join('');
  } else {
    feat = '<li>بدون ویژگی خاص</li>';
  }
  featList.innerHTML = feat;



  
  // دکمه‌ها (دکمه مشاهده در سایت فروشنده دقیقا به صفحه همون محصول میره)
// === مقداردهی و مدیریت دکمه علاقه‌مندی، فروشنده، فرم تماس ===

// دکمه "مشاهده در سایت فروشنده"
// دکمه "مشاهده در سایت فروشنده"
// دکمه مشاهده در سایت فروشنده - همیشه نمایش داده شود

// ابتدا آدرس سایت فروشنده را می‌گیریم، اگر آدرسی برای محصول یا فروشنده وجود داشته باشد
// دکمه مشاهده در سایت فروشنده – فقط با URL خود محصول/فروشنده
// seller همون آبجکتیه که از دیتابیس گرفتی

// فرض کن اینجا seller مقدار داره و customUrl هم هست (از دیتابیس گرفتی)
const sellerSiteBtn = document.querySelector('.btn-seller-site');
const baseSellerUrl = "http://localhost:5000/shop.html?shopurl=";




// فرض: sellerId رو داری (مثلا از product.sellerId یا هر جای دیگه)
async function setSellerSiteBtn(sellerId) {
  // لاگ برای عیب‌یابی
  console.log('------ SELLER DEBUG ------');
  console.log('sellerId:', sellerId);

  let customUrl = null;
  try {
    const res = await fetch(`http://localhost:5000/api/shopAppearance/${sellerId}`);
    if (res.ok) {
      const shopData = await res.json();
      customUrl = shopData?.customUrl;
      console.log('shopAppearance.customUrl:', customUrl);
    } else {
      console.warn('shopAppearance not found');
    }
  } catch (err) {
    console.error('fetch error:', err);
  }
  console.log('--------------------------');

  if (sellerSiteBtn) {
    if (
      customUrl &&
      typeof customUrl === "string" &&
      customUrl.trim().length > 0
    ) {
      sellerSiteBtn.href = baseSellerUrl + encodeURIComponent(customUrl.trim());
      sellerSiteBtn.target = "_blank";
      sellerSiteBtn.rel = "noopener";
      sellerSiteBtn.classList.remove("disabled");
      sellerSiteBtn.removeAttribute("aria-disabled");
      sellerSiteBtn.onclick = null;
    } else {
      sellerSiteBtn.href = "#";
      sellerSiteBtn.classList.add("disabled");
      sellerSiteBtn.setAttribute("aria-disabled", "true");
      sellerSiteBtn.onclick = function(e) {
        e.preventDefault();
        alert("آدرس صفحه فروشنده موجود نیست!");
      };
    }
    sellerSiteBtn.style.display = "";
  }
}

// حتما sellerId واقعی رو اینجا پاس بده
setSellerSiteBtn(product?.sellerId);




















  // ==== فقط یک بار اسم فروشگاه (به صورت لینک) در هدر سمت راست ====
  let shopBrand   = shopAppearance?.shopLogoText || '';
  let urlKey      = seller.shopurl || shopAppearance?.customUrl || '';
  let baseUrl     = "http://localhost:5000/shop.html?shopurl=";
  let finalUrl    = urlKey ? baseUrl + encodeURIComponent(urlKey) : "#";
  let shopAddress = shopAppearance?.shopAddress || '';

  // مقداردهی به لینک برند و متن داخلش (فقط یک لینک برند، لوگو لازم نیست)
  if (brandLink && brandEl) {
    if (shopBrand) {
      brandEl.innerText = shopBrand;
      brandLink.href    = finalUrl;
      brandLink.style.display = '';
    } else {
      brandEl.innerText = '';
      brandLink.href    = '#';
      brandLink.style.display = 'none';
    }
  }

  // مقداردهی به لینک فروشگاه وسط nav (دقیقا مثل لوگو سمت راست)
  if (shopLinkDynamic) {
    if (urlKey) {
      shopLinkDynamic.href = finalUrl;
      shopLinkDynamic.target = "_blank";
      shopLinkDynamic.rel = "noopener";
      shopLinkDynamic.style.display = "";
    } else {
      shopLinkDynamic.href = "#";
      shopLinkDynamic.style.display = "none";
    }
  }

  // آدرس فروشگاه
  addressEls.forEach(el => {
    if (shopAddress) {
      el.innerText = shopAddress;
      el.style.display = '';
    } else {
      el.innerText = '';
      el.style.display = 'none';
    }
  });

  // تلفن فقط اگر seller.phone بود و shopBrand هم بود
  phoneBtns.forEach(el => {
    if (seller.phone && shopBrand) {
      el.href = "tel:" + seller.phone;
      el.title = "تماس با " + shopBrand;
      el.style.display = '';
    } else {
      el.href = "#";
      el.title = "";
      el.style.display = 'none';
    }
  });
}

document.addEventListener('DOMContentLoaded', loadProductAndSeller);





// اجرا پس از لود
// ===== زکی: مدیریت داینامیک لاگین و علاقه‌مندی =====

// چک وضعیت لاگین
// چک وضعیت لاگین
// بررسی لاگین (واقعی: مثلا کوکی یا توکن سمت سرور. الان فقط لوکال استوریج)
// بررسی لاگین (واقعی: مثلا کوکی یا توکن سمت سرور. الان فقط لوکال استوریج)
// چک وضعیت لاگین (واقعی: مثلا کوکی یا توکن سمت سرور. الان فقط لوکال استوریج)
// حذف این (قدیمی و فقط لوکال استوریج)
// function isUserLoggedIn() { ... }

// گرفتن اطلاعات پروفایل کاربر از بک‌اند (فعلا لازم نیست اما آماده گذاشتم)
// گرفتن پروفایل کاربر از سرور
// ==================== مدیریت کامل لاگین و دکمه علاقه‌مندی ====================

// چک پروفایل از سرور (در صورت نیاز گرفتن اطلاعات)
// --- چک پروفایل کاربر (JWT در LocalStorage) ---
async function fetchUserProfile() {
  const token = localStorage.getItem('user_token');
  if (!token) return null;
  try {
    const res = await fetch('/api/user/profile', {
      headers: { 'Authorization': 'Bearer ' + token }
    });
    if (!res.ok) return null;
    return await res.json();
  } catch { return null; }
}

// --- چک لاگین: اول کاربر (JWT در هدر)، بعد فروشنده (JWT در کوکی) ---
async function isUserLoggedIn() {
  // کاربر
  const token = localStorage.getItem('user_token');
  if (token) {
    try {
      const res = await fetch('/api/user/profile', {
        headers: { 'Authorization': 'Bearer ' + token }
      });
      if (res.ok) return true;
    } catch {}
  }
  // فروشنده (با کوکی)
  try {
    const res = await fetch('/api/seller/profile', { credentials: 'include' });
    if (res.ok) return true;
  } catch {}
  return false;
}

// --- رندر جعبه ورود یا پروفایل در هدر ---
async function renderUserAuthBox() {
  const box = document.getElementById('headerUserAuth');
  if (!box) return;
  box.innerHTML = '';

  if (await isUserLoggedIn()) {
    box.innerHTML = `
      <a href="/user/dashboard.html" aria-label="حساب کاربری" class="profile-icon-link" tabindex="0"
         style="display:inline-flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:50%;background:linear-gradient(93deg,#f0f3ff 80%,#e5e9fd 130%);box-shadow:0 2px 14px #7C83FD19;transition:box-shadow .16s, background .16s, border .16s;border:2.1px solid #e0e4fb;cursor:pointer;outline:none;text-decoration:none;margin:0 6px;">
        <svg width="26" height="26" viewBox="0 0 24 24" fill="none"
          stroke="#5b63df" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"
          style="display:block;filter:drop-shadow(0 1px 6px #7C83FD14);">
          <path d="M16.5 19.5v-1A4.5 4.5 0 0 0 12 14a4.5 4.5 0 0 0-4.5 4.5v1"/>
          <circle cx="12" cy="9" r="4"/>
        </svg>
      </a>
      <style>
        .profile-icon-link:hover, .profile-icon-link:focus {
          background:linear-gradient(90deg,#7C83FD 55%,#5b63df 120%);
          border:2.1px solid #5b63df;
          box-shadow:0 4px 18px #5b63df1c;
        }
        .profile-icon-link:hover svg, .profile-icon-link:focus svg {
          stroke: #fff;
        }
      </style>
    `;
  } else {
    const currentPage = window.location.pathname + window.location.search;
    box.innerHTML = `
      <a href="/login.html?redirect=${encodeURIComponent(currentPage)}"
         style="font-size:1.05rem;color:#fff;font-weight:700;background:linear-gradient(93deg,#5b63df 80%,#7C83FD 150%);padding:.5em 1.6em;border-radius:1.1em;text-decoration:none;box-shadow:0 1px 9px #7C83FD14;transition:.14s;">
         ورود / ثبت‌نام
      </a>
    `;
  }
}

// --- مدیریت دکمه علاقه‌مندی (JWT هدر یا کوکی) ---
function setupFavBtn() {
  const favBtn = document.querySelector('.btn-fav');
  if (!favBtn) return;

  favBtn.disabled = false;
  favBtn.innerText = 'افزودن به علاقه‌مندی';
  favBtn.style.opacity = 1;

  favBtn.onclick = async function () {
    // اگر لاگین نیست پاپ‌آپ ورود نشون بده
    if (!(await isUserLoggedIn())) {
      showLoginAlertPopup();
      return;
    }

    const productId = getProductIdFromURL();
    if (!productId) {
      alert("محصول پیدا نشد!");
      return;
    }

    favBtn.disabled = true;
    favBtn.innerText = 'در حال افزودن...';
    favBtn.style.opacity = 0.7;

    let fetchOptions = {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ productId })
    };

    // اگر کاربر JWT داره، توکن بذار تو هدر
    const token = localStorage.getItem('user_token');
    if (token) {
      fetchOptions.headers['Authorization'] = 'Bearer ' + token;
    } else {
      // فروشنده: کوکی رو بفرست
      fetchOptions.credentials = 'include';
    }

    try {
      const res = await fetch('http://localhost:5000/api/user/favorites', fetchOptions);
      if (res.ok) {
        favBtn.innerText = 'به علاقه‌مندی‌ها افزوده شد!';
      } else if (res.status === 409) {
        favBtn.innerText = 'قبلاً افزوده شده!';
      } else if (res.status === 401) {
        showLoginAlertPopup();
      } else {
        throw new Error('خطا در افزودن');
      }
    } catch (err) {
      favBtn.innerText = 'خطا!';
      alert("خطایی رخ داد، مجدد تلاش کنید.");
      favBtn.disabled = false;
      favBtn.style.opacity = 1;
    }
  };

  // پاپ‌آپ هشدار ورود
  function showLoginAlertPopup() {
    const popup = document.getElementById('loginAlertPopup');
    const goLoginBtn = document.getElementById('goLoginBtn');
    const closeBtn = document.getElementById('closeLoginAlertBtn');
    if (!popup || !goLoginBtn || !closeBtn) return;

    const currentPage = window.location.pathname + window.location.search;
    goLoginBtn.href = '/login.html?redirect=' + encodeURIComponent(currentPage);

    popup.style.display = 'flex';

    closeBtn.onclick = function() { popup.style.display = 'none'; };
    popup.onclick = function(e) {
      if (e.target === popup) popup.style.display = 'none';
    };
    document.addEventListener('keydown', function esc(e) {
      if (e.key === 'Escape') {
        popup.style.display = 'none';
        document.removeEventListener('keydown', esc);
      }
    });
  }
}

// --- اجرا بعد از لود ---
document.addEventListener('DOMContentLoaded', async function () {
  // ریدایرکت بعد لاگین (redirect رو حذف کن)
  const urlParams = new URLSearchParams(window.location.search);
  if (urlParams.get('redirect')) {
    setTimeout(() => {
      urlParams.delete('redirect');
      window.location.replace(window.location.pathname + (urlParams.toString() ? '?' + urlParams.toString() : ''));
    }, 100);
    return;
  }
  await renderUserAuthBox();
  setupFavBtn();
});









document.addEventListener('DOMContentLoaded', function() {
  const contactBtn    = document.getElementById('contactSellerBtn');
  const contactForm   = document.getElementById('contactForm');
  const sendBtn       = document.getElementById('sendMessageBtn');
  const closeBtn      = document.getElementById('closeFormBtn');
  const messageInput  = document.getElementById('message');
  const sellerIdInput = document.getElementById('sellerId');

  // باز کردن فرم تماس
  contactBtn.style.display = '';
  contactBtn.removeAttribute('href');
  contactBtn.addEventListener('click', function(e) {
    e.preventDefault();
    contactForm.style.display = '';
    contactBtn.style.display  = 'none';
    messageInput.value        = '';
    messageInput.focus();
  });

  // بستن فرم
  closeBtn.addEventListener('click', function() {
    contactForm.style.display = 'none';
    contactBtn.style.display  = '';
  });

  // بررسی لاگین (یا کاربر، یا فروشنده)
  async function ensureLoggedIn() {
    // اول چک کاربر JWT
    const token = localStorage.getItem('user_token');
    if (token) {
      try {
        const res = await fetch('/api/user/profile', {
          headers: { 'Authorization': 'Bearer ' + token }
        });
        if (res.ok) return { type: 'user', token };
      } catch {}
    }
    // بعد چک کوکی فروشنده
    try {
      const res2 = await fetch('/api/seller/profile', {
        credentials: 'include'
      });
      if (res2.ok) return { type: 'seller' };
    } catch {}
    return null;
  }

  // ارسال پیام
// ارسال پیام
sendBtn.addEventListener('click', async function() {
  const text = messageInput.value.trim();
  if (!text) {
    alert('متن پیام را وارد کنید.');
    messageInput.focus();
    return;
  }

  // بررسی لاگین و گرفتن آیدی‌ها...
  const productId = document.getElementById('productId').value;
  const sellerId  = document.getElementById('sellerId').value;
  const user      = await ensureLoggedIn();
  if (!user) {
    alert('برای ارسال پیام باید وارد شوید.');
    window.location.href = '/login.html?redirect=' + encodeURIComponent(window.location.href);
    return;
  }

  // هدرها
  const headers = { 'Content-Type': 'application/json' };
  if (user.type === 'user') headers.Authorization = 'Bearer ' + user.token;

  try {
    const res = await fetch('/api/chats', {
      method: 'POST',
      credentials: 'include',
      headers: headers,
      body: JSON.stringify({
        sellerId:      sellerId,
        productId:     productId,
        recipientRole: 'seller',
        text:          text
      })
    });

    if (res.ok) {
      alert('پیام شما با موفقیت ارسال شد.');
      contactForm.style.display = 'none';
      contactBtn.style.display  = '';
    } else if (res.status === 401) {
      alert('برای ارسال پیام باید وارد شوید.');
      window.location.href = '/login.html?redirect=' + encodeURIComponent(window.location.href);
    } else {
      const err = await res.json().catch(() => ({}));
      alert(err.error || 'خطا در ارسال پیام.');
    }
  } catch {
    alert('خطا در ارسال پیام.');
  }
});

  // بستن فرم با کلید ESC
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && contactForm.style.display !== 'none') {
      contactForm.style.display = 'none';
      contactBtn.style.display  = '';
    }
  });
});



</script>


















<!-- پاپ‌آپ هشدار ورود -->
<div id="loginAlertPopup" class="custom-popup-overlay" style="display:none;">
  <div class="custom-popup-content">
    <h3 style="color:#5b63df;margin-bottom:10px;font-size:1.08rem;">ورود لازم است</h3>
    <p style="font-size:1.01rem;">برای افزودن این محصول به علاقه‌مندی‌ها باید وارد حساب کاربری خود شوید.</p>
    <div style="margin-top:16px;">
      <a id="goLoginBtn" href="#" style="background:linear-gradient(93deg,#5b63df 80%,#7C83FD 150%);color:#fff;padding:9px 2em;border-radius:1em;text-decoration:none;font-weight:700;transition:.15s;font-size:1.03rem;">ورود / ثبت‌نام</a>
      <button id="closeLoginAlertBtn" style="margin-right:9px;background:#fff;color:#5b63df;border:1.1px solid #7C83FD;padding:9px 1.5em;border-radius:1em;font-weight:700;cursor:pointer;">بستن</button>
    </div>
  </div>
</div>
<style>
.custom-popup-overlay {
  position: fixed; inset: 0; z-index: 2000;
  background: rgba(30,41,59,.23);
  display: flex; align-items: center; justify-content: center;
  transition: opacity .16s;
}
.custom-popup-content {
  background: #fff;
  padding: 2.1rem 1.7rem 1.3rem 1.7rem;
  border-radius: 1.15em;
  box-shadow: 0 7px 32px #7C83FD22;
  text-align: center;
  min-width: 230px;
  max-width: 93vw;
  animation: popupFadeIn .24s;
}
@keyframes popupFadeIn {from{opacity:0;transform:scale(.93);}to{opacity:1;transform:scale(1);}}
</style>






</body>
</html>
