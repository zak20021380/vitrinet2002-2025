<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net data:; connect-src 'self' https://cdn.jsdelivr.net; img-src 'self' data:; base-uri 'self'; form-action 'self'; upgrade-insecure-requests; block-all-mixed-content">
<meta http-equiv="Strict-Transport-Security" content="max-age=63072000; includeSubDomains; preload">
<meta http-equiv="Referrer-Policy" content="no-referrer">
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-XSS-Protection" content="1; mode=block">
<meta name="referrer" content="no-referrer">
<meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">
  <script>
    window.__ENV__ = Object.assign({
      isProd: location.hostname.endsWith("{{DOMAIN}}"),
      analyticsEnabled: true
    }, window.__ENV__ || {});
    window.__CONSENT__ = Object.assign({ analytics: true }, window.__CONSENT__ || {});
    window.__ANALYTICS_CONFIG__ = Object.assign({
      PRODUCTION_DOMAIN: "{{DOMAIN}}",
      GTM_ID: "{{GTM_ID}}",
      GA4_ID: "{{GA4_ID}}",
      POSTHOG_HOST: "{{POSTHOG_HOST}}",
      POSTHOG_KEY: "{{POSTHOG_KEY}}",
      PLAUSIBLE_DOMAIN: "{{PLAUSIBLE_DOMAIN}}"
    }, window.__ANALYTICS_CONFIG__ || {});
  </script>
  <script src="/js/analytics.js" defer></script>
  <script src="/js/admin-dashboard.js" defer></script>
  <meta charset="UTF-8">
  <title>داشبورد مدیریت | ویترینت</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="dashboard.css">
  <script src="/nav-active.js" defer></script>

<!-- TODO: فعال‌سازی پست‌هاگ را هنگام انتشار فراموش نکنید | TODO: Enable PostHog analytics when going live -->
<!--
<script>
  (function () {
    var config = window.POSTHOG_CONFIG || { enabled: false, apiKey: 'phc_YOUR_KEY_HERE', apiHost: 'https://analytics.vitreenet.ir' };
    if (!config.enabled) {
      return; // فعال نیست | Not enabled yet
    }
    try {
      (function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")),p.type="text/javascript",p.async=!0,p.src=s.api_host+"/static/array.js";(r=t.getElementsByTagName("script")[0]),r.parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:u=e,u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==u._i&&(e+="."+u._i),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"};n="capture identify alias people.set people.set_once people.unset people.increment people.append people.union people.remove people.clear_opt_out_outcome register register_once unregister opt_out_capturing opt_in_capturing has_opted_out_capturing reset isFeatureEnabled onFeatureFlags reloadFeatureFlags group".split(" ");for(o=0;o<n.length;o++)g(u,n[o]);e._i.push([i,s,a])},e.__SV=1.1)})(document, window.posthog || []);
      window.posthog.init(config.apiKey, { api_host: config.apiHost, capture_pageview: true, advanced_disable_decide: true });
    } catch (error) {
      console.warn('PostHog init failed (preview mode):', error);
    }
  })();
</script>
-->

</head>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
      <div class="sidebar-header">ویترینت</div>
      <div class="sidebar-menu">
        <a href="#" class="active" data-section="dashboard"><i class="ri-dashboard-line"></i> داشبورد</a>
        <a href="#" data-section="rewards"><i class="ri-gift-line"></i> کمپین جوایز <span class="count" id="count-rewards"></span></a>
        <a href="#" data-section="daily-visits"><i class="ri-eye-line"></i> آمار روزانه بازدید</a>
        <a href="#" data-section="users"><i class="ri-user-3-line"></i> کاربران <span class="count" id="count-users">0</span></a>
        <a href="#" data-section="sellers"><i class="ri-store-2-line"></i> فروشنده‌ها <span class="count" id="count-sellers">0</span></a>
        <a href="#" data-section="service-shops"><i class="ri-hand-heart-line"></i> مدیریت مغازه‌های خدماتی <span class="count" id="count-service-shops">0</span></a>
        <a href="#" data-section="service-plan-management"><i class="ri-hand-heart-line"></i> مدیریت پلن‌های خدماتی <span class="count" id="count-service-plans">0</span></a>
        <a href="#" data-section="categories"><i class="ri-folders-line"></i> مدیریت دسته‌بندی‌ها</a>
        <a href="#" data-section="products"><i class="ri-box-3-line"></i> محصولات <span class="count" id="count-products">0</span></a>
        <a href="#" data-section="shopping-centers"><i class="ri-building-2-line"></i> مراکز خرید <span class="count" id="count-shopping-centers">0</span></a>
        <a href="#" data-section="plans"><i class="ri-money-dollar-circle-line"></i> مدیریت قیمت پلن‌ها</a>
        <a href="#" data-section="ads"><i class="ri-megaphone-line"></i> مدیریت قیمت تبلیغات</a>
        <a href="#" data-section="income-insights"><i class="ri-bar-chart-grouped-line"></i> داشبورد درآمدها</a>
        <a href="#" data-section="ad-orders"><i class="ri-advertisement-line"></i> تایید تبلیغات ویژه <span class="count" id="count-ad-orders">0</span></a>
        <a href="#" data-section="home-section"><i class="ri-layout-grid-line"></i> کارت‌های صفحه اصلی</a>
        <a href="#" data-section="messages">
          <i class="ri-chat-1-line"></i> پیام‌ها
          <span class="count" id="count-messages">0</span>
        </a>
<a href="#" data-section="reports"><i class="ri-file-list-line"></i> گزارشات <span class="count" id="count-reports">0</span></a>


      </div>
      <div class="sidebar-footer">
        <span>© 2025 vitrinNet Panel</span>
      </div>
    </nav>
 <!-- Main Content
–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––– -->
<div class="main-content">
  <!-- دکمهٔ باز/بستن سایدبار در موبایل -->
  <button class="sidebar-toggle-btn" id="sidebarToggle">
    <i class="ri-menu-3-line"></i>
  </button>

  <!-- ۱) داشبورد -->
  <div class="section-panel" id="dashboard-panel">
    <div class="content-header">داشبورد آماری</div>
    <div class="cards">
      <div class="card" id="card-visits">
        <span class="icon"><i class="ri-eye-line"></i></span>
        <div><div class="num" id="visit-today">0</div><div class="label">بازدید امروز</div></div>
      </div>
      <div class="card" id="card-users">
        <span class="icon"><i class="ri-user-add-line"></i></span>
        <div><div class="num" id="register-user-today">0</div><div class="label">ثبت‌نام کاربران امروز</div></div>
      </div>
      <div class="card" id="card-sellers">
        <span class="icon"><i class="ri-store-2-line"></i></span>
        <div><div class="num" id="register-seller-today">0</div><div class="label">ثبت‌نام فروشنده امروز</div></div>
      </div>
      <div class="card" id="card-products">
        <span class="icon"><i class="ri-box-3-line"></i></span>
        <div><div class="num" id="products-total">0</div><div class="label">تعداد محصولات</div></div>
      </div>
    </div>
    <div id="dashboard-dynamic-chart-wrap"></div>
  </div>

  <div class="section-panel" id="rewards-panel" style="display:none;">
    <div class="content-header">مدیریت کمپین جوایز</div>
    <div class="reward-admin-layout">
      <section class="reward-admin-card" aria-live="polite">
        <header class="reward-admin-card__header">
          <h3><i class="ri-gift-line" aria-hidden="true"></i> وضعیت کمپین</h3>
          <span class="reward-admin-chip is-inactive" id="rewardCampaignStatusChip">نامشخص</span>
        </header>
        <div class="reward-admin-stats">
          <div class="reward-admin-stat">
            <span class="label">ارزش جایزه</span>
            <span class="value" id="rewardAdminPrizeValue">—</span>
          </div>
          <div class="reward-admin-stat">
            <span class="label">ظرفیت کل</span>
            <span class="value" id="rewardAdminCapacityValue">—</span>
          </div>
          <div class="reward-admin-stat">
            <span class="label">برندگان تاکنون</span>
            <span class="value" id="rewardAdminWinnersValue">—</span>
          </div>
        </div>
        <div class="reward-admin-progress">
          <div class="reward-admin-progress__bar">
            <div class="reward-admin-progress__value" id="rewardAdminProgressBar"></div>
          </div>
          <span class="reward-admin-progress__label" id="rewardAdminProgressLabel">ظرفیت استفاده نشده</span>
        </div>
        <div class="reward-admin-meta">
          <div class="reward-admin-meta__item"><i class="ri-timer-line" aria-hidden="true"></i><span id="rewardAdminUpdatedAt">به‌روزرسانی نشده</span></div>
          <div class="reward-admin-meta__item"><i class="ri-hashtag" aria-hidden="true"></i><span id="rewardAdminCodesCount">۰ کد ذخیره شده</span></div>
        </div>
      </section>

      <form id="rewardCampaignForm" class="reward-admin-form" autocomplete="off">
        <div class="reward-admin-form__group">
          <label for="rewardTitleInput">عنوان کمپین</label>
          <input type="text" id="rewardTitleInput" name="rewardTitle" placeholder="مثلاً هدیه نوروزی مشتریان" required>
        </div>
        <div class="reward-admin-form__group">
          <label for="rewardDescriptionInput">توضیحات کوتاه</label>
          <textarea id="rewardDescriptionInput" name="rewardDescription" rows="3" placeholder="این توضیحات در پاپ‌آپ نمایش داده می‌شود."></textarea>
        </div>
        <div class="reward-admin-form__row">
          <div class="reward-admin-form__group">
            <label for="rewardPrizeInput">ارزش جایزه (تومان)</label>
            <input type="number" id="rewardPrizeInput" name="rewardPrize" min="0" step="100000" required>
          </div>
          <div class="reward-admin-form__group">
            <label for="rewardCurrencyInput">واحد پول</label>
            <input type="text" id="rewardCurrencyInput" name="rewardCurrency" value="تومان">
          </div>
        </div>
        <div class="reward-admin-form__row">
          <div class="reward-admin-form__group">
            <label for="rewardCapacityInput">ظرفیت کل (نفر)</label>
            <input type="number" id="rewardCapacityInput" name="rewardCapacity" min="0" step="1" required>
          </div>
          <div class="reward-admin-form__group">
            <label for="rewardWinnersInput">برندگان تاکنون</label>
            <input type="number" id="rewardWinnersInput" name="rewardWinners" min="0" step="1" required>
          </div>
        </div>
        <div class="reward-admin-form__switch">
          <label class="switch">
            <input type="checkbox" id="rewardActiveInput" name="rewardActive">
            <span class="switch-slider"></span>
          </label>
          <div>
            <strong>کمپین فعال باشد</strong>
            <p>در صورت غیرفعال شدن، پاپ‌آپ به کاربران پیام توقف نمایش می‌دهد.</p>
          </div>
        </div>
        <div class="reward-admin-form__switch">
          <label class="switch">
            <input type="checkbox" id="rewardShowButtonInput" name="rewardShowButton">
            <span class="switch-slider"></span>
          </label>
          <div>
            <strong>نمایش دکمه "دریافت جایزه" در صفحه اصلی</strong>
            <p>با غیرفعال کردن این گزینه، دکمه از هدر صفحه اصلی حذف و فضای آن به طور کامل پاکسازی می‌شود.</p>
          </div>
        </div>
        <div class="reward-admin-form__actions">
          <button type="submit" class="reward-admin-btn primary">ذخیره تنظیمات</button>
          <button type="button" id="rewardResetBtn" class="reward-admin-btn ghost">بازنشانی به پیش‌فرض</button>
        </div>
        <p class="reward-admin-form__message" id="rewardFormMessage" role="status"></p>
      </form>
    </div>

    <section class="reward-winners-manager" aria-label="مدیریت برندگان">
      <header class="reward-winners-manager__header">
        <div>
          <h3><i class="ri-medal-line" aria-hidden="true"></i> ثبت برندگان</h3>
          <p>نام و شماره تماس برندگان را ثبت کنید تا در سایت نمایش داده شود.</p>
        </div>
      </header>
      <form id="rewardWinnerForm" class="reward-winners-form" autocomplete="off">
        <div class="reward-winners-form__row">
          <div class="reward-winners-form__group">
            <label for="rewardWinnerFirstName">نام</label>
            <input type="text" id="rewardWinnerFirstName" name="firstName" placeholder="مثلاً علی" required>
          </div>
          <div class="reward-winners-form__group">
            <label for="rewardWinnerLastName">نام خانوادگی</label>
            <input type="text" id="rewardWinnerLastName" name="lastName" placeholder="مثلاً محمدی" required>
          </div>
          <div class="reward-winners-form__group">
            <label for="rewardWinnerPhone">شماره تلفن</label>
            <input type="tel" id="rewardWinnerPhone" name="phone" inputmode="tel" placeholder="مثلاً 09123456789" required>
          </div>
          <div class="reward-winners-form__group reward-winners-form__group--button">
            <button type="submit" class="reward-admin-btn secondary">ثبت برنده</button>
          </div>
        </div>
      </form>
      <div id="rewardWinnersMessage" class="reward-winners-message" role="status"></div>
      <div id="rewardWinnersList" class="reward-winners-list" role="list"></div>
      <div id="rewardWinnersEmptyState" class="reward-winners-empty" hidden>
        <i class="ri-user-smile-line" aria-hidden="true"></i>
        <p>تا کنون برنده‌ای ثبت نشده است.</p>
      </div>
    </section>

    <section class="reward-code-manager" aria-label="مدیریت کدهای جایزه">
      <header class="reward-code-manager__header">
        <div>
          <h3><i class="ri-shield-star-line" aria-hidden="true"></i> کدهای جایزه</h3>
          <p>کدها را مدیریت کنید و وضعیت استفاده‌شان را تغییر دهید.</p>
        </div>
        <div class="reward-code-manager__badges">
          <span class="reward-code-badge" id="rewardCodesAvailableBadge">۰ کد فعال</span>
          <span class="reward-code-badge reward-code-badge--muted" id="rewardCodesUsedBadge">۰ کد استفاده شده</span>
        </div>
      </header>
      <form id="rewardCodeForm" class="reward-code-form" autocomplete="off">
        <div class="reward-code-form__row">
          <div class="reward-code-form__group">
            <label for="rewardNewCodeInput">کد ۶ رقمی جدید</label>
            <input type="text" id="rewardNewCodeInput" name="rewardCode" inputmode="numeric" pattern="\d{6}" maxlength="6" placeholder="مثلاً 752910" required>
          </div>
          <div class="reward-code-form__group">
            <label for="rewardNewCodeNote">یادداشت (اختیاری)</label>
            <input type="text" id="rewardNewCodeNote" name="rewardNote" placeholder="مثلاً مخصوص فروشگاه‌های منتخب">
          </div>
          <div class="reward-code-form__group reward-code-form__group--button">
            <button type="submit" class="reward-admin-btn secondary">افزودن کد</button>
          </div>
        </div>
      </form>
      <div id="rewardCodesMessage" class="reward-codes-message" role="status"></div>
      <div id="rewardCodesList" class="reward-codes-list" role="list"></div>
      <div id="rewardCodesEmptyState" class="reward-codes-empty" hidden>
        <i class="ri-emotion-unhappy-line" aria-hidden="true"></i>
        <p>هنوز کدی ثبت نشده است. اولین کد را اضافه کنید!</p>
      </div>
    </section>
  </div>

  <!-- پنل جدید برای آمار روزانه بازدید -->
  <div class="section-panel" id="daily-visits-panel" style="display:none;">
    <p style="text-align:center">در حال بارگیری...</p>
  </div>

  <!-- ۲) کاربران -->
<!-- ۲) کاربران -->
<div class="section-panel" id="users-panel" style="display:none;">
  <div class="content-header">کاربران <span class="header-count" id="header-users-count"></span></div>
  <div style="margin-bottom:1rem;display:flex;gap:0.5rem;align-items:center;">
    <input type="text" id="userSearch" placeholder="جستجو نام، نام خانوادگی یا تلفن..." 
           style="width:100%;max-width:400px;padding:0.7rem 1rem;border-radius:12px;border:1.5px solid #10b98144;font-size:1rem;font-family:inherit;outline:none;transition:border .15s;">
  </div>
  <div class="table-wrap">
    <table id="usersTable">
      <thead><tr><th>نام</th><th>ایمیل</th><th>عملیات</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>
</div>

  <!-- ۳) فروشنده‌ها -->
  <div class="section-panel" id="sellers-panel" style="display:none;">
    <div class="content-header">فروشنده‌ها <span class="header-count" id="header-sellers-count"></span></div>
    <div style="margin-bottom:1rem;display:flex;gap:0.5rem;align-items:center;">
  <input type="text" id="sellerSearch" placeholder="جستجو نام فروشگاه، فروشنده یا آدرس..."
         style="width:100%;max-width:400px;padding:0.7rem 1rem;border-radius:12px;border:1.5px solid #10b98144;font-size:1rem;font-family:inherit;outline:none;transition:border .15s;">
</div>
    <div class="sellers-filters" style="display:flex;gap:.7rem;margin-bottom:1.1rem;flex-wrap:wrap;align-items:center;">
      <div style="display:flex;gap:.6rem;flex-wrap:wrap;align-items:center;">
        <button class="seller-filter-btn active" data-sort="newest">جدیدترین</button>
        <button class="seller-filter-btn" data-sort="oldest">قدیمی‌ترین</button>
        <button class="seller-filter-btn" data-sort="mostvisited">پربازدیدترین</button>
        <button class="seller-filter-btn" data-sort="mostproducts">پرمحصول‌ترین</button>
      </div>
      <div class="seller-type-filters" style="display:flex;gap:.5rem;flex-wrap:wrap;align-items:center;">
        <span style="color:#6b7280;font-size:0.95rem;">فیلتر:</span>
        <button class="seller-filter-btn seller-type-btn active" data-filter="all">همه</button>
        <button class="seller-filter-btn seller-type-btn" data-filter="service">فروشنده خدماتی</button>
      </div>
    </div>

    <section class="seller-category-summary" aria-label="تعداد فروشنده در هر دسته">
      <header class="seller-category-summary__header">
        <div>
          <h3>توزیع فروشنده‌ها بر اساس دسته</h3>
          <p>نمایش تعداد فروشندگان ثبت‌شده در هر دسته فعال</p>
        </div>
        <div class="seller-category-summary__total">
          <i class="ri-store-2-line"></i>
          <span>کل فروشندگان:</span>
          <strong id="sellerCategorySummaryTotal">۰</strong>
        </div>
      </header>
      <div class="seller-category-summary__grid" id="sellerCategorySummary"></div>
    </section>

    <div class="table-wrap">
      <table id="sellersTable">
        <thead>
          <tr>
            <th>نام فروشگاه</th><th>نام صاحب فروشگاه</th><th>آدرس فروشگاه</th>
            <th>دسته/زیرگروه</th><th>لینک فروشگاه</th><th>تعداد محصولات</th><th>بازدید</th><th>نمره ادمین</th><th>عملیات</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
  <!-- مدیریت پلن‌های خدماتی -->
  <div class="section-panel" id="service-plan-management-panel" style="display:none;">
    <div class="content-header">
      مدیریت پلن‌های خدماتی
      <span class="header-count" id="header-service-plans-count"></span>
    </div>

    <div class="service-plan-overview" aria-label="راهنمای سریع مدیریت پلن">
      <div class="service-plan-overview__item">
        <i class="ri-edit-2-line" aria-hidden="true"></i>
        <div>
          <strong>اطلاعات اصلی را وارد کنید</strong>
          <p>عنوان، قیمت و مدت پلن تنها فیلدهای ضروری هستند.</p>
        </div>
      </div>
      <div class="service-plan-overview__item">
        <i class="ri-checkbox-circle-line" aria-hidden="true"></i>
        <div>
          <strong>ویژگی‌ها را خلاصه بنویسید</strong>
          <p>هر خط یک ویژگی؛ بعداً هم قابل ویرایش است.</p>
        </div>
      </div>
      <div class="service-plan-overview__item">
        <i class="ri-rocket-line" aria-hidden="true"></i>
        <div>
          <strong>پلن را منتشر کنید</strong>
          <p>پس از ذخیره، از لیست کنار، وضعیت را بررسی کنید.</p>
        </div>
      </div>
    </div>

    <!-- Tab Navigation -->
    <div class="service-plan-tabs" role="tablist">
      <button class="service-plan-tab active" role="tab" aria-selected="true" aria-controls="plan-management-tab" data-tab="plans">
        <i class="ri-stack-line"></i> مدیریت پلن‌ها
      </button>
      <button class="service-plan-tab" role="tab" aria-selected="false" aria-controls="discount-codes-tab" data-tab="discounts">
        <i class="ri-price-tag-3-line"></i> کدهای تخفیف
      </button>
    </div>

    <!-- Tab Content: Plan Management -->
    <div class="service-plan-tab-content active" id="plan-management-tab" role="tabpanel">
      <div class="service-plan-manager">
        <section class="service-plan-form-card" aria-labelledby="servicePlanFormTitle">
          <header class="service-plan-form-header">
            <div>
              <h3 id="servicePlanFormTitle"><i class="ri-edit-2-line"></i> <span id="servicePlanFormMode">ثبت پلن جدید</span></h3>
              <p class="muted">با فیلدهای ضروری شروع کنید و بقیه موارد را بعداً کامل کنید.</p>
            </div>
            <div class="service-plan-form-actions">
              <button type="button" id="servicePlanReset" class="outline"><i class="ri-refresh-line"></i> شروع فرم جدید</button>
            </div>
          </header>
          <form id="servicePlanForm" novalidate>
            <div class="service-plan-section-label">اطلاعات ضروری</div>
            <div class="service-plan-form-grid">
              <div class="service-plan-form-group">
                <label for="servicePlanTitle">عنوان پلن *</label>
                <input type="text" id="servicePlanTitle" name="title" placeholder="مثلاً پلن حرفه‌ای" required />
              </div>
              <div class="service-plan-form-group">
                <label for="servicePlanPrice">قیمت پلن (تومان) *</label>
                <input type="number" id="servicePlanPrice" name="price" min="0" step="1000" placeholder="مثلاً 350000" required />
              </div>
              <div class="service-plan-form-group">
                <label for="servicePlanSlug">اسلاگ یکتا</label>
                <input type="text" id="servicePlanSlug" name="slug" placeholder="به‌صورت خودکار از عنوان ساخته می‌شود" dir="ltr" />
                <span class="form-helper">در صورت نیاز می‌توانید این مقدار را به‌صورت دستی ویرایش کنید.</span>
              </div>
              <div class="service-plan-form-group">
                <label for="servicePlanDuration">مدت اعتبار (روز)</label>
                <input type="number" id="servicePlanDuration" name="durationDays" min="0" step="1" placeholder="مثلاً 30" />
                <span class="form-helper">خالی بماند تا مقدار پیش‌فرض (۳۰ روز) اعمال شود.</span>
              </div>
            </div>
            <div class="service-plan-section-label">جزئیات اختیاری</div>
            <div class="service-plan-form-group full-width">
              <label for="servicePlanDescription">توضیحات کوتاه</label>
              <textarea id="servicePlanDescription" name="description" rows="3" placeholder="این متن در کارت پلن نمایش داده می‌شود."></textarea>
            </div>
            <div class="service-plan-form-group full-width">
              <label for="servicePlanFeatures">ویژگی‌های پلن</label>
              <textarea id="servicePlanFeatures" name="features" rows="4" placeholder="هر ویژگی را در یک خط بنویسید (اختیاری)"></textarea>
            </div>
            <div class="service-plan-form-submit">
              <button type="submit" id="servicePlanSubmit"><i class="ri-save-3-line"></i> ذخیره پلن</button>
            </div>
            <div class="service-plan-message" id="servicePlanMessage" role="status" aria-live="polite" hidden></div>
          </form>
        </section>
        <section class="service-plan-list-card" aria-labelledby="servicePlanListTitle">
          <header class="service-plan-list-header">
            <div>
              <h3 id="servicePlanListTitle"><i class="ri-stack-line"></i> پلن‌های ثبت‌شده</h3>
              <p class="muted">پس از هر ذخیره، وضعیت جدید اینجا نمایش داده می‌شود.</p>
            </div>
            <div class="service-plan-list-actions">
              <button type="button" id="servicePlanRefresh"><i class="ri-refresh-line"></i> بروزرسانی لیست</button>
            </div>
          </header>
          <div class="service-plan-list" id="servicePlansList">
            <div class="service-plan-empty">
              <i class="ri-information-line"></i>
              <p>برای شروع، یک پلن جدید ثبت کنید یا لیست را بروزرسانی نمایید.</p>
            </div>
          </div>
        </section>
      </div>
    </div>

    <!-- Tab Content: Discount Codes -->
    <div class="service-plan-tab-content" id="discount-codes-tab" role="tabpanel" hidden>
      <section class="service-plan-discount-card" aria-labelledby="servicePlanDiscountTitle">
        <header class="service-plan-discount-header">
          <div>
            <h3 id="servicePlanDiscountTitle"><i class="ri-price-tag-3-line"></i> مدیریت کدهای تخفیف</h3>
            <p>کد تخفیف برای پلن‌های خدماتی بسازید، سقف مصرف و تاریخ انقضا تعیین کنید.</p>
          </div>
          <div class="service-plan-discount-actions">
            <button type="button" id="servicePlanCouponRefresh"><i class="ri-refresh-line"></i> بروزرسانی</button>
          </div>
        </header>
        <form id="servicePlanCouponForm" class="service-plan-coupon-form" novalidate>
          <div class="service-plan-coupon-grid">
            <div class="form-group">
              <label for="servicePlanCouponCode">کد تخفیف *</label>
              <input type="text" id="servicePlanCouponCode" name="code" placeholder="مثلاً VITRINET20" inputmode="latin" dir="ltr" required />
              <span class="form-helper">از حروف انگلیسی و اعداد استفاده کنید.</span>
            </div>
            <div class="form-group">
              <label for="servicePlanCouponPercent">درصد تخفیف *</label>
              <div class="input-with-addon">
                <input type="number" id="servicePlanCouponPercent" name="discountPercent" min="1" max="100" step="1" placeholder="10" required />
                <span class="addon">٪</span>
              </div>
            </div>
            <div class="form-group">
              <label for="servicePlanCouponUsage">حداکثر تعداد استفاده</label>
              <input type="number" id="servicePlanCouponUsage" name="maxUsages" min="1" step="1" placeholder="مثلاً 50" />
              <span class="form-helper">خالی بماند تا بدون محدودیت باشد.</span>
            </div>
            <div class="form-group">
              <label for="servicePlanCouponExpiresIn">انقضا پس از</label>
              <div class="input-multi">
                <input type="number" id="servicePlanCouponExpiresIn" name="expiresInValue" min="1" step="1" placeholder="۷" />
                <select id="servicePlanCouponExpiresUnit" name="expiresInUnit">
                  <option value="days" selected>روز</option>
                  <option value="hours">ساعت</option>
                </select>
              </div>
              <span class="form-helper">در صورت نیاز می‌توانید بعداً تاریخ دقیق را تنظیم یا حذف کنید.</span>
            </div>
            <div class="form-group full-width">
              <label for="servicePlanCouponNotes">یادداشت داخلی (اختیاری)</label>
              <textarea id="servicePlanCouponNotes" name="notes" rows="2" placeholder="توضیحات برای تیم پشتیبانی..."></textarea>
            </div>
          </div>
          <div class="service-plan-coupon-actions">
            <button type="submit" id="servicePlanCouponSubmit"><i class="ri-add-circle-line"></i> ذخیره کد تخفیف</button>
          </div>
          <div class="service-plan-coupon-message" id="servicePlanCouponMessage" role="status" aria-live="polite" hidden></div>
        </form>
        <div class="service-plan-coupon-list" id="servicePlanCouponsList" aria-live="polite">
          <div class="service-plan-coupon-empty">
            <i class="ri-ticket-line"></i>
            <p>هنوز هیچ کد تخفیفی ثبت نشده است.</p>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- مدیریت مغازه‌های خدماتی -->
  <div class="section-panel section-panel--service-shops" id="service-shops-panel" style="display:none;">
    <div class="content-header">
      مدیریت مغازه‌های خدماتی
      <span class="header-count" id="header-service-shops-count"></span>
    </div>

    <div class="service-shops-summary service-shops-summary--main" id="serviceShopsSummary">
      <div class="service-summary-card" data-status-filter="all">
        <div class="label">کل مغازه‌ها</div>
        <div class="value" id="serviceShopsTotal">۰</div>
        <div class="hint">مجموع ثبت‌شده در سامانه</div>
      </div>
      <div class="service-summary-card" data-status-filter="approved">
        <div class="label">فعال</div>
        <div class="value" id="serviceShopsActive">۰</div>
        <div class="hint">نمایش در حال انجام</div>
      </div>
      <div class="service-summary-card" data-status-filter="pending">
        <div class="label">در انتظار تایید</div>
        <div class="value" id="serviceShopsPending">۰</div>
        <div class="hint">نیازمند بررسی</div>
      </div>
      <div class="service-summary-card" data-status-filter="suspended">
        <div class="label">معلق</div>
        <div class="value" id="serviceShopsSuspended">۰</div>
        <div class="hint">غیرفعال موقت</div>
      </div>
    </div>

    <div class="service-shops-summary service-shops-summary--secondary">
      <div class="service-summary-card" data-plan-filter="premium">
        <div class="label">پلن پولی فعال</div>
        <div class="value" id="serviceShopsPremium">۰</div>
        <div class="hint">دارای اشتراک پریمیوم</div>
      </div>
      <div class="service-summary-card" data-plan-filter="complimentary">
        <div class="label">پلن رایگان فعال</div>
        <div class="value" id="serviceShopsComplimentary">۰</div>
        <div class="hint">دریافت هدیه از طرف ادمین</div>
      </div>
      <div class="service-summary-card" data-plan-filter="expiring">
        <div class="label">رو به پایان</div>
        <div class="value" id="serviceShopsComplimentarySoon">۰</div>
        <div class="hint">کمتر از ۷ روز آینده</div>
      </div>
      <div class="service-summary-card" data-plan-filter="expired">
        <div class="label">منقضی شده</div>
        <div class="value" id="serviceShopsComplimentaryExpired">۰</div>
        <div class="hint">نیازمند تمدید</div>
      </div>
    </div>

    <div class="service-shops-plan-card" id="serviceShopsPlanCard">
      <div class="service-shops-plan-card__header">
        <div>
          <h3>اعطای پلن رایگان</h3>
          <p>پلن را انتخاب کنید تا روی مغازه‌های انتخابی اعمال شود.</p>
        </div>
        <span class="service-shops-plan-card__chip">هدیه ادمین</span>
      </div>
      <div class="service-shops-plan-card__text">
        <p>پلن انتخاب‌شده با قیمت صفر و از امروز برای مغازه اعمال می‌شود. در صورت نیاز می‌توانید مدت را دستی وارد کنید.</p>
      </div>
      <div class="service-shops-plan-card__list">
        <label for="serviceShopPlanSelect">انتخاب پلن</label>
        <select id="serviceShopPlanSelect">
          <option value="">در حال بارگذاری پلن‌ها...</option>
        </select>
        <label for="serviceShopPlanDuration">مدت (روز)</label>
        <input type="number" id="serviceShopPlanDuration" placeholder="پیش‌فرض مدت پلن" min="1" />
      </div>
      <div class="service-shops-plan-card__actions">
        <button class="service-shops-plan-card__action" id="refreshServiceShops">بروزرسانی لیست</button>
        <button class="service-shops-plan-card__action service-shops-plan-card__action--secondary" id="refreshServiceShopsOverview">بازخوانی آمار</button>
      </div>
      <p class="service-shops-plan-card__footnote">
        <i class="ri-information-line"></i>
        برای اعمال، روی دکمه «اعطای پلن رایگان» در جدول کلیک کنید.
      </p>
    </div>

    <div class="service-shops-toolbar">
      <div class="service-shops-search">
        <i class="ri-search-line"></i>
        <input type="search" id="serviceShopsSearch" placeholder="جستجو نام مغازه، آدرس یا شماره" aria-label="جستجوی مغازه خدماتی" />
      </div>
      <div class="service-shops-quick" id="serviceShopsQuickFilters">
        <button class="service-quick-filter active" data-filter="all">همه</button>
        <button class="service-quick-filter" data-filter="approved">تایید شده</button>
        <button class="service-quick-filter" data-filter="pending">در انتظار</button>
        <button class="service-quick-filter" data-filter="complimentary">دارای پلن رایگان</button>
      </div>
    </div>

    <div class="table-wrap">
      <table id="serviceShopsTable">
        <thead>
          <tr>
            <th>نام مغازه</th>
            <th>آدرس</th>
            <th>زیرگروه</th>
            <th>وضعیت</th>
            <th>وضعیت پلن</th>
            <th>عملیات</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="service-insights-grid" id="serviceShopsInsights"></div>
  </div>

  <div class="service-shop-modal" id="serviceShopModal" hidden>
    <div class="service-shop-modal__backdrop" data-action="close-service-modal"></div>
    <div class="service-shop-modal__dialog" role="dialog" aria-modal="true" aria-labelledby="serviceShopModalTitle">
      <button class="service-shop-modal__close" type="button" aria-label="بستن" data-action="close-service-modal">
        <i class="ri-close-line" aria-hidden="true"></i>
      </button>
      <header class="service-shop-modal__header">
        <div class="service-shop-modal__title">
          <h3 id="serviceShopModalTitle"></h3>
          <p id="serviceShopModalAddress"></p>
        </div>
        <div class="service-shop-modal__status" id="serviceShopModalStatus"></div>
      </header>
      <div class="service-shop-modal__meta">
        <div class="service-shop-modal__meta-item">
          <span class="label">تعداد نوبت‌ها</span>
          <strong id="serviceShopModalAppointments">—</strong>
        </div>
        <div class="service-shop-modal__meta-item">
          <span class="label">تعداد خدمات</span>
          <strong id="serviceShopModalServices">—</strong>
        </div>
        <div class="service-shop-modal__meta-item">
          <span class="label">نمونه کارها</span>
          <strong id="serviceShopModalPortfolio">—</strong>
        </div>
        <div class="service-shop-modal__meta-item">
          <span class="label">شماره تماس</span>
          <strong id="serviceShopModalPhone">—</strong>
        </div>
      </div>
      <div class="service-shop-modal__plan" id="serviceShopModalPlan"></div>
      <div class="service-shop-modal__footer">
        <button class="service-shop-modal__cta" id="serviceShopModalDisablePlan" type="button">
          <i class="ri-shut-down-line" aria-hidden="true"></i>
          غیرفعال کردن پلن رایگان
        </button>
        <a class="service-shop-modal__link" id="serviceShopModalPublicLink" href="#" target="_blank" rel="noopener">
          <i class="ri-external-link-line" aria-hidden="true"></i>
          مشاهده پروفایل فروشنده
        </a>
      </div>
    </div>
  </div>

  <!-- ۴) محصولات -->
  <div class="section-panel" id="products-panel" style="display:none;">
    <div class="content-header">محصولات <span class="header-count" id="header-products-count"></span></div>

<!-- جستجوی محصولات -->
<div style="margin-bottom:1rem;display:flex;gap:0.5rem;align-items:center;">
  <input type="text" id="productSearch" placeholder="جستجو نام محصول، فروشنده یا فروشگاه..." 
         style="width:100%;max-width:400px;padding:0.7rem 1rem;border-radius:12px;border:1.5px solid #10b98144;font-size:1rem;font-family:inherit;outline:none;transition:border .15s;">
</div>

<!-- فیلتر مرتب‌سازی محصولات -->
<div class="products-filters" style="display:flex;gap:.7rem;margin-bottom:1.1rem;flex-wrap:wrap">
  <button class="seller-filter-btn active" data-sort="newest">جدیدترین</button>
  <button class="seller-filter-btn" data-sort="oldest">قدیمی‌ترین</button>
</div>

    <div class="table-wrap">
      <table id="productsTable">
    <!-- productsTable – header AFTER the change -->
<thead>
  <tr>
    <th>نام محصول</th>  <!-- ستون جدید برای نام محصول -->
    <th>نام فروشگاه</th>
    <th>نام صاحب فروشگاه</th>
    <th>آدرس فروشگاه</th>
    <th>لینک فروشگاه</th>
    <th>عملیات</th>
  </tr>
</thead>

        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- ۵) مراکز خرید -->
  <div class="section-panel" id="shopping-centers-panel" style="display:none;">
    <div class="content-header">مراکز خرید <span class="header-count" id="header-shopping-centers-count"></span></div>
    <div class="shopping-centers-grid">
      <form id="shoppingCenterForm" class="shopping-center-form" enctype="multipart/form-data">
        <h3>افزودن مرکز خرید جدید</h3>
        <div>
          <label for="shoppingCenterTitle">نام مرکز خرید *</label>
          <input type="text" id="shoppingCenterTitle" name="title" placeholder="مثلاً تاناکورا" required />
        </div>
        <div class="form-row">
          <div>
            <label for="shoppingCenterTag">تگ کوتاه</label>
            <input type="text" id="shoppingCenterTag" name="tag" placeholder="مثلاً محبوب" />
          </div>
          <div>
            <label for="shoppingCenterOrder">ترتیب نمایش</label>
            <input type="number" id="shoppingCenterOrder" name="order" min="0" step="1" placeholder="0" />
          </div>
        </div>
        <div>
          <label for="shoppingCenterLocation">آدرس/موقعیت</label>
          <input type="text" id="shoppingCenterLocation" name="location" placeholder="سنندج، خیابان ..." />
        </div>
        <div class="form-row">
          <div>
            <label for="shoppingCenterHours">ساعات کاری</label>
            <input type="text" id="shoppingCenterHours" name="hours" placeholder="۱۰ الی ۲۲" />
          </div>
          <div>
            <label for="shoppingCenterHolidays">روزهای تعطیل</label>
            <input type="text" id="shoppingCenterHolidays" name="holidays" placeholder="جمعه‌ها" />
          </div>
        </div>
        <div>
          <label for="shoppingCenterDescription">توضیحات</label>
          <textarea id="shoppingCenterDescription" name="description" placeholder="معرفی کوتاه مرکز خرید"></textarea>
        </div>
        <div>
          <label for="shoppingCenterImage">تصویر شاخص *</label>
          <input type="file" id="shoppingCenterImage" name="image" accept="image/*" required />
          <small style="display:block;margin-top:0.4rem;color:#6b7280;font-size:0.78rem;">فرمت JPG یا PNG با حجم حداکثر ۲ مگابایت.</small>
        </div>
        <button type="submit"><i class="ri-add-circle-line" style="margin-left:0.3rem;"></i>افزودن مرکز خرید</button>
        <div id="shoppingCenterFormMessage" style="display:none;font-size:0.85rem;padding:0.65rem 0.9rem;border-radius:12px;"></div>
      </form>
      <div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;flex-wrap:wrap;gap:0.6rem;">
          <div style="font-weight:600;color:#0f9a8b;font-size:0.95rem;">لیست مراکز خرید فعال</div>
          <button type="button" class="shopping-centers-refresh" id="shoppingCentersRefresh">
            <i class="ri-refresh-line"></i>
            بروزرسانی لیست
          </button>
        </div>
        <div id="shoppingCentersCards" class="shopping-centers-cards"></div>
        <div id="shoppingCentersEmpty" class="shopping-centers-empty" style="display:none;">
          هنوز هیچ مرکز خریدی ثبت نشده است.
        </div>
      </div>
    </div>
  </div>

  <!-- مدیریت دسته‌بندی‌ها -->
  <div class="section-panel" id="categories-panel" style="display:none;">
    <div class="content-header">مدیریت حرفه‌ای دسته‌بندی‌ها</div>

    <div class="category-metrics">
      <div class="category-metric-card">
        <span class="metric-label">تعداد دسته‌های فعال</span>
        <span class="metric-value" id="categories-count">0</span>
      </div>
      <div class="category-metric-card">
        <span class="metric-label">زیرگروه‌های خدمات</span>
        <span class="metric-value" id="service-subcategories-count">0</span>
      </div>
      <div class="category-metric-card note">
        <i class="ri-information-line"></i>
        <div>
          <strong>ذخیره‌سازی هوشمند</strong>
          <p>تغییرات دسته‌بندی‌ها بلافاصله ذخیره شده و در پیش‌نمایش فرم ثبت فروشگاه قابل بررسی است.</p>
        </div>
      </div>
    </div>

    <div class="categories-manage-grid">
      <section class="categories-card">
        <div class="categories-card-header">
          <h3>دسته‌بندی‌های اصلی</h3>
          <p>دسته‌های مورد استفاده در فرم ثبت فروشگاه را مدیریت کنید.</p>
        </div>
        <form id="categoryAddForm" class="categories-form" autocomplete="off">
          <label for="categoryNameInput">افزودن دسته جدید</label>
          <div class="categories-form-row">
            <input type="text" id="categoryNameInput" placeholder="مثلاً تعمیرات خانگی" required />
            <button type="submit" class="primary-btn">افزودن</button>
          </div>
        </form>
        <div id="categoryManagerList" class="chip-list" data-empty-label="هنوز دسته‌ای ثبت نشده است."></div>
      </section>

      <section class="categories-card">
        <div class="categories-card-header">
          <h3>زیرگروه‌های محبوب خدمات</h3>
          <p>لیست نمونه‌های پیشنهادی برای دسته «خدمات» که در فرم به‌صورت چیپ نمایش داده می‌شود.</p>
        </div>
        <form id="serviceSubcategoryForm" class="categories-form" autocomplete="off">
          <label for="serviceSubcategoryInput">افزودن زیرگروه جدید</label>
          <label for="serviceSubcategoryParent">انتخاب دسته اصلی</label>
          <select id="serviceSubcategoryParent" required style="margin-bottom:0.75rem;">
            <option value="" disabled selected>ابتدا دسته اصلی را انتخاب کنید</option>
          </select>
          <div class="categories-form-row">
            <input type="text" id="serviceSubcategoryInput" placeholder="مثلاً خدمات نظافت" required />
            <button type="submit" class="primary-btn">افزودن</button>
          </div>
          <small style="display:block;margin-top:0.35rem;color:#6b7280;font-size:0.78rem;">برای ثبت زیرگروه، ابتدا دسته اصلی مرتبط را انتخاب کنید.</small>
        </form>
        <div id="serviceSubcategoryList" class="chip-list" data-empty-label="هنوز زیرگروهی ثبت نشده است."></div>
      </section>

      <section class="categories-card preview-card">
        <div class="categories-card-header">
          <h3>پیش‌نمایش فرم ثبت فروشگاه</h3>
          <p>به‌روزرسانی‌ها در همینجا قابل بررسی هستند.</p>
        </div>
        <div class="preview-field">
          <label>دسته‌بندی</label>
          <select id="categoryPreviewSelect" disabled>
            <option>در حال بارگیری...</option>
          </select>
        </div>
        <div class="preview-field">
          <label>نمونه زیرگروه‌های خدمات</label>
          <div id="servicePreviewChips" class="chip-list preview" data-empty-label="برای نمایش زیرگروه، موردی اضافه کنید."></div>
        </div>
        <div class="preview-note">
          <i class="ri-lightbulb-flash-line"></i>
          <p>پس از تایید نهایی، این داده‌ها را می‌توانید به بک‌اند منتقل کنید تا در تجربه کاربران اعمال شود.</p>
        </div>
      </section>
    </div>

    <div id="categoryManagerFeedback" class="category-feedback" role="status" aria-live="polite"></div>
  </div>

  <!-- ۶) مدیریت قیمت پلن‌ها -->
  <div class="section-panel" id="plans-panel" style="display:none;">
    <div class="content-header">مدیریت قیمت پلن‌ها</div>
    <div class="plans-center" style="flex-direction:column;gap:2.5rem;width:100%;max-width:1000px;">
      <div class="plan-flag-card" id="sellerPlanToggleCard" data-enabled="false">
        <div class="plan-flag-header">
          <div class="plan-flag-copy">
            <h3>نمایش بخش پلن‌ها در پنل فروشنده</h3>
            <p>
              با روشن بودن این گزینه، فروشندگان می‌توانند کارت پلن فعال و صفحه انتخاب پلن را ببینند.
              در صورت غیرفعال‌سازی، لینک پلن‌ها و محتوای مربوطه برای تمام فروشندگان مخفی می‌شود.
            </p>
          </div>
          <div class="plan-flag-switch" aria-live="polite">
            <label class="toggle-switch" for="sellerPlanToggle" aria-label="کنترل نمایش پلن‌ها">
              <input type="checkbox" id="sellerPlanToggle" />
              <span class="slider"></span>
            </label>
            <span class="plan-flag-state status-off" id="sellerPlanToggleStatus" role="status" aria-live="polite">غیرفعال</span>
          </div>
        </div>
        <div class="plan-flag-actions">
          <button type="button" class="flag-save-btn" id="sellerPlanToggleSave">ذخیره وضعیت</button>
          <button type="button" class="flag-refresh-btn" id="sellerPlanToggleRefresh">بروزرسانی وضعیت</button>
        </div>
        <div class="plan-flag-meta" id="sellerPlanToggleMeta">در حال آماده‌سازی اطلاعات...</div>
      </div>
      <form id="plansForm" class="plan-config-form" novalidate>
        <section class="plan-config-target">
          <label for="seller-phone-plans">شماره موبایل فروشنده (اختیاری برای تعریف قیمت و مزایای اختصاصی)</label>
          <div class="plan-config-target__input">
            <input id="seller-phone-plans" type="text" inputmode="numeric" placeholder="مثلاً 09121234567">
            <p class="plan-config-target__hint">اگر این فیلد خالی بماند تغییرات برای تمام فروشندگان اعمال می‌شود.</p>
          </div>
        </section>

        <div class="plan-config-grid">
          <article class="plan-config-card" data-plan-config="1month">
            <header class="plan-config-card__header">
              <div>
                <h3>اشتراک ۱ ماهه</h3>
                <p class="plan-config-card__subtitle">پلن شروع سریع برای فروشندگان تازه‌وارد.</p>
              </div>
              <div class="plan-config-card__meta">
                <span class="plan-config-card__meta-source" data-plan-source="1month">پیش‌فرض سیستم</span>
                <span class="plan-config-card__meta-updated" data-plan-updated="1month">—</span>
              </div>
            </header>
            <div class="plan-config-fields">
              <div class="plan-config-field">
                <label for="plan-1month-title">عنوان نمایش پلن</label>
                <input type="text" id="plan-1month-title" maxlength="120" placeholder="مثلاً اشتراک ۱ ماهه" autocomplete="off">
              </div>
              <div class="plan-config-field plan-config-field--badge">
                <div class="plan-config-badge-header">
                  <label for="plan-1month-badge-label">برچسب ویژه (اختیاری)</label>
                  <div class="plan-config-badge-preview" data-plan-badge-preview="1month">
                    <span class="plan-config-badge-chip" data-plan-badge-chip="1month">پیشنهاد اقتصادی</span>
                    <span class="plan-config-badge-status" data-plan-badge-status="1month">نمایش فعال</span>
                  </div>
                </div>
                <div class="plan-config-badge-controls">
                  <input type="text" id="plan-1month-badge-label" maxlength="60" placeholder="عنوان برچسب روی کارت" autocomplete="off">
                  <div class="plan-config-badge-row">
                    <select id="plan-1month-badge-variant">
                      <option value="emerald">زمردی (سبز)</option>
                      <option value="amber">کهربایی (نارنجی)</option>
                      <option value="sky">آبی (Sky)</option>
                      <option value="violet">بنفش (Violet)</option>
                      <option value="rose">رز (صورتی)</option>
                      <option value="slate">تیره (Slate)</option>
                    </select>
                    <label class="plan-config-badge-toggle" for="plan-1month-badge-visible">
                      <input type="checkbox" id="plan-1month-badge-visible" checked>
                      نمایش برچسب روی کارت
                    </label>
                  </div>
                </div>
              </div>
              <div class="plan-config-field">
                <label for="plan-1month-price">قیمت (تومان)</label>
                <input type="number" id="plan-1month-price" min="1000" step="1000" inputmode="numeric">
              </div>
              <div class="plan-config-field plan-config-field--inline">
                <label for="plan-1month-duration">مدت (روز)</label>
                <input type="number" id="plan-1month-duration" min="1" max="3650" inputmode="numeric">
              </div>
              <div class="plan-config-field">
                <label for="plan-1month-description">توضیح کوتاه</label>
                <textarea id="plan-1month-description" rows="2" placeholder="مثلاً حضور فعال در ویترینت طی یک ماه"></textarea>
              </div>
              <div class="plan-config-field">
                <label for="plan-1month-features">مزایا (هر خط یک مورد)</label>
                <textarea id="plan-1month-features" rows="4" placeholder="نمایش در نتایج جستجو"></textarea>
              </div>
            </div>
          </article>

          <article class="plan-config-card" data-plan-config="3month">
            <header class="plan-config-card__header">
              <div>
                <h3>اشتراک ۳ ماهه</h3>
                <p class="plan-config-card__subtitle">پوشش یک فصل کامل با تمرکز بر رشد پایدار.</p>
              </div>
              <div class="plan-config-card__meta">
                <span class="plan-config-card__meta-source" data-plan-source="3month">پیش‌فرض سیستم</span>
                <span class="plan-config-card__meta-updated" data-plan-updated="3month">—</span>
              </div>
            </header>
            <div class="plan-config-fields">
              <div class="plan-config-field">
                <label for="plan-3month-title">عنوان نمایش پلن</label>
                <input type="text" id="plan-3month-title" maxlength="120" placeholder="مثلاً اشتراک ۳ ماهه" autocomplete="off">
              </div>
              <div class="plan-config-field plan-config-field--badge">
                <div class="plan-config-badge-header">
                  <label for="plan-3month-badge-label">برچسب ویژه (اختیاری)</label>
                  <div class="plan-config-badge-preview" data-plan-badge-preview="3month">
                    <span class="plan-config-badge-chip" data-plan-badge-chip="3month">پیشنهاد محبوب</span>
                    <span class="plan-config-badge-status" data-plan-badge-status="3month">نمایش فعال</span>
                  </div>
                </div>
                <div class="plan-config-badge-controls">
                  <input type="text" id="plan-3month-badge-label" maxlength="60" placeholder="عنوان برچسب روی کارت" autocomplete="off">
                  <div class="plan-config-badge-row">
                    <select id="plan-3month-badge-variant">
                      <option value="emerald">زمردی (سبز)</option>
                      <option value="amber">کهربایی (نارنجی)</option>
                      <option value="sky">آبی (Sky)</option>
                      <option value="violet">بنفش (Violet)</option>
                      <option value="rose">رز (صورتی)</option>
                      <option value="slate">تیره (Slate)</option>
                    </select>
                    <label class="plan-config-badge-toggle" for="plan-3month-badge-visible">
                      <input type="checkbox" id="plan-3month-badge-visible" checked>
                      نمایش برچسب روی کارت
                    </label>
                  </div>
                </div>
              </div>
              <div class="plan-config-field">
                <label for="plan-3month-price">قیمت (تومان)</label>
                <input type="number" id="plan-3month-price" min="1000" step="1000" inputmode="numeric">
              </div>
              <div class="plan-config-field plan-config-field--inline">
                <label for="plan-3month-duration">مدت (روز)</label>
                <input type="number" id="plan-3month-duration" min="1" max="3650" inputmode="numeric">
              </div>
              <div class="plan-config-field">
                <label for="plan-3month-description">توضیح کوتاه</label>
                <textarea id="plan-3month-description" rows="2" placeholder="مثلاً مناسب برای برنامه‌ریزی فصلی"></textarea>
              </div>
              <div class="plan-config-field">
                <label for="plan-3month-features">مزایا (هر خط یک مورد)</label>
                <textarea id="plan-3month-features" rows="4" placeholder="اولویت نمایش در دسته‌بندی‌ها"></textarea>
              </div>
            </div>
          </article>

          <article class="plan-config-card" data-plan-config="12month">
            <header class="plan-config-card__header">
              <div>
                <h3>اشتراک ۱۲ ماهه</h3>
                <p class="plan-config-card__subtitle">راهکار یک‌ساله برای فروشگاه‌های حرفه‌ای.</p>
              </div>
              <div class="plan-config-card__meta">
                <span class="plan-config-card__meta-source" data-plan-source="12month">پیش‌فرض سیستم</span>
                <span class="plan-config-card__meta-updated" data-plan-updated="12month">—</span>
              </div>
            </header>
            <div class="plan-config-fields">
              <div class="plan-config-field">
                <label for="plan-12month-title">عنوان نمایش پلن</label>
                <input type="text" id="plan-12month-title" maxlength="120" placeholder="مثلاً اشتراک ۱۲ ماهه" autocomplete="off">
              </div>
              <div class="plan-config-field plan-config-field--badge">
                <div class="plan-config-badge-header">
                  <label for="plan-12month-badge-label">برچسب ویژه (اختیاری)</label>
                  <div class="plan-config-badge-preview" data-plan-badge-preview="12month">
                    <span class="plan-config-badge-chip" data-plan-badge-chip="12month">بیشترین صرفه‌جویی</span>
                    <span class="plan-config-badge-status" data-plan-badge-status="12month">نمایش فعال</span>
                  </div>
                </div>
                <div class="plan-config-badge-controls">
                  <input type="text" id="plan-12month-badge-label" maxlength="60" placeholder="عنوان برچسب روی کارت" autocomplete="off">
                  <div class="plan-config-badge-row">
                    <select id="plan-12month-badge-variant">
                      <option value="emerald">زمردی (سبز)</option>
                      <option value="amber">کهربایی (نارنجی)</option>
                      <option value="sky">آبی (Sky)</option>
                      <option value="violet">بنفش (Violet)</option>
                      <option value="rose">رز (صورتی)</option>
                      <option value="slate">تیره (Slate)</option>
                    </select>
                    <label class="plan-config-badge-toggle" for="plan-12month-badge-visible">
                      <input type="checkbox" id="plan-12month-badge-visible" checked>
                      نمایش برچسب روی کارت
                    </label>
                  </div>
                </div>
              </div>
              <div class="plan-config-field">
                <label for="plan-12month-price">قیمت (تومان)</label>
                <input type="number" id="plan-12month-price" min="1000" step="1000" inputmode="numeric">
              </div>
              <div class="plan-config-field plan-config-field--inline">
                <label for="plan-12month-duration">مدت (روز)</label>
                <input type="number" id="plan-12month-duration" min="1" max="3650" inputmode="numeric">
              </div>
              <div class="plan-config-field">
                <label for="plan-12month-description">توضیح کوتاه</label>
                <textarea id="plan-12month-description" rows="2" placeholder="مثلاً بهترین گزینه برای توسعه برند"></textarea>
              </div>
              <div class="plan-config-field">
                <label for="plan-12month-features">مزایا (هر خط یک مورد)</label>
                <textarea id="plan-12month-features" rows="4" placeholder="پشتیبانی اختصاصی و گزارش تحلیلی"></textarea>
              </div>
            </div>
          </article>
        </div>

        <footer class="plan-config-footer">
          <button type="submit" class="plan-config-submit">ذخیره پلن‌ها</button>
          <div id="plansMsg" class="plan-config-message" role="alert" aria-live="polite"></div>
        </footer>
      </form>
    </div>
  </div>

  <!-- ۷) مدیریت قیمت تبلیغات (جداسازی‌شده) -->
  <div class="section-panel" id="ads-panel" style="display:none;">
    <div class="content-header">مدیریت قیمت تبلیغات</div>
    <div class="plans-center" style="flex-direction:column;gap:2.5rem;width:100%;max-width:1000px;">
      <form id="adsForm" class="priceForm">
        <div>
          <input id="seller-phone-ads" type="text" placeholder="شماره موبایل فروشنده (اختیاری برای قیمت اختصاصی)" style="width:100%;margin-bottom:1rem;padding:0.9rem 1.2rem;font-size:1.15rem;background:#f8fafc;border:1.8px solid #e0fdfa;border-radius:16px;outline:none;"/>
        </div>
        <div>
          <label for="ad_search">تبلیغ جستجو</label>
          <input id="ad_search" type="number" />
        </div>
        <div>
          <label for="ad_home">تبلیغ صفحه اول</label>
          <input id="ad_home" type="number" />
        </div>
        <div>
          <label for="ad_products">تبلیغ بین محصولات</label>
          <input id="ad_products" type="number" />
        </div>
        <button type="submit">ذخیره قیمت تبلیغات</button>
        <div id="adsMsg" style="display:none;"></div>
      </form>
    </div>
  </div>


  <!-- ۸) مدیریت تبلیغات ویژه -->
  <div class="section-panel" id="ad-orders-panel" style="display:none;">
    <header class="ad-orders-hero">
      <div class="content-header">
        تبلیغات ویژه ثبت شده <span class="header-count" id="header-ad-orders-count"></span>
      </div>
      <p class="ad-orders-subtitle">بر درخواست‌های تبلیغات ویژه نظارت کنید، وضعیت هر سفارش را مشخص نمایید و توضیحات فروشندگان را یکجا ببینید.</p>
    </header>

    <details class="ad-orders-guide" id="adOrdersGuide">
      <summary><i class="ri-lightbulb-line" aria-hidden="true"></i>راهنمای تایید سریع</summary>
      <ul>
        <li>ابتدا وضعیت درخواست را با توجه به پلن انتخابی و تاریخ نمایش بررسی کنید.</li>
        <li>از طریق دکمه «جزئیات» می‌توانید فایل‌ها، توضیحات و سوابق تغییرات را مشاهده کنید.</li>
        <li>دکمه‌های تایید یا رد سریع تنها برای سفارش‌های «در انتظار» فعال هستند.</li>
        <li>پس از اعمال تغییر، جهت بروزرسانی جدول از گزینه «بروزرسانی» در نوار ابزار استفاده کنید.</li>
      </ul>
    </details>

    <div class="ad-orders-overview">
      <div class="ad-overview-card total">
        <div class="ad-overview-icon">
          <i class="ri-megaphone-line"></i>
        </div>
        <div class="ad-overview-body">
          <span class="label">کل تبلیغات</span>
          <span class="value" id="adTotalCount">0</span>
        </div>
      </div>
      <div class="ad-overview-card pending">
        <div class="ad-overview-icon">
          <i class="ri-timer-2-line"></i>
        </div>
        <div class="ad-overview-body">
          <span class="label">در انتظار تایید</span>
          <span class="value" id="adPendingCount">0</span>
        </div>
      </div>
      <div class="ad-overview-card approved">
        <div class="ad-overview-icon">
          <i class="ri-checkbox-circle-line"></i>
        </div>
        <div class="ad-overview-body">
          <span class="label">تایید شده</span>
          <span class="value" id="adApprovedCount">0</span>
        </div>
      </div>
    </div>

    <div class="ad-orders-toolbar-card">
      <div class="ad-orders-toolbar-header">
        <div class="ad-toolbar-title">
          <h3>پایش سریع درخواست‌ها</h3>
          <p>با فیلترها و جستجو سریع‌تر به نتیجه برسید و با بروزرسانی، جدیدترین وضعیت سفارش‌ها را ببینید.</p>
        </div>
        <button id="adOrdersRefresh" class="ad-toolbar-refresh"><i class="ri-refresh-line"></i> بروزرسانی</button>
      </div>
      <div class="ad-orders-toolbar">
        <div class="filters" role="tablist" aria-label="فیلتر وضعیت">
          <button class="ad-filter-btn active" data-filter="all"><i class="ri-list-unordered"></i> همه</button>
          <button class="ad-filter-btn" data-filter="pending"><i class="ri-timer-line"></i> در انتظار</button>
          <button class="ad-filter-btn" data-filter="approved"><i class="ri-checkbox-circle-line"></i> تایید شده</button>
          <button class="ad-filter-btn" data-filter="rejected"><i class="ri-close-circle-line"></i> رد شده</button>
        </div>
        <div class="ad-orders-controls">
          <label class="ad-control ad-control-select" for="adOrdersPlanFilter">
            <span>نوع پلن</span>
            <select id="adOrdersPlanFilter">
              <option value="all">همه پلن‌ها</option>
              <option value="ad_home">صفحه اصلی</option>
              <option value="ad_search">جستجو</option>
              <option value="ad_products">بین محصولات</option>
            </select>
          </label>
          <label class="ad-control ad-control-search" for="adOrdersSearch">
            <span>جستجو</span>
            <div class="ad-search-input">
              <i class="ri-search-line"></i>
              <input type="search" id="adOrdersSearch" class="ad-orders-search" placeholder="جستجو نام فروشنده، عنوان یا شماره" />
            </div>
          </label>
        </div>
      </div>
    </div>

    <div class="ad-orders-status" id="adOrdersStatus" style="display:none;"></div>

    <div class="ad-orders-table-card">
      <div class="ad-orders-table-head">
        <div class="ad-orders-table-title">
          <h4>فهرست درخواست‌ها</h4>
          <p>برای مشاهده جزئیات کامل هر تبلیغ، روی ردیف آن کلیک کنید.</p>
        </div>
        <div class="ad-orders-table-legend">
          <span class="legend-title"><i class="ri-flag-2-line"></i> وضعیت‌ها</span>
          <span class="legend-badge pending">در انتظار</span>
          <span class="legend-badge approved">تایید شده</span>
          <span class="legend-badge rejected">رد شده</span>
        </div>
      </div>
      <div class="table-wrap ad-orders-table">
        <table id="adOrdersTable">
          <thead>
            <tr>
              <th>فروشنده</th>
              <th>پلن / جزئیات</th>
              <th>مبلغ</th>
              <th>ثبت درخواست</th>
              <th>آخرین وضعیت</th>
              <th>عملیات</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>



  <!-- ۸) داشبورد درآمدها -->
  <div class="section-panel" id="income-insights-panel" style="display:none;">
    <p style="text-align:center;color:#888">در حال بارگیری داشبورد درآمد...</p>
  </div>

  <!-- ۹) کارت‌های صفحه اصلی -->
  <div class="section-panel" id="home-section-panel" style="display:none;">
    <p style="text-align:center;color:#888">در حال بارگیری...</p>
  </div>


<!-- ۱۰) پیام‌ها -->
<div class="section-panel" id="messages-panel" style="display:none;">
  <div class="content-header">پیام‌ها <span class="header-count" id="header-messages-count"></span></div>


<!-- فیلتر پیام‌ها -->
<!-- فیلتر پیام‌ها -->
<div class="messages-filters" style="display:flex;gap:0.7rem;margin-bottom:1.1rem;flex-wrap:wrap;">
  <button class="seller-filter-btn active" data-filter="seller">پیام‌های فروشنده</button>
  <button class="seller-filter-btn" data-filter="customer">پیام‌های مشتری</button>
  <button class="seller-filter-btn" data-filter="newest">جدیدترین</button>
  <button class="seller-filter-btn" data-filter="oldest">قدیمی‌ترین</button>
  <button class="seller-filter-btn" data-filter="unanswered">پاسخ‌نداده‌ها</button>
</div>



<!-- 📢 کارت ارسال پیام همگانی -->
<!-- 📢 کارت ارسال پیام همگانی -->
<div class="broadcast-card collapsed" id="broadcastCard">
  <div class="broadcast-header" id="broadcastHeader">
    <i class="ri-mail-send-line"></i>
    <h4>ارسال پیام همگانی</h4>
    <i class="ri-arrow-down-s-line toggle-icon" id="broadcastToggleIcon"></i>
  </div>
  <div class="broadcast-body" id="broadcastBody">
    <!-- بقیه فرم بدون تغییر -->
    <div class="broadcast-row">
      <label for="broadcastTarget">ارسال به:</label>
      <select id="broadcastTarget">
        <option value="sellers">👩‍💼 همه فروشنده‌ها</option>
        <option value="customers">🛒 همه مشتری‌ها</option>
      </select>
    </div>
    <div class="broadcast-row">
      <label for="broadcastText">متن پیام:</label>
      <textarea id="broadcastText" placeholder="متن پیام خود را بنویسید…"></textarea>
    </div>
    <div class="broadcast-actions">
      <button onclick="sendBroadcastMessage()">ارسال پیام</button>
    </div>
    <p id="broadcastStatus" class="broadcast-status"></p>
  </div>
</div>




  <div class="table-wrap">
    <table id="messagesTable">
<thead>
  <tr>
    <th>پیام جدید</th>
    <th>آخرین پیام</th>
    <th>فرستنده</th>
    <th>تاریخ</th>
    <th>عملیات</th>
  </tr>
</thead>




      <tbody></tbody>
    </table>
  </div>
</div>



<!-- پنل جدید برای گزارش‌ها -->
<div class="section-panel" id="reports-panel" style="display:none;">
  <p style="text-align:center">در حال بارگیری...</p>
</div>


</div><!-- /main-content -->










  <div id="plan-save-success-modal" class="plan-save-modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="plan-save-success-title">
    <div class="plan-save-modal__content">
      <div class="plan-save-modal__icon" aria-hidden="true">
        <i class="ri-checkbox-circle-line"></i>
      </div>
      <h3 id="plan-save-success-title">تغییرات با موفقیت ذخیره شد</h3>
      <p id="plan-save-success-message">قیمت پلن‌ها بلافاصله بروزرسانی شد و برای فروشندگان قابل مشاهده است.</p>
      <button type="button" class="plan-save-modal__close" id="plan-save-success-close" data-plan-save-close>
        متوجه شدم
      </button>
    </div>
  </div>

  <script src="dashboard.js" defer></script>

<div id="ad-order-modal" class="ad-modal-overlay" style="display:none"></div>

<div id="seller-modal-overlay" class="seller-modal-overlay" style="display:none"></div>



<div id="sender-modal-overlay" class="sender-modal-overlay"></div>

<div id="user-modal-overlay" class="user-modal-overlay" style="display:none"></div>

<!-- TODO: افزودن رویدادهای PostHog پس از فعال‌سازی | TODO: Enable PostHog events after activation -->
<!--
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const safeCapture = window.safePosthogCapture || function () {};
    // دسترسی مدیر به داشبورد | Admin dashboard viewed
    // safeCapture('admin_login', { area: 'admin-dashboard' });
  });
</script>
-->

</body>
</html>