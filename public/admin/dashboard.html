<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>داشبورد مدیریت | ویترینت</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="dashboard.css">
  <script src="/nav-active.js" defer></script>
</head>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
      <div class="sidebar-header">ویترینت</div>
      <div class="sidebar-menu">
        <a href="#" class="active" data-section="dashboard"><i class="ri-dashboard-line"></i> داشبورد</a>
        <a href="#" data-section="daily-visits"><i class="ri-eye-line"></i> آمار روزانه بازدید</a>
        <a href="#" data-section="users"><i class="ri-user-3-line"></i> کاربران <span class="count" id="count-users">0</span></a>
        <a href="#" data-section="sellers"><i class="ri-store-2-line"></i> فروشنده‌ها <span class="count" id="count-sellers">0</span></a>
        <a href="#" data-section="service-shops" id="service-shops-link"><i class="ri-scissors-2-line"></i> مغازه‌های خدماتی <span class="count" id="count-service-shops"></span></a>
        <a href="#" data-section="service-plan-management"><i class="ri-hand-heart-line"></i> مدیریت پلن‌های خدماتی <span class="count" id="count-service-plans">0</span></a>
        <a href="#" data-section="categories"><i class="ri-folders-line"></i> مدیریت دسته‌بندی‌ها</a>
        <a href="#" data-section="products"><i class="ri-box-3-line"></i> محصولات <span class="count" id="count-products">0</span></a>
        <a href="#" data-section="shopping-centers"><i class="ri-building-2-line"></i> مراکز خرید <span class="count" id="count-shopping-centers">0</span></a>
        <a href="#" data-section="plans"><i class="ri-money-dollar-circle-line"></i> مدیریت قیمت پلن‌ها</a>
        <a href="#" data-section="ads"><i class="ri-megaphone-line"></i> مدیریت قیمت تبلیغات</a>
        <a href="#" data-section="income-insights"><i class="ri-bar-chart-grouped-line"></i> داشبورد درآمدها</a>
        <a href="#" data-section="ad-orders"><i class="ri-advertisement-line"></i> تایید تبلیغات ویژه <span class="count" id="count-ad-orders">0</span></a>
        <a href="#" data-section="home-section"><i class="ri-layout-grid-line"></i> کارت‌های صفحه اصلی</a>
        <a href="#" data-section="messages">
          <i class="ri-chat-1-line"></i> پیام‌ها
          <span class="count" id="count-messages">0</span>
        </a>
<a href="#" data-section="reports"><i class="ri-file-list-line"></i> گزارشات <span class="count" id="count-reports">0</span></a>


      </div>
      <div class="sidebar-footer">
        <span>© 2025 vitrinNet Panel</span>
      </div>
    </nav>
 <!-- Main Content
–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––– -->
<div class="main-content">
  <!-- دکمهٔ باز/بستن سایدبار در موبایل -->
  <button class="sidebar-toggle-btn" id="sidebarToggle">
    <i class="ri-menu-3-line"></i>
  </button>

  <!-- ۱) داشبورد -->
  <div class="section-panel" id="dashboard-panel">
    <div class="content-header">داشبورد آماری</div>
    <div class="cards">
      <div class="card" id="card-visits">
        <span class="icon"><i class="ri-eye-line"></i></span>
        <div><div class="num" id="visit-today">0</div><div class="label">بازدید امروز</div></div>
      </div>
      <div class="card" id="card-users">
        <span class="icon"><i class="ri-user-add-line"></i></span>
        <div><div class="num" id="register-user-today">0</div><div class="label">ثبت‌نام کاربران امروز</div></div>
      </div>
      <div class="card" id="card-sellers">
        <span class="icon"><i class="ri-store-2-line"></i></span>
        <div><div class="num" id="register-seller-today">0</div><div class="label">ثبت‌نام فروشنده امروز</div></div>
      </div>
      <div class="card" id="card-service-shops">
        <span class="icon"><i class="ri-scissors-2-line"></i></span>
        <div><div class="num" id="service-shops-total">0</div><div class="label">مغازه‌های خدماتی فعال</div></div>
      </div>
      <div class="card" id="card-products">
        <span class="icon"><i class="ri-box-3-line"></i></span>
        <div><div class="num" id="products-total">0</div><div class="label">تعداد محصولات</div></div>
      </div>
    </div>
    <div id="dashboard-dynamic-chart-wrap"></div>
  </div>

  <!-- پنل جدید برای آمار روزانه بازدید -->
  <div class="section-panel" id="daily-visits-panel" style="display:none;">
    <p style="text-align:center">در حال بارگیری...</p>
  </div>

  <!-- ۲) کاربران -->
<!-- ۲) کاربران -->
<div class="section-panel" id="users-panel" style="display:none;">
  <div class="content-header">کاربران <span class="header-count" id="header-users-count"></span></div>
  <div style="margin-bottom:1rem;display:flex;gap:0.5rem;align-items:center;">
    <input type="text" id="userSearch" placeholder="جستجو نام، نام خانوادگی یا تلفن..." 
           style="width:100%;max-width:400px;padding:0.7rem 1rem;border-radius:12px;border:1.5px solid #10b98144;font-size:1rem;font-family:inherit;outline:none;transition:border .15s;">
  </div>
  <div class="table-wrap">
    <table id="usersTable">
      <thead><tr><th>نام</th><th>ایمیل</th><th>عملیات</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>
</div>

  <!-- ۳) فروشنده‌ها -->
  <div class="section-panel" id="sellers-panel" style="display:none;">
    <div class="content-header">فروشنده‌ها <span class="header-count" id="header-sellers-count"></span></div>
    <div style="margin-bottom:1rem;display:flex;gap:0.5rem;align-items:center;">
  <input type="text" id="sellerSearch" placeholder="جستجو نام فروشگاه، فروشنده یا آدرس..." 
         style="width:100%;max-width:400px;padding:0.7rem 1rem;border-radius:12px;border:1.5px solid #10b98144;font-size:1rem;font-family:inherit;outline:none;transition:border .15s;">
</div>
    <div class="sellers-filters" style="display:flex;gap:.7rem;margin-bottom:1.1rem;flex-wrap:wrap">
      <button class="seller-filter-btn active" data-sort="newest">جدیدترین</button>
      <button class="seller-filter-btn" data-sort="oldest">قدیمی‌ترین</button>
      <button class="seller-filter-btn" data-sort="mostvisited">پربازدیدترین</button>
      <button class="seller-filter-btn" data-sort="mostproducts">پرمحصول‌ترین</button>
    </div>

    <div class="table-wrap">
      <table id="sellersTable">
        <thead>
          <tr>
            <th>نام فروشگاه</th><th>نام صاحب فروشگاه</th><th>آدرس فروشگاه</th>
            <th>لینک فروشگاه</th><th>تعداد محصولات</th><th>بازدید</th><th>نمره ادمین</th><th>عملیات</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
  <!-- مدیریت مغازه‌های خدماتی -->
  <div class="section-panel section-panel--service-shops" id="service-shops-panel" style="display:none;">
    <span id="header-service-shops-count" hidden></span>
    <section class="service-shops-plan-card" aria-label="راهنمای مدیریت پلن رایگان">
      <div class="service-shops-plan-card__header">
        <h3><i class="ri-gift-line" aria-hidden="true"></i> مدیریت پلن رایگان فروشندگان</h3>
        <span class="service-shops-plan-card__chip">ویژه</span>
      </div>
      <p class="service-shops-plan-card__text">
        از این بخش می‌توانید برای هر مغازه خدماتی پلن رایگان تعریف کنید، آن را لغو نمایید یا مجدداً فعال کنید.
        تمام تغییرات بلافاصله در پنل فروشنده با عنوان «پلن رایگان» نمایش داده می‌شود.
      </p>
      <ul class="service-shops-plan-card__list">
        <li><i class="ri-check-line" aria-hidden="true"></i> انتخاب مدت پلن بین ۱ تا ۳۶۵ روز با محاسبهٔ خودکار تاریخ پایان</li>
        <li><i class="ri-check-line" aria-hidden="true"></i> مشاهده وضعیت لحظه‌ای (فعال، زمان‌بندی‌شده، منقضی) برای هر فروشنده</li>
        <li><i class="ri-check-line" aria-hidden="true"></i> ثبت یادداشت مدیریتی برای پیگیری‌های بعدی</li>
      </ul>
      <div class="service-shops-plan-card__actions">
        <a class="service-shops-plan-card__action" href="service-shops.html" target="_blank" rel="noopener noreferrer">
          <i class="ri-external-link-line" aria-hidden="true"></i>
          ورود به مدیریت پلن‌های رایگان
        </a>
        <a class="service-shops-plan-card__action service-shops-plan-card__action--secondary" href="../service-seller-panel/s-seller-panel.html" target="_blank" rel="noopener noreferrer">
          <i class="ri-user-smile-line" aria-hidden="true"></i>
          مشاهده نمای فروشنده
        </a>
      </div>
      <p class="service-shops-plan-card__footnote">
        <i class="ri-lightbulb-flash-line" aria-hidden="true"></i>
        هر تغییری روی پلن رایگان، پیام اطلاع‌رسانی واضحی در پنل فروشنده نمایش می‌دهد.
      </p>
    </section>
    <section class="service-shop-form-card" aria-label="فرم مدیریت مغازه خدماتی">
      <div class="service-shop-form-card__header">
        <div>
          <h3><i class="ri-tools-line" aria-hidden="true"></i> فرم مدیریت سریع مغازه خدماتی</h3>
          <p>تمام جزئیات مغازه را در یک فرم حرفه‌ای ثبت، بررسی و به صورت پیش‌نویس ذخیره کنید.</p>
        </div>
        <div class="service-shop-form-card__meta">
          <span class="service-shop-form-card__badge" aria-label="این بخش آزمایشی است">نسخهٔ آزمایشی</span>
          <button type="button" class="service-shop-form-card__guide" id="serviceShopFormGuide" aria-expanded="false" aria-controls="serviceShopGuidePanel">
            <i class="ri-question-line" aria-hidden="true"></i>
            راهنمای تکمیل
          </button>
        </div>
      </div>
      <div class="service-shop-form-guide" id="serviceShopGuidePanel" hidden tabindex="-1" role="region" aria-live="polite">
        <strong>راهنما:</strong>
        <ul>
          <li>موارد ستاره‌دار الزامی هستند و بدون آن ثبت نهایی انجام نمی‌شود.</li>
          <li>برای اعمال پلن اختصاصی، تاریخ شروع و پایان را مشخص کنید و نوع پلن را از گزینه‌های بالا برگزینید.</li>
          <li>برچسب‌های «خدمات شاخص» برای نمایش در صفحهٔ جستجو و کارت مغازه استفاده می‌شوند.</li>
        </ul>
      </div>
      <div class="service-shop-management">
        <form id="serviceShopManagementForm" class="service-shop-form" novalidate>
          <div class="service-shop-form-grid">
            <section class="service-shop-form-section">
              <h4>اطلاعات پایه</h4>
              <div class="service-shop-form-field">
                <label for="serviceShopName">نام مغازه *</label>
                <input type="text" id="serviceShopName" name="name" placeholder="مثلاً استودیو زیبایی آناهیتا" required autocomplete="off" />
              </div>
              <div class="service-shop-form-field">
                <label for="serviceShopOwner">نام صاحب مغازه *</label>
                <input type="text" id="serviceShopOwner" name="owner" placeholder="نام و نام خانوادگی" required />
              </div>
              <div class="service-shop-form-field">
                <label for="serviceShopPhone">شماره تماس مدیریتی *</label>
                <input type="tel" id="serviceShopPhone" name="phone" inputmode="numeric" pattern="09\d{9}" placeholder="مثلاً 09123456789" required />
                <span class="service-shop-form-helper">فرمت مجاز: ۱۱ رقم و شروع با ۰۹</span>
              </div>
            </section>

            <section class="service-shop-form-section">
              <h4>مکان و ساعت کاری</h4>
              <div class="service-shop-form-field">
                <label for="serviceShopCity">شهر *</label>
                <select id="serviceShopCity" name="city" required>
                  <option value="" disabled selected>انتخاب شهر</option>
                  <option value="sanandaj">سنندج</option>
                  <option value="tehran">تهران</option>
                  <option value="tabriz">تبریز</option>
                  <option value="shiraz">شیراز</option>
                </select>
              </div>
              <div class="service-shop-form-field">
                <label for="serviceShopArea">محله / محدوده</label>
                <input type="text" id="serviceShopArea" name="area" placeholder="مثلاً ناحیه فردوسی" />
              </div>
              <div class="service-shop-form-field">
                <label for="serviceShopAddress">آدرس دقیق</label>
                <textarea id="serviceShopAddress" name="address" rows="3" placeholder="آدرس کامل برای مسیریابی"></textarea>
              </div>
              <div class="service-shop-form-field">
                <label for="serviceShopHours">ساعت کاری</label>
                <input type="text" id="serviceShopHours" name="hours" placeholder="مثلاً همه‌روزه ۹ تا ۲۰" />
              </div>
            </section>

            <section class="service-shop-form-section">
              <h4>دسته‌بندی و خدمات شاخص</h4>
              <div class="service-shop-form-field">
                <label for="serviceShopCategory">دسته‌بندی اصلی *</label>
                <select id="serviceShopCategory" name="category" required>
                  <option value="" disabled selected>انتخاب دسته‌بندی</option>
                  <option value="beauty">زیبایی و آرایش</option>
                  <option value="repair">تعمیرات تخصصی</option>
                  <option value="education">آموزش و مهارت</option>
                  <option value="health">سلامت و تندرستی</option>
                </select>
              </div>
              <div class="service-shop-form-field">
                <label for="serviceShopSubcategories">زیرگروه‌ها</label>
                <select id="serviceShopSubcategories" name="subcategories" multiple data-placeholder="سه زیرگروه منتخب">
                  <option value="makeup">میکاپ حرفه‌ای</option>
                  <option value="hair">خدمات مو و رنگ</option>
                  <option value="nails">طراحی و کاشت ناخن</option>
                  <option value="repair-electronic">تعمیر لوازم الکترونیکی</option>
                  <option value="cleaning">پاکسازی منازل</option>
                  <option value="photography">عکاسی صنعتی</option>
                </select>
                <span class="service-shop-form-helper">برای انتخاب چند مورد، دکمه Ctrl یا Cmd را نگه دارید.</span>
              </div>
              <div class="service-shop-form-tags">
                <span class="service-shop-form-tags__label">خدمات شاخص</span>
                <div class="service-shop-form-tags__group">
                  <label class="service-shop-tag">
                    <input type="checkbox" value="رزرو آنلاین" data-tag />
                    رزرو آنلاین
                  </label>
                  <label class="service-shop-tag">
                    <input type="checkbox" value="پیشنهاد ویژه" data-tag />
                    پیشنهاد ویژه
                  </label>
                  <label class="service-shop-tag">
                    <input type="checkbox" value="پشتیبانی فوری" data-tag />
                    پشتیبانی فوری
                  </label>
                  <label class="service-shop-tag">
                    <input type="checkbox" value="تضمین کیفیت" data-tag />
                    تضمین کیفیت
                  </label>
                  <label class="service-shop-tag">
                    <input type="checkbox" value="تخفیف همکاری" data-tag />
                    تخفیف همکاری
                  </label>
                </div>
              </div>
            </section>

            <section class="service-shop-form-section">
              <h4>پلن و وضعیت</h4>
              <div class="service-shop-form-field">
                <span class="service-shop-form-label">نوع پلن فعال</span>
                <div class="service-shop-plan-options" role="radiogroup" aria-label="نوع پلن فعال">
                  <label class="service-shop-plan-option">
                    <input type="radio" name="serviceShopPlanTier" id="serviceShopPlanTierBasic" value="basic" data-label="پلن پایه" checked />
                    <span>
                      <strong>پلن پایه</strong>
                      <small>نمایش استاندارد در نتایج</small>
                    </span>
                  </label>
                  <label class="service-shop-plan-option">
                    <input type="radio" name="serviceShopPlanTier" id="serviceShopPlanTierGrowth" value="growth" data-label="پلن رشد" />
                    <span>
                      <strong>پلن رشد</strong>
                      <small>به‌همراه ارتقای جایگاه و بنر</small>
                    </span>
                  </label>
                  <label class="service-shop-plan-option">
                    <input type="radio" name="serviceShopPlanTier" id="serviceShopPlanTierPremium" value="premium" data-label="پلن ویژه" />
                    <span>
                      <strong>پلن ویژه</strong>
                      <small>درج در vitrinPlus و مزایای کامل</small>
                    </span>
                  </label>
                </div>
              </div>
              <div class="service-shop-form-field service-shop-form-field--inline">
                <div>
                  <label for="serviceShopPlanStart">شروع پلن</label>
                  <input type="date" id="serviceShopPlanStart" name="planStart" />
                </div>
                <div>
                  <label for="serviceShopPlanEnd">پایان پلن</label>
                  <input type="date" id="serviceShopPlanEnd" name="planEnd" />
                </div>
              </div>
              <div class="service-shop-form-switches">
                <label class="service-shop-switch">
                  <input type="checkbox" id="serviceShopStatus" name="isActive" checked />
                  <span class="service-shop-switch__label">مغازه فعال باشد</span>
                </label>
                <label class="service-shop-switch">
                  <input type="checkbox" id="serviceShopBooking" name="booking" />
                  <span class="service-shop-switch__label">امکان رزرو آنلاین فعال شود</span>
                </label>
                <label class="service-shop-switch">
                  <input type="checkbox" id="serviceShopFeatured" name="featured" />
                  <span class="service-shop-switch__label">به‌عنوان مغازه ویژه نمایش داده شود</span>
                </label>
              </div>
              <div class="service-shop-form-field">
                <label for="serviceShopNotes">یادداشت مدیریتی</label>
                <textarea id="serviceShopNotes" name="notes" rows="3" placeholder="نکات مهم برای تیم پشتیبانی یا حسابداری"></textarea>
              </div>
            </section>
          </div>

          <div class="service-shop-form-actions">
            <div class="service-shop-form-actions__left">
              <button type="button" id="serviceShopFormDraft" class="service-shop-btn service-shop-btn--ghost">
                <i class="ri-save-2-line" aria-hidden="true"></i>
                ذخیره پیش‌نویس</button>
              <button type="reset" class="service-shop-btn service-shop-btn--neutral">
                <i class="ri-arrow-go-back-line" aria-hidden="true"></i>
                پاک‌سازی فرم</button>
            </div>
            <button type="submit" class="service-shop-btn service-shop-btn--primary">
              <i class="ri-check-double-line" aria-hidden="true"></i>
              ثبت نهایی مغازه
            </button>
          </div>
          <p class="service-shop-form-status" id="serviceShopFormStatus" role="status" aria-live="polite"></p>
        </form>

        <aside class="service-shop-form-summary" aria-live="polite">
          <h4>پیش‌نمایش مدیریت مغازه</h4>
          <dl class="service-shop-form-summary__list">
            <div class="service-shop-form-summary__row">
              <dt>عنوان مغازه</dt>
              <dd id="serviceShopPreviewName">—</dd>
            </div>
            <div class="service-shop-form-summary__row">
              <dt>صاحب مغازه</dt>
              <dd id="serviceShopPreviewOwner">—</dd>
            </div>
            <div class="service-shop-form-summary__row">
              <dt>شهر</dt>
              <dd id="serviceShopPreviewCity">—</dd>
            </div>
            <div class="service-shop-form-summary__row">
              <dt>پلن فعال</dt>
              <dd id="serviceShopPreviewPlan">پلن پایه</dd>
            </div>
            <div class="service-shop-form-summary__row">
              <dt>وضعیت نمایش</dt>
              <dd id="serviceShopPreviewStatus">فعال</dd>
            </div>
            <div class="service-shop-form-summary__row">
              <dt>رزرو آنلاین</dt>
              <dd id="serviceShopPreviewBooking">غیرفعال</dd>
            </div>
            <div class="service-shop-form-summary__row">
              <dt>دوره پلن</dt>
              <dd id="serviceShopPreviewPeriod">—</dd>
            </div>
          </dl>
          <div class="service-shop-form-summary__tags">
            <span>برچسب‌های انتخاب‌شده:</span>
            <div id="serviceShopSelectedTags" class="chip-list empty" data-empty-label="هنوز برچسبی انتخاب نشده است."></div>
          </div>
          <div class="service-shop-form-summary__note">
            <i class="ri-shield-check-line" aria-hidden="true"></i>
            <p>پیش‌نمایش صرفاً برای بررسی سریع است؛ ذخیره نهایی پس از کلیک روی «ثبت نهایی مغازه» انجام می‌شود.</p>
          </div>
        </aside>
      </div>
    </section>
    <div class="service-shops-embed" id="service-shops-embed">
      <div class="service-shops-embed__loading" id="service-shops-embed-loading">
        <i class="ri-loader-4-line" aria-hidden="true"></i>
        <span>در حال بارگیری بخش مغازه‌های خدماتی...</span>
      </div>
      <iframe
        id="service-shops-iframe"
        title="مدیریت مغازه‌های خدماتی"
        src="about:blank"
        data-src="service-shops.html"
        loading="lazy"
        allow="fullscreen"
        referrerpolicy="same-origin"
        sandbox="allow-same-origin allow-scripts allow-forms allow-popups"
      ></iframe>
    </div>
  </div>

  <!-- مدیریت پلن‌های خدماتی -->
  <div class="section-panel" id="service-plan-management-panel" style="display:none;">
    <div class="content-header">
      مدیریت پلن‌های خدماتی
      <span class="header-count" id="header-service-plans-count"></span>
    </div>
    <div class="service-plan-manager">
      <section class="service-plan-form-card" aria-labelledby="servicePlanFormTitle">
        <header class="service-plan-form-header">
          <div>
            <h3 id="servicePlanFormTitle"><i class="ri-edit-2-line"></i> <span id="servicePlanFormMode">ثبت پلن جدید</span></h3>
            <p>فقط چند فیلد ضروری را پر کنید و پلن خدماتی را در کمتر از یک دقیقه بسازید.</p>
          </div>
          <div class="service-plan-form-actions">
            <button type="button" id="servicePlanReset" class="outline"><i class="ri-refresh-line"></i> شروع فرم جدید</button>
          </div>
        </header>
        <form id="servicePlanForm" novalidate>
          <div class="service-plan-form-grid">
            <div class="service-plan-form-group">
              <label for="servicePlanTitle">عنوان پلن *</label>
              <input type="text" id="servicePlanTitle" name="title" placeholder="مثلاً پلن حرفه‌ای" required />
            </div>
            <div class="service-plan-form-group">
              <label for="servicePlanPrice">قیمت پلن (تومان) *</label>
              <input type="number" id="servicePlanPrice" name="price" min="0" step="1000" placeholder="مثلاً 350000" required />
            </div>
            <div class="service-plan-form-group">
              <label for="servicePlanSlug">اسلاگ یکتا</label>
              <input type="text" id="servicePlanSlug" name="slug" placeholder="به‌صورت خودکار از عنوان ساخته می‌شود" dir="ltr" />
              <span class="form-helper">در صورت نیاز می‌توانید این مقدار را به‌صورت دستی ویرایش کنید.</span>
            </div>
            <div class="service-plan-form-group">
              <label for="servicePlanDuration">مدت اعتبار (روز)</label>
              <input type="number" id="servicePlanDuration" name="durationDays" min="0" step="1" placeholder="مثلاً 30" />
              <span class="form-helper">خالی بماند تا مقدار پیش‌فرض (۳۰ روز) اعمال شود.</span>
            </div>
          </div>
          <div class="service-plan-form-group full-width">
            <label for="servicePlanDescription">توضیحات کوتاه</label>
            <textarea id="servicePlanDescription" name="description" rows="3" placeholder="این متن در کارت پلن نمایش داده می‌شود."></textarea>
          </div>
          <div class="service-plan-form-group full-width">
            <label for="servicePlanFeatures">ویژگی‌های پلن</label>
            <textarea id="servicePlanFeatures" name="features" rows="4" placeholder="هر ویژگی را در یک خط بنویسید (اختیاری)"></textarea>
          </div>
          <div class="service-plan-form-submit">
            <button type="submit" id="servicePlanSubmit"><i class="ri-save-3-line"></i> ذخیره پلن</button>
          </div>
          <div class="service-plan-message" id="servicePlanMessage" role="status" aria-live="polite" hidden></div>
        </form>
      </section>
      <section class="service-plan-list-card" aria-labelledby="servicePlanListTitle">
        <header class="service-plan-list-header">
          <div>
            <h3 id="servicePlanListTitle"><i class="ri-stack-line"></i> پلن‌های ثبت‌شده</h3>
            <p>لیست پلن‌های فعال و غیرفعال را در یک نگاه مدیریت کنید.</p>
          </div>
          <div class="service-plan-list-actions">
            <button type="button" id="servicePlanRefresh"><i class="ri-refresh-line"></i> بروزرسانی لیست</button>
          </div>
        </header>
        <div class="service-plan-list" id="servicePlansList">
          <div class="service-plan-empty">
            <i class="ri-information-line"></i>
            <p>برای شروع، یک پلن جدید ثبت کنید یا لیست را بروزرسانی نمایید.</p>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- ۴) محصولات -->
  <div class="section-panel" id="products-panel" style="display:none;">
    <div class="content-header">محصولات <span class="header-count" id="header-products-count"></span></div>

<!-- جستجوی محصولات -->
<div style="margin-bottom:1rem;display:flex;gap:0.5rem;align-items:center;">
  <input type="text" id="productSearch" placeholder="جستجو نام محصول، فروشنده یا فروشگاه..." 
         style="width:100%;max-width:400px;padding:0.7rem 1rem;border-radius:12px;border:1.5px solid #10b98144;font-size:1rem;font-family:inherit;outline:none;transition:border .15s;">
</div>

<!-- فیلتر مرتب‌سازی محصولات -->
<div class="products-filters" style="display:flex;gap:.7rem;margin-bottom:1.1rem;flex-wrap:wrap">
  <button class="seller-filter-btn active" data-sort="newest">جدیدترین</button>
  <button class="seller-filter-btn" data-sort="oldest">قدیمی‌ترین</button>
</div>

    <div class="table-wrap">
      <table id="productsTable">
    <!-- productsTable – header AFTER the change -->
<thead>
  <tr>
    <th>نام محصول</th>  <!-- ستون جدید برای نام محصول -->
    <th>نام فروشگاه</th>
    <th>نام صاحب فروشگاه</th>
    <th>آدرس فروشگاه</th>
    <th>لینک فروشگاه</th>
    <th>عملیات</th>
  </tr>
</thead>

        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- ۵) مراکز خرید -->
  <div class="section-panel" id="shopping-centers-panel" style="display:none;">
    <div class="content-header">مراکز خرید <span class="header-count" id="header-shopping-centers-count"></span></div>
    <div class="shopping-centers-grid">
      <form id="shoppingCenterForm" class="shopping-center-form" enctype="multipart/form-data">
        <h3>افزودن مرکز خرید جدید</h3>
        <div>
          <label for="shoppingCenterTitle">نام مرکز خرید *</label>
          <input type="text" id="shoppingCenterTitle" name="title" placeholder="مثلاً تاناکورا" required />
        </div>
        <div class="form-row">
          <div>
            <label for="shoppingCenterTag">تگ کوتاه</label>
            <input type="text" id="shoppingCenterTag" name="tag" placeholder="مثلاً محبوب" />
          </div>
          <div>
            <label for="shoppingCenterOrder">ترتیب نمایش</label>
            <input type="number" id="shoppingCenterOrder" name="order" min="0" step="1" placeholder="0" />
          </div>
        </div>
        <div>
          <label for="shoppingCenterLocation">آدرس/موقعیت</label>
          <input type="text" id="shoppingCenterLocation" name="location" placeholder="سنندج، خیابان ..." />
        </div>
        <div class="form-row">
          <div>
            <label for="shoppingCenterHours">ساعات کاری</label>
            <input type="text" id="shoppingCenterHours" name="hours" placeholder="۱۰ الی ۲۲" />
          </div>
          <div>
            <label for="shoppingCenterHolidays">روزهای تعطیل</label>
            <input type="text" id="shoppingCenterHolidays" name="holidays" placeholder="جمعه‌ها" />
          </div>
        </div>
        <div>
          <label for="shoppingCenterDescription">توضیحات</label>
          <textarea id="shoppingCenterDescription" name="description" placeholder="معرفی کوتاه مرکز خرید"></textarea>
        </div>
        <div>
          <label for="shoppingCenterImage">تصویر شاخص *</label>
          <input type="file" id="shoppingCenterImage" name="image" accept="image/*" required />
          <small style="display:block;margin-top:0.4rem;color:#6b7280;font-size:0.78rem;">فرمت JPG یا PNG با حجم حداکثر ۲ مگابایت.</small>
        </div>
        <button type="submit"><i class="ri-add-circle-line" style="margin-left:0.3rem;"></i>افزودن مرکز خرید</button>
        <div id="shoppingCenterFormMessage" style="display:none;font-size:0.85rem;padding:0.65rem 0.9rem;border-radius:12px;"></div>
      </form>
      <div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;flex-wrap:wrap;gap:0.6rem;">
          <div style="font-weight:600;color:#0f9a8b;font-size:0.95rem;">لیست مراکز خرید فعال</div>
          <button type="button" class="shopping-centers-refresh" id="shoppingCentersRefresh">
            <i class="ri-refresh-line"></i>
            بروزرسانی لیست
          </button>
        </div>
        <div id="shoppingCentersCards" class="shopping-centers-cards"></div>
        <div id="shoppingCentersEmpty" class="shopping-centers-empty" style="display:none;">
          هنوز هیچ مرکز خریدی ثبت نشده است.
        </div>
      </div>
    </div>
  </div>

  <!-- مدیریت دسته‌بندی‌ها -->
  <div class="section-panel" id="categories-panel" style="display:none;">
    <div class="content-header">مدیریت حرفه‌ای دسته‌بندی‌ها</div>

    <div class="category-metrics">
      <div class="category-metric-card">
        <span class="metric-label">تعداد دسته‌های فعال</span>
        <span class="metric-value" id="categories-count">0</span>
      </div>
      <div class="category-metric-card">
        <span class="metric-label">زیرگروه‌های خدمات</span>
        <span class="metric-value" id="service-subcategories-count">0</span>
      </div>
      <div class="category-metric-card note">
        <i class="ri-information-line"></i>
        <div>
          <strong>ذخیره‌سازی هوشمند</strong>
          <p>تغییرات دسته‌بندی‌ها بلافاصله ذخیره شده و در پیش‌نمایش فرم ثبت فروشگاه قابل بررسی است.</p>
        </div>
      </div>
    </div>

    <div class="categories-manage-grid">
      <section class="categories-card">
        <div class="categories-card-header">
          <h3>دسته‌بندی‌های اصلی</h3>
          <p>دسته‌های مورد استفاده در فرم ثبت فروشگاه را مدیریت کنید.</p>
        </div>
        <form id="categoryAddForm" class="categories-form" autocomplete="off">
          <label for="categoryNameInput">افزودن دسته جدید</label>
          <div class="categories-form-row">
            <input type="text" id="categoryNameInput" placeholder="مثلاً تعمیرات خانگی" required />
            <button type="submit" class="primary-btn">افزودن</button>
          </div>
        </form>
        <div id="categoryManagerList" class="chip-list" data-empty-label="هنوز دسته‌ای ثبت نشده است."></div>
      </section>

      <section class="categories-card">
        <div class="categories-card-header">
          <h3>زیرگروه‌های محبوب خدمات</h3>
          <p>لیست نمونه‌های پیشنهادی برای دسته «خدمات» که در فرم به‌صورت چیپ نمایش داده می‌شود.</p>
        </div>
        <form id="serviceSubcategoryForm" class="categories-form" autocomplete="off">
          <label for="serviceSubcategoryInput">افزودن زیرگروه جدید</label>
          <label for="serviceSubcategoryParent">انتخاب دسته اصلی</label>
          <select id="serviceSubcategoryParent" required style="margin-bottom:0.75rem;">
            <option value="" disabled selected>ابتدا دسته اصلی را انتخاب کنید</option>
          </select>
          <div class="categories-form-row">
            <input type="text" id="serviceSubcategoryInput" placeholder="مثلاً خدمات نظافت" required />
            <button type="submit" class="primary-btn">افزودن</button>
          </div>
          <small style="display:block;margin-top:0.35rem;color:#6b7280;font-size:0.78rem;">برای ثبت زیرگروه، ابتدا دسته اصلی مرتبط را انتخاب کنید.</small>
        </form>
        <div id="serviceSubcategoryList" class="chip-list" data-empty-label="هنوز زیرگروهی ثبت نشده است."></div>
      </section>

      <section class="categories-card preview-card">
        <div class="categories-card-header">
          <h3>پیش‌نمایش فرم ثبت فروشگاه</h3>
          <p>به‌روزرسانی‌ها در همینجا قابل بررسی هستند.</p>
        </div>
        <div class="preview-field">
          <label>دسته‌بندی</label>
          <select id="categoryPreviewSelect" disabled>
            <option>در حال بارگیری...</option>
          </select>
        </div>
        <div class="preview-field">
          <label>نمونه زیرگروه‌های خدمات</label>
          <div id="servicePreviewChips" class="chip-list preview" data-empty-label="برای نمایش زیرگروه، موردی اضافه کنید."></div>
        </div>
        <div class="preview-note">
          <i class="ri-lightbulb-flash-line"></i>
          <p>پس از تایید نهایی، این داده‌ها را می‌توانید به بک‌اند منتقل کنید تا در تجربه کاربران اعمال شود.</p>
        </div>
      </section>
    </div>

    <div id="categoryManagerFeedback" class="category-feedback" role="status" aria-live="polite"></div>
  </div>

  <!-- ۶) مدیریت قیمت پلن‌ها -->
  <div class="section-panel" id="plans-panel" style="display:none;">
    <div class="content-header">مدیریت قیمت پلن‌ها</div>
    <div class="plans-center" style="flex-direction:column;gap:2.5rem;width:100%;max-width:1000px;">
      <div class="plan-flag-card" id="sellerPlanToggleCard" data-enabled="false">
        <div class="plan-flag-header">
          <div class="plan-flag-copy">
            <h3>نمایش بخش پلن‌ها در پنل فروشنده</h3>
            <p>
              با روشن بودن این گزینه، فروشندگان می‌توانند کارت پلن فعال و صفحه انتخاب پلن را ببینند.
              در صورت غیرفعال‌سازی، لینک پلن‌ها و محتوای مربوطه برای تمام فروشندگان مخفی می‌شود.
            </p>
          </div>
          <div class="plan-flag-switch" aria-live="polite">
            <label class="toggle-switch" for="sellerPlanToggle" aria-label="کنترل نمایش پلن‌ها">
              <input type="checkbox" id="sellerPlanToggle" />
              <span class="slider"></span>
            </label>
            <span class="plan-flag-state status-off" id="sellerPlanToggleStatus" role="status" aria-live="polite">غیرفعال</span>
          </div>
        </div>
        <div class="plan-flag-actions">
          <button type="button" class="flag-save-btn" id="sellerPlanToggleSave">ذخیره وضعیت</button>
          <button type="button" class="flag-refresh-btn" id="sellerPlanToggleRefresh">بروزرسانی وضعیت</button>
        </div>
        <div class="plan-flag-meta" id="sellerPlanToggleMeta">در حال آماده‌سازی اطلاعات...</div>
      </div>
      <form id="plansForm">
        <div>
          <input id="seller-phone-plans" type="text" placeholder="شماره موبایل فروشنده (اختیاری برای قیمت اختصاصی)" style="width:100%;margin-bottom:1rem;padding:0.9rem 1.2rem;font-size:1.15rem;background:#f8fafc;border:1.8px solid #e0fdfa;border-radius:16px;outline:none;"/>
        </div>
        <div>
          <label for="plan-1month">اشتراک ۱ ماهه</label>
          <input id="plan-1month" type="number" />
        </div>
        <div>
          <label for="plan-3month">اشتراک ۳ ماهه</label>
          <input id="plan-3month" type="number" />
        </div>
        <div>
          <label for="plan-12month">اشتراک ۱۲ ماهه</label>
          <input id="plan-12month" type="number" />
        </div>
        <!-- VitriPlus Price Input -->
        <div class="mb-4">
          <label class="block text-right text-sm text-green-900 mb-1">قیمت امکانات ویژه (ویتری‌پلاس)</label>
          <input type="number" id="vitriPlusPrice" name="vitriPlusPrice"
                 placeholder="مثلاً 30000"
                 class="w-full p-2 rounded-xl bg-green-100 text-green-800 text-sm text-right outline-none focus:ring-2 focus:ring-green-500"
                 dir="rtl">
        </div>
        <button type="submit">ذخیره قیمت پلن‌ها</button>
        <div id="plansMsg" style="display:none;"></div>
      </form>
    </div>
  </div>

  <!-- ۷) مدیریت قیمت تبلیغات (جداسازی‌شده) -->
  <div class="section-panel" id="ads-panel" style="display:none;">
    <div class="content-header">مدیریت قیمت تبلیغات</div>
    <div class="plans-center" style="flex-direction:column;gap:2.5rem;width:100%;max-width:1000px;">
      <form id="adsForm" class="priceForm">
        <div>
          <input id="seller-phone-ads" type="text" placeholder="شماره موبایل فروشنده (اختیاری برای قیمت اختصاصی)" style="width:100%;margin-bottom:1rem;padding:0.9rem 1.2rem;font-size:1.15rem;background:#f8fafc;border:1.8px solid #e0fdfa;border-radius:16px;outline:none;"/>
        </div>
        <div>
          <label for="ad_search">تبلیغ جستجو</label>
          <input id="ad_search" type="number" />
        </div>
        <div>
          <label for="ad_home">تبلیغ صفحه اول</label>
          <input id="ad_home" type="number" />
        </div>
        <div>
          <label for="ad_products">تبلیغ بین محصولات</label>
          <input id="ad_products" type="number" />
        </div>
        <button type="submit">ذخیره قیمت تبلیغات</button>
        <div id="adsMsg" style="display:none;"></div>
      </form>
    </div>
  </div>


  <!-- ۸) مدیریت تبلیغات ویژه -->
  <div class="section-panel" id="ad-orders-panel" style="display:none;">
    <div class="content-header">
      تبلیغات ویژه ثبت شده <span class="header-count" id="header-ad-orders-count"></span>
    </div>
    <p class="ad-orders-subtitle">بر درخواست‌های تبلیغات ویژه نظارت کنید، وضعیت هر سفارش را مشخص نمایید و توضیحات فروشندگان را یکجا ببینید.</p>

    <div class="ad-orders-overview">
      <div class="ad-overview-card total">
        <div class="ad-overview-icon">
          <i class="ri-megaphone-line"></i>
        </div>
        <div class="ad-overview-body">
          <span class="label">کل تبلیغات</span>
          <span class="value" id="adTotalCount">0</span>
        </div>
      </div>
      <div class="ad-overview-card pending">
        <div class="ad-overview-icon">
          <i class="ri-timer-2-line"></i>
        </div>
        <div class="ad-overview-body">
          <span class="label">در انتظار تایید</span>
          <span class="value" id="adPendingCount">0</span>
        </div>
      </div>
      <div class="ad-overview-card approved">
        <div class="ad-overview-icon">
          <i class="ri-checkbox-circle-line"></i>
        </div>
        <div class="ad-overview-body">
          <span class="label">تایید شده</span>
          <span class="value" id="adApprovedCount">0</span>
        </div>
      </div>
    </div>

    <div class="ad-orders-toolbar-card">
      <div class="ad-orders-toolbar-header">
        <div class="ad-toolbar-title">
          <h3>پایش سریع درخواست‌ها</h3>
          <p>با فیلترها و جستجو سریع‌تر به نتیجه برسید و با بروزرسانی، جدیدترین وضعیت سفارش‌ها را ببینید.</p>
        </div>
        <button id="adOrdersRefresh" class="ad-toolbar-refresh"><i class="ri-refresh-line"></i> بروزرسانی</button>
      </div>
      <div class="ad-orders-toolbar">
        <div class="filters" role="tablist" aria-label="فیلتر وضعیت">
          <button class="ad-filter-btn active" data-filter="all"><i class="ri-list-unordered"></i> همه</button>
          <button class="ad-filter-btn" data-filter="pending"><i class="ri-timer-line"></i> در انتظار</button>
          <button class="ad-filter-btn" data-filter="approved"><i class="ri-checkbox-circle-line"></i> تایید شده</button>
          <button class="ad-filter-btn" data-filter="rejected"><i class="ri-close-circle-line"></i> رد شده</button>
        </div>
        <div class="ad-orders-controls">
          <label class="ad-control ad-control-select" for="adOrdersPlanFilter">
            <span>نوع پلن</span>
            <select id="adOrdersPlanFilter">
              <option value="all">همه پلن‌ها</option>
              <option value="ad_home">صفحه اصلی</option>
              <option value="ad_search">جستجو</option>
              <option value="ad_products">بین محصولات</option>
            </select>
          </label>
          <label class="ad-control ad-control-search" for="adOrdersSearch">
            <span>جستجو</span>
            <div class="ad-search-input">
              <i class="ri-search-line"></i>
              <input type="search" id="adOrdersSearch" class="ad-orders-search" placeholder="جستجو نام فروشنده، عنوان یا شماره" />
            </div>
          </label>
        </div>
      </div>
    </div>

    <div class="ad-orders-status" id="adOrdersStatus" style="display:none;"></div>

    <div class="ad-orders-table-card">
      <div class="ad-orders-table-head">
        <div class="ad-orders-table-title">
          <h4>فهرست درخواست‌ها</h4>
          <p>برای مشاهده جزئیات کامل هر تبلیغ، روی ردیف آن کلیک کنید.</p>
        </div>
        <div class="ad-orders-table-legend">
          <span class="legend-title"><i class="ri-flag-2-line"></i> وضعیت‌ها</span>
          <span class="legend-badge pending">در انتظار</span>
          <span class="legend-badge approved">تایید شده</span>
          <span class="legend-badge rejected">رد شده</span>
        </div>
      </div>
      <div class="table-wrap ad-orders-table">
        <table id="adOrdersTable">
          <thead>
            <tr>
              <th>فروشنده</th>
              <th>پلن / جزئیات</th>
              <th>مبلغ</th>
              <th>ثبت درخواست</th>
              <th>آخرین وضعیت</th>
              <th>عملیات</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>



  <!-- ۸) داشبورد درآمدها -->
  <div class="section-panel" id="income-insights-panel" style="display:none;">
    <p style="text-align:center;color:#888">در حال بارگیری داشبورد درآمد...</p>
  </div>

  <!-- ۹) کارت‌های صفحه اصلی -->
  <div class="section-panel" id="home-section-panel" style="display:none;">
    <p style="text-align:center;color:#888">در حال بارگیری...</p>
  </div>


<!-- ۱۰) پیام‌ها -->
<div class="section-panel" id="messages-panel" style="display:none;">
  <div class="content-header">پیام‌ها <span class="header-count" id="header-messages-count"></span></div>


<!-- فیلتر پیام‌ها -->
<!-- فیلتر پیام‌ها -->
<div class="messages-filters" style="display:flex;gap:0.7rem;margin-bottom:1.1rem;flex-wrap:wrap;">
  <button class="seller-filter-btn active" data-filter="seller">پیام‌های فروشنده</button>
  <button class="seller-filter-btn" data-filter="customer">پیام‌های مشتری</button>
  <button class="seller-filter-btn" data-filter="newest">جدیدترین</button>
  <button class="seller-filter-btn" data-filter="oldest">قدیمی‌ترین</button>
  <button class="seller-filter-btn" data-filter="unanswered">پاسخ‌نداده‌ها</button>
</div>



<!-- 📢 کارت ارسال پیام همگانی -->
<!-- 📢 کارت ارسال پیام همگانی -->
<div class="broadcast-card collapsed" id="broadcastCard">
  <div class="broadcast-header" id="broadcastHeader">
    <i class="ri-mail-send-line"></i>
    <h4>ارسال پیام همگانی</h4>
    <i class="ri-arrow-down-s-line toggle-icon" id="broadcastToggleIcon"></i>
  </div>
  <div class="broadcast-body" id="broadcastBody">
    <!-- بقیه فرم بدون تغییر -->
    <div class="broadcast-row">
      <label for="broadcastTarget">ارسال به:</label>
      <select id="broadcastTarget">
        <option value="sellers">👩‍💼 همه فروشنده‌ها</option>
        <option value="customers">🛒 همه مشتری‌ها</option>
      </select>
    </div>
    <div class="broadcast-row">
      <label for="broadcastText">متن پیام:</label>
      <textarea id="broadcastText" placeholder="متن پیام خود را بنویسید…"></textarea>
    </div>
    <div class="broadcast-actions">
      <button onclick="sendBroadcastMessage()">ارسال پیام</button>
    </div>
    <p id="broadcastStatus" class="broadcast-status"></p>
  </div>
</div>




  <div class="table-wrap">
    <table id="messagesTable">
<thead>
  <tr>
    <th>پیام جدید</th>
    <th>آخرین پیام</th>
    <th>فرستنده</th>
    <th>تاریخ</th>
    <th>عملیات</th>
  </tr>
</thead>




      <tbody></tbody>
    </table>
  </div>
</div>



<!-- پنل جدید برای گزارش‌ها -->
<div class="section-panel" id="reports-panel" style="display:none;">
  <p style="text-align:center">در حال بارگیری...</p>
</div>


</div><!-- /main-content -->










  <script src="dashboard.js" defer></script>

<div id="ad-order-modal" class="ad-modal-overlay" style="display:none"></div>

<div id="seller-modal-overlay" class="seller-modal-overlay" style="display:none"></div>



<div id="sender-modal-overlay" class="sender-modal-overlay"></div>

<div id="user-modal-overlay" class="user-modal-overlay" style="display:none"></div>
</body>
</html>