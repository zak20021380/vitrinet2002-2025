<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>شهر رو بگرد | ویترینت</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;800&family=Montserrat:wght@700&display=swap" rel="stylesheet"/>
  <style>
    body {
      font-family: 'Vazirmatn', 'Montserrat', sans-serif;
      background: #f8fafc;
      letter-spacing: -0.01em;
    }
    .main-logo {
      font-size: 2.25rem;
      color: #10b981;
      font-family: 'Vazirmatn','Montserrat',sans-serif;
      letter-spacing:-1px;
      filter: drop-shadow(0 0 9px #e0fdfa88);
      font-weight: 900;
      user-select: none;
      line-height: 2.6rem;
    }
    @media (max-width: 640px) {
      .main-logo {font-size: 1.3rem; line-height:2rem;}
    }
    .area-btn {
      background: linear-gradient(90deg,#e0fdfa 0%,#d2fbf1 100%);
      color: #10b981;
      font-weight: 800;
      border-radius: 1rem;
      font-size: 1rem;
      min-width: 90px;
      padding: 10px 0 11px 0;
      margin-inline-end: 6px;
      margin-bottom: 3px;
      transition: all 0.16s;
      box-shadow: 0 1.5px 8px #bbf7d0a1;
      outline: none;
      border: none;
      cursor: pointer;
      font-family: 'Vazirmatn', 'Montserrat', sans-serif;
    }
    .area-btn.active, .area-btn:hover {
      background: linear-gradient(90deg,#10b981,#0ea5e9);
      color: #fff;
      box-shadow: 0 8px 36px #10b98122;
      transform: scale(1.055);
    }
    /* دکمه مراکز خرید */
.center-btn {
  background: #fff;
  border: 2px solid #10b98133;
  color: #13bfa4;
  font-weight: 900;
  border-radius: 1.3rem;
  font-size: 1.08rem;
  width: 350px;         /* این خط باعث میشه عرض دقیق بشه */
  max-width: 95vw;      /* تا تو موبایل نزنه بیرون */
  padding: 13px 0;      /* راست و چپ دیگه مهم نیست */
  margin-bottom: 3px;
  box-shadow: 0 2px 16px #6ee7b78c;
  transition: all 0.18s;
  text-align: center;
  letter-spacing: -.5px;
  display: block;
  margin-left: auto;
  margin-right: auto;
}



    .center-btn:hover {
      background: linear-gradient(90deg,#0ea5e9,#10b981);
      color: #fff;
      border-color: #0ea5e9;
      box-shadow: 0 7px 26px #10b98136;
      transform: scale(1.045);
    }
    /* سلکت‌باکس ریسپانسیو */
    .category-select {
      appearance: none;
      background: #f6fffd;
      border: 1.7px solid #d1fae5;
      color: #08918e;
      font-weight: 800;
      padding: 12px 2.5rem 12px 1rem;
      min-width: 160px;
      font-size: 1.1rem;
      border-radius: 1.1rem;
      box-shadow: 0 1.5px 7px #bef5e1a7;
      transition: all 0.17s;
      outline: none;
      font-family: 'Vazirmatn', 'Montserrat', sans-serif;
      position: relative;
      direction: rtl;
    }

    .category-select {
  text-align: center;
  text-align-last: center; /* واسه مرورگرهای مدرن */
}








    .category-select:focus, .category-select:hover {
      border-color: #10b981;
      background: #e2f8f1;
      color: #10b981;
    }
    .category-select option {
      font-size: 1rem;
      font-weight: 600;
      color: #098981;
      background: #f6fefc;
    }
    .select-arrow {
      position: absolute;
      right: 18px;
      top: 52%;
      transform: translateY(-50%);
      pointer-events: none;
      font-size: 22px;
      color: #13bfa4;
      z-index: 10;
    }
    /* مناطق */
    .areas-scroll {
      position: relative;
      overflow-x: auto;
      scrollbar-width: none;
      scroll-behavior: smooth;
      padding-bottom: 3px;
      justify-content: center;
      -ms-overflow-style: none;
      mask-image: linear-gradient(to left, transparent 0, black 20px, black 95%, transparent 100%);
      -webkit-mask-image: linear-gradient(to left, transparent 0, black 20px, black 95%, transparent 100%);
    }
    .areas-scroll::-webkit-scrollbar { display: none; }
    @media (max-width: 1024px) {
      .shop-card { min-height: 170px; }
      .area-btn { font-size: .93rem; min-width: 65px; padding: 7px 0; }
      .center-btn {font-size: .99rem; min-width: 120px;}
    }
    @media (max-width: 640px) {
      .area-btn { font-size: 12.1px; padding: 6px 0; min-width: 47px;}
      .center-btn { font-size: 13px; padding: 9px 0; min-width: 70vw;}
      .shop-card { border-radius: .6rem; min-height: 80px; }
      .category-select { min-width: 86px !important; font-size: .97rem;}
    }
    /* هدر شیشه‌ای */
    .glass-bg {
      backdrop-filter: blur(12px);
      background: rgba(255,255,255,0.95) !important;
    }
    input:focus {border-color:#10b981 !important;}
    /* فروشگاه کارت */
    .shop-card {
      background: #fff;
      border-radius: 1.12rem;
      box-shadow: 0 5px 22px #10b98114, 0 2px 10px #0ea5e910;
      transition: transform .13s, box-shadow .15s;
      overflow: hidden;
      border: 1.3px solid #e0fdfa;
      min-height: 290px;
      font-family: 'Vazirmatn', 'Montserrat', sans-serif;
    }
    .shop-card:hover { 
      transform: scale(1.034);
      box-shadow: 0 10px 36px #0ea5e922;
      border-color: #10b98150;
    }
    @media (max-width: 640px) {
      .shop-card { padding: 0.8rem !important; min-height: 90px;}
    }
  </style>
</head>
<body class="min-h-screen flex flex-col bg-[#f8fafc]">

  <!-- هدر با لوگو اصلی -->
<header class="w-full sticky top-0 z-50 bg-white/90 backdrop-blur-[10px] shadow-md border-b border-[#e0fdfa]">
  <nav class="max-w-7xl mx-auto flex items-center justify-between px-2 sm:px-6 py-2 sm:py-3 gap-y-2">
    <!-- لوگوی Vitreenet -->
    <div class="flex items-center gap-4 flex-shrink-0">
      <a href="index.html" class="logo-vitreenet font-extrabold text-[1.7rem] sm:text-[2.2rem] text-[#11d6ad] tracking-wide drop-shadow hover:brightness-110 transition-all select-none">
        Vitreenet
      </a>
      <!-- بج شهر (سنندج) -->
      <div class="flex items-center gap-1 px-3 py-1 rounded-full shadow-lg"
        style="background:linear-gradient(90deg,#10b981E6 70%,#0ea5e9E6); border: 1.5px solid #fff6;">
        <svg width="18" height="18" fill="none" viewBox="0 0 22 22" class="ml-1 drop-shadow">
          <defs>
            <linearGradient id="city-icon" x1="0" y1="0" x2="22" y2="22" gradientUnits="userSpaceOnUse">
              <stop stop-color="#fff" />
              <stop offset="1" stop-color="#b2f2e9" />
            </linearGradient>
          </defs>
          <path d="M11 2.5C7.13 2.5 4 5.61 4 9.45c0 3.52 4.1 7.93 6.2 10.01.46.47 1.2.47 1.66 0 2.1-2.08 6.14-6.49 6.14-10.01C18 5.61 14.87 2.5 11 2.5Zm0 10.25a2.75 2.75 0 1 1 0-5.5 2.75 2.75 0 0 1 0 5.5Z"
            fill="url(#city-icon)"/>
        </svg>
        <span class="font-bold text-white text-[13px] sm:text-[14px] drop-shadow-sm" style="letter-spacing:.3px;">
          سنندج
        </span>
      </div>
    </div>
    <!-- منو -->
    <div class="flex items-center gap-2 sm:gap-4 ml-2">
      <a href="index.html" class="hidden sm:inline text-gray-700 hover:text-[#10b981] font-bold px-2 sm:px-3 transition">خانه</a>
      <a href="categories.html" class="hidden sm:inline text-gray-700 hover:text-[#0ea5e9] font-bold px-2 sm:px-3 transition">دسته‌بندی</a>
      <a href="login.html" class="hidden sm:inline text-gray-700 hover:text-[#0ea5e9] font-bold px-2 sm:px-3 transition">ورود</a>
      <!-- حساب کاربری واکنشی -->
      <a href="login.html"
        class="flex items-center gap-2 px-4 py-2 rounded-full bg-[#10b981]/10 hover:bg-[#0ea5e9]/15 text-[#10b981] hover:text-[#0ea5e9] font-bold shadow-sm transition-all duration-150 text-base"
        style="font-family: Vazirmatn, sans-serif;">
        <svg width="20" height="20" fill="none" viewBox="0 0 22 22">
          <circle cx="11" cy="7" r="4" stroke="currentColor" stroke-width="1.5" />
          <path d="M4 19c0-3.3 2.7-6 6-6s6 2.7 6 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
        <span class="hidden xs:inline">حساب کاربری</span>
      </a>
      <!-- ثبت فروشگاه -->
      <a href="post.html"
        class="bg-gradient-to-l from-[#10b981] to-[#0ea5e9] hover:from-[#0ea5e9] hover:to-[#10b981] rounded-full px-5 py-2 text-white font-extrabold text-base shadow-sm transition-all duration-200 whitespace-nowrap"
        style="font-family: Vazirmatn, sans-serif;">
        ثبت فروشگاه
      </a>
    </div>
  </nav>
</header>

<!-- استایل لوگو Vitreenet (به بالای فایل <head> هم می‌تونی بذاری) -->
<style>
.logo-vitreenet {
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(90deg,#10b981 5%,#0ea5e9 90%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  letter-spacing: 2px;
  text-shadow: 0 2px 10px #0ea5e955;
}
@media (max-width: 640px) {
  .logo-vitreenet {font-size: 1.18rem !important;}
}
</style>


  <main class="flex-1 w-full max-w-6xl mx-auto px-3 sm:px-8 py-7 sm:py-12">
    <!-- تیتر و دکمه‌ها -->
    <div class="mb-5 flex items-center flex-col gap-3 sm:gap-4">
      <h1 class="main-title text-2xl sm:text-[2.18rem] font-extrabold text-center bg-gradient-to-l from-[#16c6b7] to-[#0ea5e9] text-transparent bg-clip-text tracking-tight leading-tight drop-shadow-lg" style="letter-spacing:-.6px">
        مغازه‌های شهر رو بگرد!
      </h1>
      <div class="flex flex-wrap gap-3 items-center justify-center">
        <button id="all-centers-btn" class="center-btn" type="button">
          همه مراکز خرید
        </button>
      </div>
    </div>
    <!-- مناطق معروف -->
    <div class="areas-scroll flex gap-2 mb-6 pb-1 justify-center" id="areasShort"></div>
    
    <!-- سرچ و سلکت -->
    <div class="relative flex flex-col md:flex-row gap-4 mb-9 items-center justify-between">
      <input id="searchInput" type="text" placeholder="جستجوی نام یا آدرس مغازه..." class="flex-1 py-3 px-5 border border-gray-200 rounded-full text-base shadow-sm focus:outline-none bg-white/80 w-full md:w-auto"/>
      <div class="relative w-full md:w-60">
        <select id="categorySelect" class="category-select w-full pr-9">
          <option value="">همه فروشگاه ها</option>
          <option>پوشاک</option>
          <option>خوراک</option>
          <option>خدمات</option>
          <option>دیجیتال</option>
          <option>زیبایی</option>
          <option>کتاب و تحریر</option>
          <option>لوازم خانگی</option>
          <option>ورزشی</option>
          <option>تالار و مجالس</option>
          <option>قنادی و شیرینی</option>
          <option>گل و گیاه</option>
          <option>خودرو</option>
        </select>
        <span class="select-arrow material-icons"></span>
      </div>
    </div>

    <!-- فروشگاه‌ها -->
    <div id="shopsList" class="grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-5"></div>
    <div id="noResult" class="hidden text-center text-gray-400 text-lg p-12 font-bold">هیچ مغازه‌ای پیدا نشد!</div>
  </main>
  <footer class="w-full bg-gradient-to-tr from-[#f8fafc] via-[#e0fdfa] to-[#d4fbe8] border-t mt-16 px-2 pt-6 pb-3 text-center text-[15px] text-gray-500 rounded-t-[1.7rem] shadow-lg font-bold tracking-wide">
    © 2025 ویترینت | همه حقوق محفوظ است.
  </footer>
<script>
  // مناطق معروف (برای دکمه‌های بالای صفحه)
  const AREAS = [
    {id:'baneta', name:'بانتا'},
    {id:'ferdowsi', name:'فردوسی'},
    {id:'sanacenter', name:'سنه سنتر'},
    {id:'tanakora', name:'تاناکورا'},
    {id:'almas', name:'الماس غرب'},
    {id:'abidar', name:'آبیدر'},
    {id:'navid', name:'نوید'},
    {id:'ghezel', name:'قزل قایا'},
    {id:'shahrak', name:'شهرک بهاران'},
    {id:'azadi', name:'میدان آزادی'},
    {id:'masjed', name:'خیابان مسجد جامع'},
    {id:'mellat', name:'پارک ملت'},
    {id:'salar', name:'سالار'},
    {id:'parastar', name:'پرستار'},
    {id:'emam', name:'بلوار امام'},
    {id:'ghadir', name:'قدیر'},
    {id:'shohada', name:'بلوار شهدا'},
  ];

  // ساخت دکمه مناطق معروف (بالا)
  function renderAreasShort(selected = null) {
    const container = document.getElementById('areasShort');
    container.innerHTML = '';
    AREAS.slice(0, 6).forEach(area => {
      const btn = document.createElement('button');
      btn.className = 'area-btn' + (selected === area.id ? ' active' : '');
      btn.innerText = area.name;
      btn.onclick = () => {
        current.area = (current.area === area.id) ? null : area.id;
        renderAreasShort(current.area);
        loadAllShops();
      }
      container.appendChild(btn);
    });
  }

  // مقدار جستجو و دسته‌بندی و منطقه
  let current = { area: null, category: "", search: "" };

  document.getElementById('categorySelect').onchange = function () {
    current.category = this.value;
    loadAllShops();
  }
  document.getElementById('searchInput').oninput = function () {
    current.search = this.value;
    loadAllShops();
  }
  document.getElementById('all-centers-btn').onclick = () => {
    current.area = null;
    renderAreasShort();
    loadAllShops();
    window.scrollTo({ top: document.getElementById('areasShort').offsetTop - 60, behavior: 'smooth' });
  };

  // دریافت و نمایش مغازه‌های واقعی از بک‌اند + فیلتر سمت کلاینت
  async function loadAllShops() {
    const list = document.getElementById('shopsList');
    const empty = document.getElementById('noResult');
    list.innerHTML = '<div style="margin: 50px auto;">در حال بارگذاری...</div>';
    empty.classList.add('hidden');

    try {
      // آدرس سرور رو تنظیم کن
      const res = await fetch('http://localhost:5000/api/shops');
      const shops = await res.json();

      // فیلتر بر اساس انتخاب فعلی
      let filtered = shops.filter(shop =>
        (!current.area || shop.area === current.area) &&
        (!current.category || shop.category === current.category) &&
        (
          !current.search ||
          (shop.storename && shop.storename.includes(current.search)) ||
          (shop.address && shop.address.includes(current.search))
        )
      );

      list.innerHTML = '';

      if (!filtered.length) {
        empty.classList.remove('hidden');
        return;
      }

filtered.forEach(shop => {
  // پیدا کردن اسم منطقه (فارسی)
  let areaName = '';
  if (shop.area) {
    const foundArea = AREAS.find(a => a.id === shop.area);
    if (foundArea) areaName = foundArea.name;
    else areaName = shop.area;
  }

  // کارت مغازه فوق رسپانسیو و عکس درست
  const card = document.createElement('div');
  card.className = `
    shop-card flex flex-col justify-between items-stretch
    p-3 sm:p-4 group transition-all duration-200
    relative hover:-translate-y-1 hover:shadow-2xl
  `;

  card.innerHTML = `
    <div class="relative w-full aspect-[4/3] mb-4 rounded-xl overflow-hidden
                flex items-center justify-center
                bg-gradient-to-tr from-[#e0fdfa] to-[#e0f7fa]
                border-2 border-[#10b98112] group-hover:border-[#10b98144] shadow">
      <img
        src="${shop.boardImage || shop.banner || 'assets/images/shop-default.png'}"
        alt="${shop.storename}"
        loading="lazy"
        class="w-full h-full object-cover object-center transition-all duration-200 group-hover:scale-105"
        style="aspect-ratio:4/3;max-height:260px;"
      />
      <span class="absolute top-2 left-2 bg-[#10b981] text-white text-xs font-bold px-2 py-1 rounded-full shadow group-hover:bg-[#0ea5e9] transition-all duration-150">جدید</span>
    </div>
    <div class="w-full flex flex-row-reverse items-center justify-between mb-2 gap-1">
      <span class="inline-block bg-[#10b981]/10 text-[#10b981] text-[12px] font-extrabold px-2 py-1 rounded-full ml-1">${shop.category || ''}</span>
      <span class="inline-block bg-[#0ea5e9]/10 text-[#0ea5e9] text-[12px] font-extrabold px-2 py-1 rounded-full">${areaName}</span>
    </div>
    <h4 class="font-bold text-base sm:text-lg text-[#10b981] text-center mb-2 truncate w-full group-hover:text-[#0ea5e9] transition-all">${shop.storename}</h4>
    <div class="text-[#13bfa4] font-extrabold text-sm mb-1">${shop.address || ''}</div>
    ${shop.phone ? `<div class="text-gray-400 text-xs font-bold mt-1 flex items-center gap-1 justify-center"><svg width="16" height="16" viewBox="0 0 24 24" fill="#10b981"><path d="M6.62 10.79a15.054 15.054 0 006.59 6.59l2.2-2.2a1.003 1.003 0 011.01-.24c1.12.37 2.33.57 3.58.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1C10.07 21 3 13.93 3 5c0-.55.45-1 1-1h3.01c.55 0 1 .45 1 1 0 1.25.2 2.46.57 3.59a1 1 0 01-.24 1.01l-2.2 2.19z"/></svg> ${shop.phone}</div>` : ''}
    <div class="flex-1"></div>
    <a href="shop.html?shopurl=${shop.shopurl}" class="w-full inline-block mt-4 bg-gradient-to-l from-[#10b981] to-[#0ea5e9] hover:from-[#0ea5e9] hover:to-[#10b981] rounded-full px-4 py-2 text-white font-extrabold text-sm shadow transition-all duration-200 text-center">
      مشاهده فروشگاه
    </a>
  `;
  list.appendChild(card);
});


    } catch (e) {
      list.innerHTML = '<div class="text-red-500 text-center w-full p-8">مشکل در ارتباط با سرور!</div>';
    }
  }

  // اجرای اولیه
  renderAreasShort();
  window.addEventListener('DOMContentLoaded', loadAllShops);
</script>

</body>
</html>
