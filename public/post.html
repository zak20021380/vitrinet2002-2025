<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ø«Ø¨Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡ - ÙˆÛŒØªØ±ÛŒÙ†Øª</title>
  <meta name="description" content="ÙØ±Ù… Ø«Ø¨Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø¬Ø¯ÛŒØ¯ Ø¯Ø± ÙˆÛŒØªØ±ÛŒÙ†Øª Ø¨Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø§Ù… Ùˆ Ø¢Ø¯Ø±Ø³ Ø§Ø®ØªØµØ§ØµÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡. Ù‡Ù…ÛŒÙ† Ø­Ø§Ù„Ø§ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø¢Ù†Ù„Ø§ÛŒÙ† Ø®ÙˆØ¯ Ø±Ø§ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ú©Ù†ÛŒØ¯!" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Vazirmatn', sans-serif;
      background: linear-gradient(115deg, #e0fdfa 0%, #f8fafc 60%, #d4fbe8 100%);
      min-height: 100vh;
    }
    .glass {
      background: rgba(255,255,255,0.92);
      box-shadow: 0 10px 38px #10b98119, 0 2px 10px #0ea5e914;
      border-radius: 1.5rem;
      backdrop-filter: blur(10px);
    }
    .brand-btn {
      background: linear-gradient(90deg, #10b981 10%, #0ea5e9 100%);
      color: #fff !important;
      font-weight: bold;
      border-radius: 1rem;
      transition: all .17s;
      box-shadow: 0 2px 12px #10b98126;
    }
    .brand-btn:hover { filter: brightness(1.08);}
    .primary-text { color: #10b981; }
    input[type="password"]:invalid {
      background: #fef2f2;
      border-color: #ef4444;
    }
    
    /* Enhanced mobile header styles */

      .nav-links {
        position: fixed;
        top: 0;
        right: -100%;
        width: 70%;
        max-width: 280px;
        height: 100vh;
        background: white;
        box-shadow: -2px 0 10px rgba(0,0,0,0.1);
        transition: right 0.3s ease;
        z-index: 100;
        padding: 1.5rem;
        overflow-y: auto;
      }
      .nav-links.active {
        right: 0;
      }
      .mobile-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 99;
        display: none;
      }
      .mobile-overlay.active {
        display: block;
      }
      .glass {
        padding: 1.25rem !important;
      }
    }
    
    @media (max-width: 400px) {
      .glass {
        padding: 1rem !important;
        border-radius: 1.25rem;
      }
      .header-logo {
        font-size: 1.25rem !important;
      }
    }
    
    .fadein { animation: fadein .7s; }
    @keyframes fadein {
      from { opacity: 0; transform: translateY(30px);}
      to   { opacity: 1; transform: translateY(0);}
    }
    #category.open {
      position: absolute;
      z-index: 50;
      background: #fff;
      width: 100%;
      max-height: 15rem;
      overflow-y: auto;
    }
    
    /* Optimized hamburger menu */
    .hamburger {
      width: 24px;
      height: 20px;
      position: relative;
      cursor: pointer;
      display: inline-block;
      z-index: 101;
    }
    .hamburger span {
      background: #374151;
      border-radius: 2px;
      height: 3px;
      width: 100%;
      position: absolute;
      transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      left: 0;
    }
    .hamburger span:nth-child(1) { top: 0; }
    .hamburger span:nth-child(2) { top: 8px; }
    .hamburger span:nth-child(3) { top: 16px; }
    .hamburger.active span:nth-child(1) {
      transform: rotate(45deg);
      top: 8px;
    }
    .hamburger.active span:nth-child(2) {
      opacity: 0;
    }
    .hamburger.active span:nth-child(3) {
      transform: rotate(-45deg);
      top: 8px;
    }
  </style>
  <script src="/nav-active.js" defer></script>
</head>
<body class="text-gray-800">

  <!-- Enhanced Mobile-First Header -->
  <header class="w-full bg-white/95 shadow-sm backdrop-blur-md sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <!-- Logo -->
        <div class="flex-shrink-0">
          <a href="index.html" class="header-logo font-bold text-[1.5rem] sm:text-[1.75rem] md:text-[2rem] bg-gradient-to-l from-[#11d6ad] via-[#10b981] to-[#2db4e8] bg-clip-text text-transparent" style="letter-spacing:1.5px;">ÙˆÛŒØªØ±ÛŒÙ†Øª</a>
        </div>
        
        <!-- Desktop Navigation -->
        <nav class="hidden sm:flex items-center space-x-1 sm:space-x-2 md:space-x-4 rtl:space-x-reverse">
          <a href="index.html" class="text-gray-700 hover:text-[#10b981] font-medium px-3 py-2 text-sm md:text-base transition-colors duration-200">Ø®Ø§Ù†Ù‡</a>
          <a href="categories.html" class="text-gray-700 hover:text-[#0ea5e9] font-medium px-3 py-2 text-sm md:text-base transition-colors duration-200">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</a>
          <a href="login.html" class="text-gray-700 hover:text-[#0ea5e9] font-medium px-3 py-2 text-sm md:text-base transition-colors duration-200">ÙˆØ±ÙˆØ¯</a>
        </nav>
        
        <!-- Mobile menu button -->
<button class="mobile-menu-btn hamburger sm:hidden" id="mobile-menu-btn" aria-label="Ù…Ù†ÙˆÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </div>
    
    <!-- Mobile Navigation -->
    <div class="nav-links sm:hidden" id="mobile-menu">
      <div class="flex items-center justify-between mb-6">
        <span class="font-bold text-lg text-gray-800">Ù…Ù†Ùˆ</span>
        <button class="text-gray-500 hover:text-gray-700" id="close-menu">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <div class="space-y-3">
        <a href="index.html" class="block text-gray-700 hover:text-[#10b981] font-medium py-3 px-4 rounded-lg hover:bg-gray-50 transition-all duration-200">Ø®Ø§Ù†Ù‡</a>
        <a href="categories.html" class="block text-gray-700 hover:text-[#0ea5e9] font-medium py-3 px-4 rounded-lg hover:bg-gray-50 transition-all duration-200">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</a>
        <a href="login.html" class="block text-gray-700 hover:text-[#0ea5e9] font-medium py-3 px-4 rounded-lg hover:bg-gray-50 transition-all duration-200">ÙˆØ±ÙˆØ¯</a>
      </div>
    </div>
    
    <!-- Mobile Overlay -->
    <div class="mobile-overlay" id="mobile-overlay"></div>
  </header>

  <!-- ÙØ±Ù… Ø«Ø¨Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡ -->
<main class="max-w-xl mx-auto min-h-screen flex flex-col justify-center items-center px-2" style="margin-top:48px;">
    <section class="glass border rounded-2xl shadow-2xl p-6 sm:p-10" id="register-section">
      <h2 class="text-2xl sm:text-3xl font-extrabold primary-text mb-7 text-center">Ø«Ø¨Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø¬Ø¯ÛŒØ¯</h2>
<form class="space-y-5" id="signup-form" autocomplete="off" novalidate>

  <!-- Ù†Ø§Ù… ÙØ±ÙˆØ´Ù†Ø¯Ù‡ -->
  <div>
    <label class="block text-sm font-bold mb-1">Ù†Ø§Ù… ÙØ±ÙˆØ´Ù†Ø¯Ù‡ <span class="text-red-500">*</span></label>
    <input required type="text" name="firstname" id="firstname" class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-green-200" placeholder="Ù…Ø«Ù„Ø§Ù‹ Ø¹Ù„ÛŒ" />
    <div id="firstname-hint" class="text-xs mt-2 text-red-500 hidden"></div>
  </div>

  <!-- Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ ÙØ±ÙˆØ´Ù†Ø¯Ù‡ -->
  <div>
    <label class="block text-sm font-bold mb-1">Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ ÙØ±ÙˆØ´Ù†Ø¯Ù‡ <span class="text-red-500">*</span></label>
    <input required type="text" name="lastname" id="lastname" class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-green-200" placeholder="Ù…Ø«Ù„Ø§Ù‹ Ø­Ø³ÛŒÙ†ÛŒ" />
    <div id="lastname-hint" class="text-xs mt-2 text-red-500 hidden"></div>
  </div>

  <!-- Ù†Ø§Ù… ÙØ±ÙˆØ´Ú¯Ø§Ù‡ -->
  <div>
    <label class="block text-sm font-bold mb-1">Ù†Ø§Ù… ÙØ±ÙˆØ´Ú¯Ø§Ù‡ <span class="text-red-500">*</span></label>
    <input required type="text" name="storename" id="storename" class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-green-200" placeholder="Ù…Ø«Ù„Ø§Ù‹ Ú¯Ù„â€ŒÙØ±ÙˆØ´ Ù…Ø±Ú©Ø²ÛŒ" />
    <div id="storename-hint" class="text-xs mt-2 text-red-500 hidden"></div>
  </div>

  <!-- Ù†Ù…Ø§ÛŒØ´ Ùˆ Ø³Ø§Ø®Øª Ø¢Ø¯Ø±Ø³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ -->
  <div>
    <label class="block text-sm font-bold mb-1 flex items-center gap-1">
      Ù†Ø§Ù… Ø¢Ø¯Ø±Ø³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ <span class="text-red-500">*</span>
      <span class="ml-2 text-xs text-gray-500 font-normal">(ÙÙ‚Ø· Ø­Ø±ÙˆÙ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ Ú©ÙˆÚ†Ú© Ùˆ Ø¹Ø¯Ø¯ØŒ Ø­Ø¯Ø§Ù‚Ù„ Û´ Ùˆ Ø­Ø¯Ø§Ú©Ø«Ø± Û±Û° Ú©Ø§Ø±Ø§Ú©ØªØ±ØŒ Ø¨Ø¯ÙˆÙ† ÙØ§ØµÙ„Ù‡ Ùˆ Ú©Ø§Ø±Ø§Ú©ØªØ± Ø®Ø§Øµ)</span>
    </label>
    <div class="flex items-center gap-2">
      <span class="whitespace-nowrap text-xs sm:text-base text-gray-500">vitreenet.ir/</span>
      <input required type="text" name="shopurl" id="shopurl"
        pattern="^[a-z0-9]{4,10}$"
        class="flex-1 p-3 border rounded-xl focus:ring-2 focus:ring-green-200 text-left ltr"
        placeholder="shopgol" maxlength="10" autocomplete="off" />
    </div>
    <div class="mt-2">
      <span class="text-xs bg-gray-100 rounded p-1" id="address-preview">Ø¢Ø¯Ø±Ø³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø´Ù…Ø§: vitreenet.ir/shopgol</span>
    </div>
    <div class="text-xs text-gray-500 mt-2 bg-gray-50 rounded p-2">
      <strong>Ø±Ø§Ù‡Ù†Ù…Ø§:</strong>
      <ul class="list-disc pr-5 mt-1">
        <li>ÙÙ‚Ø· Ø§Ø² Ø­Ø±ÙˆÙ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ Ú©ÙˆÚ†Ú© Ùˆ Ø¹Ø¯Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</li>
        <li>Ø­Ø¯Ø§Ù‚Ù„ Û´ Ùˆ Ø­Ø¯Ø§Ú©Ø«Ø± Û±Û° Ú©Ø§Ø±Ø§Ú©ØªØ±.</li>
        <li>Ø§Ø² ÙØ§ØµÙ„Ù‡ Ùˆ Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ Ø®Ø§Øµ (Ù…Ø«Ù„ @, #, !, ØŸ Ùˆ ...) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†ÛŒØ¯.</li>
        <li>Ø§ÛŒÙ† Ù†Ø§Ù… Ø¨Ø®Ø´ÛŒ Ø§Ø² Ø¢Ø¯Ø±Ø³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø´Ù…Ø§ Ø®ÙˆØ§Ù‡Ø¯ Ø¨ÙˆØ¯ (<b>vitreenet.ir/</b>).</li>
        <li>Ù…Ø«Ø§Ù„: <b>shopgol</b> | <b>cakebox</b> | <b>bookcity</b></li>
      </ul>
      <div id="shopurl-hint" class="text-red-500 mt-2 hidden"></div>
    </div>
  </div>
  <!-- Ù¾Ø§ÛŒØ§Ù† Ø³Ø§Ø®Øª Ø¢Ø¯Ø±Ø³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ -->

  <div>
    <label class="block text-sm font-bold mb-1">Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ <span class="text-red-500">*</span></label>
    <input required type="tel" id="phone" pattern="^09\d{9}$" name="phone" class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-green-200" placeholder="0912xxxxxxx" />
    <div id="phone-hint" class="text-xs mt-2 text-red-500 hidden"></div>
  </div>

  <div class="relative">
    <label class="block text-sm font-bold mb-1">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ <span class="text-red-500">*</span></label>
    <select required name="category" id="category" class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-green-200 bg-white">
      <option value="" disabled selected>Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</option>
    </select>

    <!-- START: service examples (visible only for service categories) -->
<div id="service-examples" class="hidden mt-2 rounded-xl border border-gray-200 bg-gray-50 p-2.5">
  <div class="text-xs text-gray-600 mb-1.5">Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø±Ø§ÛŒØ¬ <span class="font-bold">Ø®Ø¯Ù…Ø§Øª</span>:</div>
  <div class="flex flex-wrap gap-2">
    <button type="button" data-svc-example="Ø¢Ø±Ø§ÛŒØ´Ú¯Ø§Ù‡ Ù…Ø±Ø¯Ø§Ù†Ù‡" class="px-3 py-1.5 rounded-full text-xs bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 active:scale-[.98]">Ø¢Ø±Ø§ÛŒØ´Ú¯Ø§Ù‡ Ù…Ø±Ø¯Ø§Ù†Ù‡</button>
    <button type="button" data-svc-example="Ø¢Ø±Ø§ÛŒØ´Ú¯Ø§Ù‡ Ø²Ù†Ø§Ù†Ù‡" class="px-3 py-1.5 rounded-full text-xs bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 active:scale-[.98]">Ø¢Ø±Ø§ÛŒØ´Ú¯Ø§Ù‡ Ø²Ù†Ø§Ù†Ù‡</button>
    <button type="button" data-svc-example="Ú©Ø§Ø±ÙˆØ§Ø´" class="px-3 py-1.5 rounded-full text-xs bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 active:scale-[.98]">Ú©Ø§Ø±ÙˆØ§Ø´</button>
    <button type="button" data-svc-example="Ú©Ù„ÛŒÙ†ÛŒÚ© Ø²ÛŒØ¨Ø§ÛŒÛŒ" class="px-3 py-1.5 rounded-full text-xs bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 active:scale-[.98]">Ú©Ù„ÛŒÙ†ÛŒÚ© Ø²ÛŒØ¨Ø§ÛŒÛŒ</button>
    <button type="button" data-svc-example="ØªØ¹Ù…ÛŒØ± Ù…ÙˆØ¨Ø§ÛŒÙ„" class="px-3 py-1.5 rounded-full text-xs bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 active:scale-[.98]">ØªØ¹Ù…ÛŒØ± Ù…ÙˆØ¨Ø§ÛŒÙ„</button>
    <button type="button" data-svc-example="Ø¢ØªÙ„ÛŒÙ‡ Ø¹Ú©Ø§Ø³ÛŒ" class="px-3 py-1.5 rounded-full text-xs bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 active:scale-[.98]">Ø¢ØªÙ„ÛŒÙ‡ Ø¹Ú©Ø§Ø³ÛŒ</button>
    <button type="button" data-svc-example="Ø®ÛŒØ§Ø·ÛŒ" class="px-3 py-1.5 rounded-full text-xs bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 active:scale-[.98]">Ø®ÛŒØ§Ø·ÛŒ</button>
    <button type="button" data-svc-example="Ø¢Ø±Ø§ÛŒØ´ Ø­ÛŒÙˆØ§Ù†Ø§Øª" class="px-3 py-1.5 rounded-full text-xs bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 active:scale-[.98]">Ø¢Ø±Ø§ÛŒØ´ Ø­ÛŒÙˆØ§Ù†Ø§Øª</button>
  </div>
  <div class="text-[11px] text-gray-500 mt-2">Ø¨Ø§ Ù„Ù…Ø³ Ù‡Ø± Ù…ÙˆØ±Ø¯ØŒ Ù…ØªÙ† Ø¢Ù† Ø¨Ù‡ Â«ØªÙˆØ¶ÛŒØ­Ø§Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡Â» Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</div>
</div>
<!-- END: service examples -->

    <div id="category-hint" class="text-xs mt-2 text-red-500 hidden"></div>
  </div>

  <div id="subcategory-wrapper" class="hidden">
    <label class="block text-sm font-bold mb-1">Ø²ÛŒØ± Ø¯Ø³ØªÙ‡ <span class="text-red-500">*</span></label>
    <div id="subcategory-chips" class="flex flex-wrap gap-2">
      <span class="text-xs text-gray-500">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</span>
    </div>
    <input type="hidden" id="subcategory" />
    <div id="subcategory-hint" class="text-xs mt-2 text-red-500 hidden"></div>
  </div>

  <div>
    <label class="block text-sm font-bold mb-1">Ø´Ù‡Ø±</label>
    <input type="text" readonly value="Ø³Ù†Ù†Ø¯Ø¬" class="w-full p-3 border rounded-xl bg-gray-100 text-gray-500 focus:ring-0 cursor-not-allowed" />
  </div>

  <div>
    <label class="block text-sm font-bold mb-1">Ø¢Ø¯Ø±Ø³ Ø¯Ù‚ÛŒÙ‚ <span class="text-red-500">*</span></label>
    <input required type="text" name="address" id="address" class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-green-200" placeholder="Ø®ÛŒØ§Ø¨Ø§Ù†ØŒ Ú©ÙˆÚ†Ù‡ØŒ Ù¾Ù„Ø§Ú©..." />
    <div id="address-hint" class="text-xs mt-2 text-red-500 hidden"></div>
  </div>

  <div>
    <label class="block text-sm font-bold mb-1">ØªÙˆØ¶ÛŒØ­Ø§Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡</label>
    <textarea name="desc" class="w-full p-3 border rounded-xl resize-none focus:ring-2 focus:ring-green-200" rows="3" placeholder="ØªÙˆØ¶ÛŒØ­ÛŒ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù†ÙˆØ¹ Ø®Ø¯Ù…Ø§Øª ÛŒØ§ Ù…Ø­ØµÙˆÙ„Ø§Øª..."></textarea>
  </div>

  <div>
    <label class="block text-sm font-bold mb-1 flex items-center gap-1">
      Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± <span class="text-red-500">*</span>
      <span class="ml-2 text-xs text-gray-500 font-normal">(Ø­Ø¯Ø§Ù‚Ù„ Û¸ Ú©Ø§Ø±Ø§Ú©ØªØ±ØŒ Ø´Ø§Ù…Ù„ Ø¹Ø¯Ø¯ØŒ Ø­Ø±Ù Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ Ùˆ Ù†Ù…Ø§Ø¯)</span>
    </label>
    <input required type="password" id="pass1" minlength="8"
      class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-green-200" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ù‚ÙˆÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" autocomplete="new-password" />
  </div>

  <div>
    <label class="block text-sm font-bold mb-1">ØªÚ©Ø±Ø§Ø± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± <span class="text-red-500">*</span></label>
    <input required type="password" id="pass2" minlength="8"
      class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-green-200" placeholder="Ø±Ù…Ø² Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" autocomplete="new-password" />
    <div id="pass-hint" class="text-xs mt-2 text-red-500 hidden"></div>
  </div>

  <!-- Ù‚ÙˆØ§Ù†ÛŒÙ† Ø³Ø§ÛŒØª -->
  <div class="flex items-center gap-2 mt-3">
    <input required type="checkbox" id="rules" class="accent-[#10b981] w-5 h-5 rounded border-gray-400" />
    <label for="rules" class="text-sm select-none">
      <span>Ù‚ÙˆØ§Ù†ÛŒÙ† Ø³Ø§ÛŒØª Ø±Ø§ Ù…Ø·Ø§Ù„Ø¹Ù‡ Ú©Ø±Ø¯Ù‡â€ŒØ§Ù… Ùˆ Ù‚Ø¨ÙˆÙ„ Ø¯Ø§Ø±Ù….</span>
      <a href="rules.html" target="_blank" class="text-[#0ea5e9] underline hover:text-[#10b981]">Ù…Ø·Ø§Ù„Ø¹Ù‡ Ù‚ÙˆØ§Ù†ÛŒÙ†</a>
    </label>
  </div>
  <div id="rules-hint" class="text-xs mt-2 text-red-500 hidden"></div>

  <button type="submit" class="w-full brand-btn text-white py-3 rounded-xl font-bold text-lg shadow-md hover:opacity-90 transition mt-2">
    Ø«Ø¨Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡
  </button>

  <div id="pass-guide" class="text-xs text-gray-500 mt-1 text-center">
    Ø±Ù…Ø² Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û¸ Ú©Ø§Ø±Ø§Ú©ØªØ± Ùˆ ØªØ±Ú©ÛŒØ¨ÛŒ Ø§Ø² Ø§Ø¹Ø¯Ø§Ø¯ØŒ Ø­Ø±ÙˆÙ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ Ùˆ Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒÛŒ Ù…Ø«Ù„ ! @ # $ % ^ & * Ø¨Ø§Ø´Ø¯.
  </div>
</form>

    </section>

    <!-- Ù…Ø±Ø­Ù„Ù‡ ØªØ§ÛŒÛŒØ¯ Ú©Ø¯ Ù¾ÛŒØ§Ù…Ú©ÛŒ -->
    <section class="glass border rounded-2xl shadow-2xl p-6 sm:p-10 fadein hidden" id="verify-section">
      <h2 class="text-xl sm:text-2xl font-extrabold text-[#10b981] mb-4 text-center">ØªØ£ÛŒÛŒØ¯ Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„</h2>
      <div class="text-center text-gray-600 text-sm mb-6">
        Ú©Ø¯ Ûµ Ø±Ù‚Ù…ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡ Ø¨Ù‡ Ø´Ù…Ø§Ø±Ù‡ <span id="verify-phone" class="font-bold text-gray-800"></span> Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.
        <div class="mt-2 text-xs text-gray-500">Ø§Ú¯Ø± Ù¾ÛŒØ§Ù…Ú© Ø¯Ø±ÛŒØ§ÙØª Ù†Ú©Ø±Ø¯ÛŒØ¯ØŒ ØªØ§ Û¶Û° Ø«Ø§Ù†ÛŒÙ‡ ØµØ¨Ø± Ú©Ù†ÛŒØ¯ ÛŒØ§ Ø´Ù…Ø§Ø±Ù‡ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ù†Ù…Ø§ÛŒÛŒØ¯.</div>
      </div>
      <form class="flex flex-col items-center gap-5" id="verify-form" autocomplete="off">
        <input type="text" inputmode="numeric" pattern="^\d{5}$" maxlength="5" id="sms-code" class="w-40 text-center border rounded-xl p-3 text-lg font-bold tracking-widest focus:ring-2 focus:ring-green-200" placeholder="-----" required />
        <div id="code-hint" class="text-xs text-red-500 hidden"></div>
        <button type="submit" class="w-full brand-btn text-white py-3 rounded-xl font-bold text-lg shadow-md hover:opacity-90 transition">
          ØªØ£ÛŒÛŒØ¯ Ú©Ø¯
        </button>
        <button type="button" id="resend-btn" class="text-xs text-[#0ea5e9] underline hover:text-[#10b981] mt-2" disabled>Ø§Ø±Ø³Ø§Ù„ Ù…Ø¬Ø¯Ø¯ Ú©Ø¯ <span id="resend-timer">(60)</span></button>
      </form>
    </section>
  </main>

  <!-- ÙÙˆØªØ± -->
  <footer class="mt-20 bg-white border-t text-center text-sm text-gray-500 py-4">
    Â© 2025 <span class="font-bold text-[#10b981]">ÙˆÛŒØªØ±ÛŒÙ†Øª</span> | Ù‡Ù…Ù‡ Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª.
  </footer>

<script>
  // Mobile menu functionality
  const mobileMenuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');
  const mobileOverlay = document.getElementById('mobile-overlay');
  const closeMenuBtn = document.getElementById('close-menu');

  function toggleMobileMenu() {
    mobileMenuBtn.classList.toggle('active');
    mobileMenu.classList.toggle('active');
    mobileOverlay.classList.toggle('active');
    document.body.style.overflow = mobileMenu.classList.contains('active') ? 'hidden' : '';
  }

  mobileMenuBtn.addEventListener('click', toggleMobileMenu);
  closeMenuBtn.addEventListener('click', toggleMobileMenu);
  mobileOverlay.addEventListener('click', toggleMobileMenu);

  // Close menu when clicking on a link
  document.querySelectorAll('.nav-links a').forEach(link => {
    link.addEventListener('click', () => {
      if (mobileMenu.classList.contains('active')) {
        toggleMobileMenu();
      }
    });
  });

  // Ù†Ù…Ø§ÛŒØ´ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ Ø¢Ø¯Ø±Ø³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡
  document.getElementById("shopurl").addEventListener("input", function (e) {
    let val = this.value.trim();
    // ÙÙ‚Ø· Ø­Ø±ÙˆÙ Ú©ÙˆÚ†Ú© Ùˆ Ø¹Ø¯Ø¯Ø› Ø¨ÛŒØ´ØªØ± Ø§Ø² 10 Ú©Ø§Ø±Ø§Ú©ØªØ± Ø§Ø¬Ø§Ø²Ù‡ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù† Ù†Ø¯Ù‡
    let cleaned = val.replace(/[^a-z0-9]/g, '').slice(0, 10);
    if (val !== cleaned) {
      this.value = cleaned;
    }
    let prev = document.getElementById("address-preview");
    if (cleaned.length > 0) {
      prev.innerText = "Ø¢Ø¯Ø±Ø³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø´Ù…Ø§: vitreenet.ir/" + cleaned;
    } else {
      prev.innerText = "Ø¢Ø¯Ø±Ø³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø´Ù…Ø§: vitreenet.ir/shopgol";
    }
    document.getElementById("shopurl-hint").classList.add("hidden");
  });

  // Ø±ÛŒØ³Øª Ù¾ÛŒØ§Ù… Ø®Ø·Ø§ Ø¨Ø§ ØªØºÛŒÛŒØ± Ù‡Ø± ÙÛŒÙ„Ø¯
  [
    ["firstname", "firstname-hint"],
    ["lastname", "lastname-hint"],
    ["pass1", "pass-hint"],
    ["pass2", "pass-hint"],
    ["storename", "storename-hint"],
    ["shopurl", "shopurl-hint"],
    ["phone", "phone-hint"],
    ["category", "category-hint"],
    ["address", "address-hint"],
    ["rules", "rules-hint"]
  ].forEach(function (pair) {
    let el = document.getElementById(pair[0]);
    if (el) {
      el.addEventListener("input", function () {
        document.getElementById(pair[1]).classList.add("hidden");
      });
      if (["category", "rules"].includes(pair[0])) {
        el.addEventListener("change", function () {
          document.getElementById(pair[1]).classList.add("hidden");
        });
      }
    }
  });

  const API_ORIGIN = window.location.origin.includes('localhost') ? 'http://localhost:5000' : window.location.origin;
  const CATEGORY_API_URL = `${API_ORIGIN}/api/categories`;
  const CATEGORY_CACHE_KEY = 'post.categories.cache';
  const SERVICE_CACHE_KEY = 'post.serviceSubcategories.cache';
  const CATEGORY_CACHE_TTL_MS = 1000 * 60 * 30; // 30 Ø¯Ù‚ÛŒÙ‚Ù‡

  const DEFAULT_CATEGORIES = [
    'Ù¾ÙˆØ´Ø§Ú©',
    'Ø®ÙˆØ±Ø§Ú©',
    'Ø®Ø¯Ù…Ø§Øª',
    'Ø¯ÛŒØ¬ÛŒØªØ§Ù„',
    'Ø²ÛŒØ¨Ø§ÛŒÛŒ',
    'Ú©ØªØ§Ø¨ Ùˆ ØªØ­Ø±ÛŒØ±',
    'Ù„ÙˆØ§Ø²Ù… Ø®Ø§Ù†Ú¯ÛŒ',
    'ÙˆØ±Ø²Ø´ÛŒ',
    'ØªØ§Ù„Ø§Ø± Ùˆ Ù…Ø¬Ø§Ù„Ø³',
    'Ù‚Ù†Ø§Ø¯ÛŒ Ùˆ Ø´ÛŒØ±ÛŒÙ†ÛŒ',
    'Ú¯Ù„ Ùˆ Ú¯ÛŒØ§Ù‡',
    'Ø®ÙˆØ¯Ø±Ùˆ',
    'Ú©ÙˆØ¯Ú©Ø§Ù†'
  ];

  const DEFAULT_SERVICE_SUBCATEGORIES = [
    'Ø¢Ø±Ø§ÛŒØ´Ú¯Ø§Ù‡ Ù…Ø±Ø¯Ø§Ù†Ù‡',
    'Ø¢Ø±Ø§ÛŒØ´Ú¯Ø§Ù‡ Ø²Ù†Ø§Ù†Ù‡',
    'Ú©Ø§Ø±ÙˆØ§Ø´',
    'Ú©Ù„ÛŒÙ†ÛŒÚ© Ø²ÛŒØ¨Ø§ÛŒÛŒ',
    'ØªØ¹Ù…ÛŒØ± Ù…ÙˆØ¨Ø§ÛŒÙ„',
    'Ø¢ØªÙ„ÛŒÙ‡ Ø¹Ú©Ø§Ø³ÛŒ',
    'Ø®ÛŒØ§Ø·ÛŒ',
    'Ø¢Ø±Ø§ÛŒØ´ Ø­ÛŒÙˆØ§Ù†Ø§Øª'
  ];

  const categorySelect = document.getElementById("category");
  const subcatWrapper = document.getElementById("subcategory-wrapper");
  const subcatInput = document.getElementById("subcategory");
  const subcatChipsContainer = document.getElementById('subcategory-chips');

  function toIdString(raw) {
    if (!raw) return '';
    if (typeof raw === 'string') return raw;
    if (typeof raw === 'object') {
      if (raw.$oid) return String(raw.$oid);
      if (raw._id) return String(raw._id);
      if (raw.id) return String(raw.id);
    }
    return String(raw);
  }

  function normaliseCategoryText(value) {
    if (!value) return '';
    return String(value).replace(/\s+/g, ' ').trim();
  }

  function normaliseCategoryItem(raw, fallbackType = 'category') {
    if (!raw) return null;
    if (typeof raw === 'string') {
      const name = normaliseCategoryText(raw);
      if (!name) return null;
      return {
        id: '',
        name,
        type: fallbackType,
        isDefault: fallbackType === 'service-subcategory'
          ? DEFAULT_SERVICE_SUBCATEGORIES.includes(name)
          : DEFAULT_CATEGORIES.includes(name)
      };
    }
    const name = normaliseCategoryText(raw.name || raw.title || raw.label || '');
    if (!name) return null;
    const id = toIdString(raw._id || raw.id || raw.value || '');
    const type = raw.type || fallbackType;
    return {
      id,
      name,
      type,
      isDefault: typeof raw.isDefault === 'boolean'
        ? raw.isDefault
        : (type === 'service-subcategory'
            ? DEFAULT_SERVICE_SUBCATEGORIES.includes(name)
            : DEFAULT_CATEGORIES.includes(name))
    };
  }

  function normaliseCategoryList(list = [], type = 'category') {
    const unique = new Map();
    list.forEach(item => {
      const record = normaliseCategoryItem(item, type);
      if (!record) return;
      const key = record.name.toLocaleLowerCase('fa-IR');
      if (!unique.has(key) || (!unique.get(key).id && record.id)) {
        unique.set(key, record);
      }
    });
    return Array.from(unique.values()).sort((a, b) => a.name.localeCompare(b.name, 'fa-IR', { sensitivity: 'base' }));
  }

  function saveCategoryCache(key, list) {
    try {
      if (typeof localStorage === 'undefined') return;
      const payload = {
        items: Array.isArray(list) ? list.map(item => ({
          id: item.id || '',
          name: item.name,
          type: item.type,
          isDefault: !!item.isDefault
        })) : [],
        updatedAt: Date.now()
      };
      localStorage.setItem(key, JSON.stringify(payload));
    } catch (err) {
      console.warn('saveCategoryCache ->', err);
    }
  }

  function loadCategoryCache(key, fallback = [], type = 'category') {
    try {
      if (typeof localStorage === 'undefined') {
        return normaliseCategoryList(fallback, type);
      }
      const raw = localStorage.getItem(key);
      if (!raw) {
        return normaliseCategoryList(fallback, type);
      }
      const parsed = JSON.parse(raw);
      const updatedAt = Number(parsed?.updatedAt || 0);
      if (updatedAt && Date.now() - updatedAt > CATEGORY_CACHE_TTL_MS) {
        localStorage.removeItem(key);
        return normaliseCategoryList(fallback, type);
      }
      const list = Array.isArray(parsed?.items) ? parsed.items : Array.isArray(parsed) ? parsed : [];
      const normalised = normaliseCategoryList(list, type);
      if (!normalised.length) {
        return normaliseCategoryList(fallback, type);
      }
      return normalised;
    } catch (err) {
      console.warn('loadCategoryCache ->', err);
      return normaliseCategoryList(fallback, type);
    }
  }

  function renderCategoryOptions(list = []) {
    if (!categorySelect) return;
    const options = normaliseCategoryList(list, 'category');
    const previous = categorySelect.value;
    categorySelect.innerHTML = '';
    const placeholder = document.createElement('option');
    placeholder.value = '';
    placeholder.disabled = true;
    placeholder.selected = true;
    placeholder.textContent = options.length ? 'Ø§Ù†ØªØ®Ø§Ø¨ Ø¯Ø³ØªÙ‡' : 'Ø¯Ø³ØªÙ‡â€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯';
    categorySelect.appendChild(placeholder);
    options.forEach(item => {
      const option = document.createElement('option');
      option.value = item.name;
      option.textContent = item.name;
      if (item.id) {
        option.dataset.id = item.id;
      }
      categorySelect.appendChild(option);
    });
    categorySelect.disabled = !options.length;
    if (options.some(item => item.name === previous)) {
      categorySelect.value = previous;
      placeholder.selected = false;
    }
  }

  function highlightServiceChip(value = '') {
    if (!subcatChipsContainer) return;
    const buttons = subcatChipsContainer.querySelectorAll('button[data-value]');
    buttons.forEach(btn => {
      btn.classList.remove('bg-[#10b981]', 'text-white', 'border-[#10b981]');
      if (btn.dataset.value === value) {
        btn.classList.add('bg-[#10b981]', 'text-white', 'border-[#10b981]');
      }
    });
  }

  function renderServiceChips(list = []) {
    if (!subcatChipsContainer) return;
    const selected = subcatInput ? subcatInput.value : '';
    const normalised = normaliseCategoryList(list, 'service-subcategory');
    subcatChipsContainer.innerHTML = '';
    if (!normalised.length) {
      const span = document.createElement('span');
      span.className = 'text-xs text-gray-500';
      span.textContent = 'Ø²ÛŒØ±Ú¯Ø±ÙˆÙ‡ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.';
      subcatChipsContainer.appendChild(span);
      return;
    }
    normalised.forEach(item => {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.dataset.value = item.name;
      if (item.id) {
        btn.dataset.id = item.id;
      }
      btn.className = 'px-4 py-2 border border-gray-300 rounded-full text-sm bg-white text-gray-700 hover:bg-gray-100';
      btn.textContent = item.name;
      if (item.name === selected) {
        btn.classList.add('bg-[#10b981]', 'text-white', 'border-[#10b981]');
      }
      subcatChipsContainer.appendChild(btn);
    });
    if (selected) {
      highlightServiceChip(selected);
    }
  }

  function applyCategoryPayload(data = {}) {
    const payload = data && typeof data === 'object' ? data : {};
    const categories = normaliseCategoryList(payload?.categories, 'category');
    const services = normaliseCategoryList(payload?.serviceSubcategories, 'service-subcategory');
    const categoriesProvided = Object.prototype.hasOwnProperty.call(payload, 'categories');
    const servicesProvided = Object.prototype.hasOwnProperty.call(payload, 'serviceSubcategories');
    const categoriesToUse = categoriesProvided
      ? categories
      : categories.length
        ? categories
        : normaliseCategoryList(DEFAULT_CATEGORIES, 'category');
    const servicesToUse = servicesProvided
      ? services
      : services.length
        ? services
        : normaliseCategoryList(DEFAULT_SERVICE_SUBCATEGORIES, 'service-subcategory');
    renderCategoryOptions(categoriesToUse);
    renderServiceChips(servicesToUse);
    saveCategoryCache(CATEGORY_CACHE_KEY, categoriesToUse);
    saveCategoryCache(SERVICE_CACHE_KEY, servicesToUse);
  }

  async function fetchCategoryDataForForm({ silent = false } = {}) {
    try {
      const res = await fetch(CATEGORY_API_URL, { credentials: 'include' });
      const data = await res.json().catch(() => ({}));
      if (!res.ok) {
        throw new Error(data?.message || 'Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§.');
      }
      applyCategoryPayload(data);
      if (!silent) {
        showToast('Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯ âœ…');
      }
    } catch (error) {
      console.warn('fetchCategoryDataForForm ->', error);
      if (!silent) {
        showToast(error.message || 'Ø§Ù…Ú©Ø§Ù† Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ Ù†Ø¨ÙˆØ¯ â—ï¸');
      }
    }
  }

  const cachedCategories = loadCategoryCache(CATEGORY_CACHE_KEY, DEFAULT_CATEGORIES, 'category');
  const cachedServices = loadCategoryCache(SERVICE_CACHE_KEY, DEFAULT_SERVICE_SUBCATEGORIES, 'service-subcategory');
  renderCategoryOptions(cachedCategories);
  renderServiceChips(cachedServices);
  fetchCategoryDataForForm({ silent: true });

  // === Service examples: setup ===
const serviceExamples = document.getElementById("service-examples");
const svcChipBtns = document.querySelectorAll('[data-svc-example]');
const SERVICE_CATEGORIES = ["Ø®Ø¯Ù…Ø§Øª","Ø²ÛŒØ¨Ø§ÛŒÛŒ","ØªØ§Ù„Ø§Ø± Ùˆ Ù…Ø¬Ø§Ù„Ø³","Ø®ÙˆØ¯Ø±Ùˆ","ÙˆØ±Ø²Ø´ÛŒ"];

// Add example text into description on tap
svcChipBtns.forEach(btn => {
  btn.addEventListener('click', () => {
    const ta = document.querySelector("textarea[name='desc']");
    if (!ta) return;
    const tag = btn.getAttribute('data-svc-example');
    if (!ta.value.includes(tag)) {
      ta.value = ta.value ? (ta.value.trim() + " | " + tag) : tag;
      showToast("Ø¨Ù‡ ØªÙˆØ¶ÛŒØ­Ø§Øª Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯: " + tag);
    } else {
      showToast("Ù‚Ø¨Ù„Ø§Ù‹ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡ ğŸ˜‰");
    }
  });
});

// Initial reveal on load if a service category is preselected
if (categorySelect && SERVICE_CATEGORIES.includes(categorySelect.value)) {
  serviceExamples.classList.remove("hidden");
}


// Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ: Ù†Ø´Ø§Ù† Ø¯Ø§Ø¯Ù† Ø²ÛŒØ±Ú¯Ø±ÙˆÙ‡ "Ú©ÙˆØ¯Ú©Ø§Ù†" Ùˆ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø®Ø¯Ù…Ø§Øª
if (categorySelect) {
  categorySelect.addEventListener("change", function () {
    // Ø¨Ø®Ø´ Ú©ÙˆØ¯Ú©Ø§Ù† (Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± Ù…Ù†Ø·Ù‚ÛŒ Ù‚Ø¨Ù„ÛŒ)
    if (this.value === "Ú©ÙˆØ¯Ú©Ø§Ù†") {
      subcatWrapper.classList.remove("hidden");
    } else {
      subcatWrapper.classList.add("hidden");
      if (subcatInput) {
        subcatInput.value = "";
      }
      highlightServiceChip('');
      document.getElementById("subcategory-hint").classList.add("hidden");
    }

    // Ø§Ú¯Ø± Ø¯Ø³ØªÙ‡Ù” Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ø§Ø² Ù†ÙˆØ¹ Ø®Ø¯Ù…Ø§Øª Ø¨Ø§Ø´Ø¯ØŒ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ Ø±Ø§ Ù†Ø´Ø§Ù† Ø¨Ø¯Ù‡
    if (SERVICE_CATEGORIES.includes(this.value)) {
      serviceExamples.classList.remove("hidden");
    } else {
      serviceExamples.classList.add("hidden");
    }
  });
}


  if (subcatChipsContainer) {
    subcatChipsContainer.addEventListener('click', function (event) {
      const button = event.target.closest('button[data-value]');
      if (!button) return;
      highlightServiceChip(button.dataset.value || '');
      if (subcatInput) {
        subcatInput.value = button.dataset.value || '';
      }
      document.getElementById("subcategory-hint").classList.add("hidden");
    });
  }

  // force category dropdown to open downward
  categorySelect.addEventListener('focus', function(){
    this.size = this.options.length;
    this.classList.add('open');
  });
  categorySelect.addEventListener('blur', function(){
    this.size = 1;
    this.classList.remove('open');
  });
  categorySelect.addEventListener('change', function(){
    this.size = 1;
    this.classList.remove('open');
    this.blur();
  });

  // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ùˆ Ø§Ø±Ø³Ø§Ù„ ÙØ±Ù… Ø«Ø¨Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡
  document.getElementById("signup-form").addEventListener("submit", function (e) {
    e.preventDefault(); // Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø¨ØªØ¯Ø§ Ù‚Ø±Ø§Ø± Ø¨Ú¯ÛŒØ±Ù‡ ØªØ§ ÙØ±Ù… Ø§Ø±Ø³Ø§Ù„ Ù†Ø´Ù‡ ØªØ§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø§Ù…Ù„ Ø´Ù‡

    let hasError = false;

    // Ù†Ø§Ù… ÙØ±ÙˆØ´Ù†Ø¯Ù‡
    let firstname = document.getElementById("firstname").value.trim();
    let firstnameHint = document.getElementById("firstname-hint");
    if (!firstname) {
      firstnameHint.innerText = "Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… ÙØ±ÙˆØ´Ù†Ø¯Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.";
      firstnameHint.classList.remove("hidden");
      hasError = true;
    } else {
      firstnameHint.classList.add("hidden");
    }

    // Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ ÙØ±ÙˆØ´Ù†Ø¯Ù‡
    let lastname = document.getElementById("lastname").value.trim();
    let lastnameHint = document.getElementById("lastname-hint");
    if (!lastname) {
      lastnameHint.innerText = "Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ ÙØ±ÙˆØ´Ù†Ø¯Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.";
      lastnameHint.classList.remove("hidden");
      hasError = true;
    } else {
      lastnameHint.classList.add("hidden");
    }

    // Ù†Ø§Ù… ÙØ±ÙˆØ´Ú¯Ø§Ù‡
    let storename = document.getElementById("storename").value.trim();
    let storenameHint = document.getElementById("storename-hint");
    if (!storename) {
      storenameHint.innerText = "Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.";
      storenameHint.classList.remove("hidden");
      hasError = true;
    } else {
      storenameHint.classList.add("hidden");
    }

    // Ø¢Ø¯Ø±Ø³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡
    let shopurl = document.getElementById("shopurl").value.trim();
    let shopurlHint = document.getElementById("shopurl-hint");
    if (shopurl.length < 4) {
      shopurlHint.innerText = "Ø¢Ø¯Ø±Ø³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û´ Ú©Ø§Ø±Ø§Ú©ØªØ± Ø¨Ø§Ø´Ø¯.";
      shopurlHint.classList.remove("hidden");
      hasError = true;
    } else if (shopurl.length > 10) {
      shopurlHint.innerText = "Ø¢Ø¯Ø±Ø³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ù†Ø¨Ø§ÛŒØ¯ Ø¨ÛŒØ´ØªØ± Ø§Ø² Û±Û° Ú©Ø§Ø±Ø§Ú©ØªØ± Ø¨Ø§Ø´Ø¯.";
      shopurlHint.classList.remove("hidden");
      hasError = true;
    } else if (!/^[a-z0-9]+$/.test(shopurl)) {
      shopurlHint.innerText = "Ø¢Ø¯Ø±Ø³ ÙÙ‚Ø· Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø´Ø§Ù…Ù„ Ø­Ø±ÙˆÙ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ Ú©ÙˆÚ†Ú© Ùˆ Ø¹Ø¯Ø¯ Ø¨Ø§Ø´Ø¯. Ø§Ø² ÙØ§ØµÙ„Ù‡ Ùˆ Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ Ø®Ø§Øµ Ù…Ø«Ù„ # ÛŒØ§ ! Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†ÛŒØ¯.";
      shopurlHint.classList.remove("hidden");
      hasError = true;
    } else {
      shopurlHint.classList.add("hidden");
    }

    // Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„
    let phone = document.getElementById("phone").value.trim();
    let phoneHint = document.getElementById("phone-hint");
    if (!/^09\d{9}$/.test(phone)) {
      phoneHint.innerText = "Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª ØµØ­ÛŒØ­ Ùˆ Ú©Ø§Ù…Ù„ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ù…Ø«Ù„Ø§Ù‹ 09123456789).";
      phoneHint.classList.remove("hidden");
      hasError = true;
    } else {
      phoneHint.classList.add("hidden");
    }

    // Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ
    let category = document.getElementById("category").value;
    let categoryHint = document.getElementById("category-hint");
    if (!category) {
      categoryHint.innerText = "Ù„Ø·ÙØ§Ù‹ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.";
      categoryHint.classList.remove("hidden");
      hasError = true;
    } else {
      categoryHint.classList.add("hidden");
    }

    // Ø²ÛŒØ± Ø¯Ø³ØªÙ‡ Ø¯Ø± ØµÙˆØ±Øª Ø§Ù†ØªØ®Ø§Ø¨ Ø¯Ø³ØªÙ‡ Ú©ÙˆØ¯Ú©Ø§Ù†
    let subcategory = "";
    if (category === "Ú©ÙˆØ¯Ú©Ø§Ù†") {
      subcategory = document.getElementById("subcategory").value;
      let subcategoryHint = document.getElementById("subcategory-hint");
      if (!subcategory) {
        subcategoryHint.innerText = "Ù„Ø·ÙØ§Ù‹ Ø²ÛŒØ± Ø¯Ø³ØªÙ‡ Ú©ÙˆØ¯Ú©Ø§Ù† Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.";
        subcategoryHint.classList.remove("hidden");
        hasError = true;
      } else {
        subcategoryHint.classList.add("hidden");
      }
    }

    // Ø¢Ø¯Ø±Ø³ Ø¯Ù‚ÛŒÙ‚
    let address = document.getElementById("address").value.trim();
    let addressHint = document.getElementById("address-hint");
    if (!address) {
      addressHint.innerText = "Ù„Ø·ÙØ§Ù‹ Ø¢Ø¯Ø±Ø³ Ø¯Ù‚ÛŒÙ‚ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.";
      addressHint.classList.remove("hidden");
      hasError = true;
    } else {
      addressHint.classList.add("hidden");
    }

    // Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±
    let pass1 = document.getElementById("pass1").value;
    let pass2 = document.getElementById("pass2").value;
    let passHint = document.getElementById("pass-hint");
    if (pass1.length < 8) {
      passHint.innerText = "Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û¸ Ú©Ø§Ø±Ø§Ú©ØªØ± Ø¨Ø§Ø´Ø¯.";
      passHint.classList.remove("hidden");
      hasError = true;
    } else if (!/[a-zA-Z]/.test(pass1)) {
      passHint.innerText = "Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ ÛŒÚ© Ø­Ø±Ù Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯.";
      passHint.classList.remove("hidden");
      hasError = true;
    } else if (!/\d/.test(pass1)) {
      passHint.innerText = "Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ ÛŒÚ© Ø¹Ø¯Ø¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯.";
      passHint.classList.remove("hidden");
      hasError = true;
    } else if (!/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(pass1)) {
      passHint.innerText = "Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ ÛŒÚ© Ù†Ù…Ø§Ø¯ Ù…Ø«Ù„ !@#$% Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯.";
      passHint.classList.remove("hidden");
      hasError = true;
    } else if (pass1 !== pass2) {
      passHint.innerText = "Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ùˆ ØªÚ©Ø±Ø§Ø± Ø¢Ù† Ø¨Ø§ Ù‡Ù… ÛŒÚ©Ø³Ø§Ù† Ù†ÛŒØ³ØªÙ†Ø¯.";
      passHint.classList.remove("hidden");
      hasError = true;
    } else {
      passHint.classList.add("hidden");
    }

    // Ù‚ÙˆØ§Ù†ÛŒÙ† Ø³Ø§ÛŒØª
    let rules = document.getElementById("rules");
    let rulesHint = document.getElementById("rules-hint");
    if (!rules.checked) {
      rulesHint.innerText = "Ù„Ø·ÙØ§Ù‹ ØªÛŒÚ© Ù¾Ø°ÛŒØ±Ø´ Ù‚ÙˆØ§Ù†ÛŒÙ† Ø³Ø§ÛŒØª Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯.";
      rulesHint.classList.remove("hidden");
      hasError = true;
    } else {
      rulesHint.classList.add("hidden");
    }

    // Ø§Ú¯Ø± Ø­ØªÛŒ ÛŒÚ©ÛŒ Ø§Ø² Ø®Ø·Ø§Ù‡Ø§ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªØŒ Ø§Ø¬Ø§Ø²Ù‡ Ø§Ø±Ø³Ø§Ù„ ÙØ±Ù… Ù†Ø¯Ù‡
    if (hasError) {
      return;
    }

    // Ø³Ø§Ø®Øª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ø¨Ú©â€ŒØ§Ù†Ø¯
    const data = {
      firstname: firstname,
      lastname: lastname,
      storename: storename,
      shopurl: shopurl,
      phone: phone,
      category: category,
      subcategory: subcategory,
      address: address,
      desc: document.querySelector("textarea[name='desc']").value.trim(),
      password: pass1,
    };

    // ØºÛŒØ± ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡ Ø«Ø¨Øª ØªØ§ Ù¾Ø§Ø³Ø® Ø¨ÛŒØ§Ø¯
    let btn = this.querySelector("button[type='submit']");
    btn.disabled = true;
    btn.innerText = "Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„...";

  fetch("http://localhost:5000/api/auth/register", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
  },
  body: JSON.stringify(data),
})
.then(res => res.json())
.then(result => {
  btn.disabled = false;
  btn.innerText = "Ø«Ø¨Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡";
  if (result.success) {
    localStorage.setItem('shopurl', data.shopurl);
    SafeSS.setJSON('signup_password', data.password); // SafeSS

    // âœ… Ø§Ø¶Ø§ÙÙ‡â€ŒØ´Ø¯Ù† Ù†Ù‚Ø´ Ùˆ Ø¯Ø³ØªÙ‡ Ø¨Ø±Ø§ÛŒ ØªØ¹ÛŒÛŒÙ† Ù¾Ù†Ù„ Ø¨Ø¹Ø¯ Ø§Ø² ÙˆØ±ÛŒÙØ§ÛŒ
    // ØªÙˆØ¬Ù‡: SERVICE_CATEGORIES Ø¨Ø§Ù„Ø§ØªØ± Ø¯Ø± Ù‡Ù…ÛŒÙ† ÙØ§ÛŒÙ„ ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡.
    SafeSS.setJSON('signup_category', data.category); // SafeSS
    SafeSS.setJSON('signup_role', SERVICE_CATEGORIES.includes(data.category) ? 'service' : 'seller'); // SafeSS

    window.location.href = "verify.html?shopurl=" + encodeURIComponent(data.shopurl) + "&phone=" + encodeURIComponent(data.phone);
  }

  else {
    alert("Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…: " + (result.message || "Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯"));
  }
})


.catch(err => {
  btn.disabled = false;
  btn.innerText = "Ø«Ø¨Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡";
  console.error("Error:", err);
  alert("Ù…Ø´Ú©Ù„ÛŒ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ± Ù¾ÛŒØ´ Ø¢Ù…Ø¯.");
});


  });

  // Ù…Ø±Ø­Ù„Ù‡ ØªØ£ÛŒÛŒØ¯ Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„
function showVerifySection(phone) {
  // Ù…Ù‚Ø¯Ø§Ø± shopurl Ø±Ùˆ Ø§Ø² localStorage Ø¨Ø®ÙˆÙ†
  var shopurl = localStorage.getItem('shopurl');
  // Ø±ÛŒØ¯Ø§ÛŒØ±Ú©Øª Ø¨Ù‡ ØµÙØ­Ù‡ verify.html Ø¨Ø§ Ù¾Ø§Ø±Ø§Ù…ØªØ±
  window.location.href = `verify.html?shopurl=${encodeURIComponent(shopurl)}&phone=${encodeURIComponent(phone)}`;
}


  // ØªØ§ÛŒÛŒØ¯ Ú©Ø¯ Ù¾ÛŒØ§Ù…Ú©
// --- ØªØ§ÛŒÛŒØ¯ Ú©Ø¯ Ù¾ÛŒØ§Ù…Ú© Ø¨Ø§ Ø³Ø±ÙˆØ± ---
document.getElementById("verify-form").addEventListener("submit", function (e) {
  e.preventDefault();
  var code = document.getElementById("sms-code").value.trim();
  var codeHint = document.getElementById("code-hint");
  var params = new URLSearchParams(window.location.search);
  var shopurl = params.get("shopurl");
  var phone = params.get("phone");
  if (!/^\d{5}$/.test(code)) {
    codeHint.innerText = "Ú©Ø¯ ØªØ£ÛŒÛŒØ¯ Ø¨Ø§ÛŒØ¯ Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ûµ Ø±Ù‚Ù… Ø¨Ø§Ø´Ø¯.";
    codeHint.classList.remove("hidden");
    return false;
  }

  fetch("http://localhost:5000/api/auth/verify", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({ shopurl, phone, code })
  })
  .then(res => res.json())
  .then(result => {
    if (result.success) {
      // Ø±Ù…Ø² Ø±Ùˆ Ø§Ø² sessionStorage Ø¨Ø®ÙˆÙ† Ø¨Ø±Ø§ÛŒ Ù„Ø§Ú¯ÛŒÙ†
      var password = SafeSS.getJSON('signup_password'); // SafeSS
      if (!password) {
        codeHint.innerText = "Ø®Ø·Ø§: Ø±Ù…Ø² Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯. Ù„Ø·ÙØ§ Ù…Ø¬Ø¯Ø¯ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ù†ÛŒØ¯.";
        codeHint.classList.remove("hidden");
        return;
      }
      // Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù„Ø§Ú¯ÛŒÙ† Ø¨Ù‡ Ø³Ø±ÙˆØ±
      fetch("http://localhost:5000/api/auth/login", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ phone, password })
      })
      .then(res2 => res2.json())
      .then(loginRes => {
        if (loginRes.success && loginRes.seller) {
          // ØªÙˆÚ©Ù† Ùˆ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø±Ùˆ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù† (Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø²)
          localStorage.setItem('token', loginRes.token);
          localStorage.setItem('seller', JSON.stringify(loginRes.seller));
          // sessionStorage Ø±Ùˆ Ù¾Ø§Ú© Ú©Ù†
          sessionStorage.removeItem('signup_password');
          // Ø±ÛŒØ¯Ø§ÛŒØ±Ú©Øª Ø¨Ù‡ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
          window.location.href = "seller/dashboard.html?shopurl=" + encodeURIComponent(loginRes.seller.shopurl);
        } else {
          codeHint.innerText = loginRes.message || "ÙˆØ±ÙˆØ¯ Ù†Ø§Ù…ÙˆÙÙ‚!";
          codeHint.classList.remove("hidden");
        }
      })
      .catch(() => {
        codeHint.innerText = "Ø®Ø·Ø§ÛŒ ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø§Ú©Ø§Ù†Øª!";
        codeHint.classList.remove("hidden");
      });
    } else {
      codeHint.innerText = result.message || "Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª!";
      codeHint.classList.remove("hidden");
    }
  })
  .catch(() => {
    codeHint.innerText = "Ù…Ø´Ú©Ù„ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±!";
    codeHint.classList.remove("hidden");
  });
});

document.getElementById("sms-code").addEventListener("input", function () {
  document.getElementById("code-hint").classList.add("hidden");
});

// ØªØ§ÛŒÙ…Ø± Ø§Ø±Ø³Ø§Ù„ Ù…Ø¬Ø¯Ø¯ Ú©Ø¯
var resendBtn = document.getElementById("resend-btn");
var timerSpan = document.getElementById("resend-timer");
function startResendTimer() {
  resendBtn.disabled = true;
  let time = 60;
  timerSpan.innerText = `(${time})`;
  resendBtn.innerHTML = 'Ø§Ø±Ø³Ø§Ù„ Ù…Ø¬Ø¯Ø¯ Ú©Ø¯ <span id="resend-timer">(' + time + ')</span>';
  timerSpan = document.getElementById("resend-timer");
  let t = setInterval(function () {
    time--;
    timerSpan.innerText = `(${time})`;
    if (time <= 0) {
      clearInterval(t);
      resendBtn.disabled = false;
      timerSpan.innerText = '';
      resendBtn.innerText = 'Ø§Ø±Ø³Ø§Ù„ Ù…Ø¬Ø¯Ø¯ Ú©Ø¯';
    }
  }, 1000);
}

resendBtn.addEventListener("click", function () {
  if (resendBtn.disabled) return;
  alert("Ú©Ø¯ Ø¬Ø¯ÛŒØ¯ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯! (Ø¯Ø± Ø­Ø§Ù„Øª ÙˆØ§Ù‚Ø¹ÛŒ)");
  startResendTimer();
});



// Mini toast for quick feedback
function showToast(msg) {
  const el = document.createElement('div');
  el.className = "fixed bottom-4 left-1/2 -translate-x-1/2 z-[999] px-4 py-2 rounded-xl bg-gradient-to-l from-[#11d6ad] via-[#10b981] to-[#2db4e8] text-white text-sm shadow-lg";
  el.textContent = msg;
  document.body.appendChild(el);
  setTimeout(() => {
    el.style.transition = "opacity .3s, transform .3s";
    el.style.opacity = "0";
    el.style.transform = "translate(-50%, 8px)";
    setTimeout(() => el.remove(), 300);
  }, 1400);
}


</script>


</body>
</html>